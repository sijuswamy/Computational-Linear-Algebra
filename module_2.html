<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Transforming Linear Algebra to Computational Language – Computational Linear Algebra</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./module_3.html" rel="next">
<link href="./module_1.html" rel="prev">
<link href="./CME_logo.JPG" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./module_2.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Transforming Linear Algebra to Computational Language</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computational Linear Algebra</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/sijuswamy/Computational-Linear-Algebra" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Computational-Linear-Algebra.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Computational-Linear-Algebra.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./module_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Python for Linear Algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./module_2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Transforming Linear Algebra to Computational Language</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./module_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python Libraries for Computational Linear Algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./module_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Algebra for Advanced Applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./module_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Practical Uses Cases</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CME_logo.JPG" class="img-fluid figure-img"></p>
<figcaption>Computational Mathematics</figcaption>
</figure>
</div>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">2.1</span> Introduction</a></li>
  <li><a href="#relearning-of-terms-and-operations-in-linear-algebra" id="toc-relearning-of-terms-and-operations-in-linear-algebra" class="nav-link" data-scroll-target="#relearning-of-terms-and-operations-in-linear-algebra"><span class="header-section-number">2.2</span> Relearning of Terms and Operations in Linear Algebra</a>
  <ul class="collapse">
  <li><a href="#matrix-addition-and-subtraction-in-data-analysis" id="toc-matrix-addition-and-subtraction-in-data-analysis" class="nav-link" data-scroll-target="#matrix-addition-and-subtraction-in-data-analysis"><span class="header-section-number">2.2.1</span> Matrix Addition and Subtraction in Data Analysis</a></li>
  <li><a href="#more-on-matrix-product-and-its-applications" id="toc-more-on-matrix-product-and-its-applications" class="nav-link" data-scroll-target="#more-on-matrix-product-and-its-applications"><span class="header-section-number">2.2.2</span> More on Matrix Product and its Applications</a></li>
  <li><a href="#matrix-measures-of-practical-importance" id="toc-matrix-measures-of-practical-importance" class="nav-link" data-scroll-target="#matrix-measures-of-practical-importance"><span class="header-section-number">2.2.3</span> Matrix Measures of Practical Importance</a></li>
  <li><a href="#rank-nullity-theorem" id="toc-rank-nullity-theorem" class="nav-link" data-scroll-target="#rank-nullity-theorem"><span class="header-section-number">2.2.4</span> Rank Nullity Theorem</a></li>
  <li><a href="#fundamental-subspaces" id="toc-fundamental-subspaces" class="nav-link" data-scroll-target="#fundamental-subspaces"><span class="header-section-number">2.2.5</span> Fundamental Subspaces</a></li>
  </ul></li>
  <li><a href="#module-review" id="toc-module-review" class="nav-link" data-scroll-target="#module-review"><span class="header-section-number">2.3</span> Module review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Transforming Linear Algebra to Computational Language</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">2.1</span> Introduction</h2>
<p>In the first module, we established a solid foundation in matrix algebra by exploring pseudocode and implementing fundamental matrix operations using <code>Python</code>. We practiced key concepts such as matrix addition, subtraction, multiplication, and determinants through practical examples in image processing, leveraging the <code>SymPy</code> library for symbolic computation.</p>
<p>As we begin the second module, <strong>“Transforming Linear Algebra to Computational Language,”</strong> our focus will shift towards applying these concepts with greater depth and actionable insight. This module is designed to bridge the theoretical knowledge from matrix algebra with practical computational applications. You will learn to interpret and utilize matrix operations, solve systems of equations, and analyze the rank of matrices within a variety of real-world contexts.</p>
<p>A new concept we will introduce is the <strong>Rank-Nullity Theorem</strong>, which provides a fundamental relationship between the rank of a matrix and the dimensions of its null space. This theorem is crucial for understanding the solution spaces of linear systems and the properties of linear transformations. By applying this theorem, you will be able to gain deeper insights into the structure of solutions and the behavior of matrix transformations.</p>
<p>This transition will not only reinforce your understanding of linear algebra but also enhance your ability to apply these concepts effectively in computational settings. Through engaging examples and practical exercises, you will gain valuable experience in transforming abstract mathematical principles into tangible solutions, setting a strong groundwork for advanced computational techniques.</p>
</section>
<section id="relearning-of-terms-and-operations-in-linear-algebra" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="relearning-of-terms-and-operations-in-linear-algebra"><span class="header-section-number">2.2</span> Relearning of Terms and Operations in Linear Algebra</h2>
<p>In this section, we will revisit fundamental matrix operations such as addition, subtraction, scaling, and more through practical examples. Our goal is to transform theoretical linear algebra into modern computational applications. We will demonstrate these concepts using <code>Python</code>, focusing on practical and industrial applications.</p>
<section id="matrix-addition-and-subtraction-in-data-analysis" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="matrix-addition-and-subtraction-in-data-analysis"><span class="header-section-number">2.2.1</span> Matrix Addition and Subtraction in Data Analysis</h3>
<p>Matrix addition and subtraction are fundamental operations that help in combining datasets and analyzing differences.</p>
<p><strong>Simple Example: Combining Quarterly Sales Data</strong></p>
<p>We begin with quarterly sales data from different regions and combine them to get the total sales. The sales data is given in <a href="#tbl-qtb" class="quarto-xref">Table&nbsp;<span>2.1</span></a>. A ar plot of the total sales is shown in <a href="#fig-total1" class="quarto-xref">Fig&nbsp;<span>2.1</span></a>.</p>
<div id="tbl-qtb" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-qtb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.1: Quarterly Sales Data
</figcaption>
<div aria-describedby="tbl-qtb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Region</th>
<th>Q1</th>
<th>Q2</th>
<th>Q3</th>
<th>Q4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>2500</td>
<td>2800</td>
<td>3100</td>
<td>2900</td>
</tr>
<tr class="even">
<td>B</td>
<td>1500</td>
<td>1600</td>
<td>1700</td>
<td>1800</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><strong>From Scratch <code>Python</code> Implementation:</strong></p>
<div id="cell-fig-total1" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Quarterly sales data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>sales_region_a <span class="op">=</span> np.array([<span class="dv">2500</span>, <span class="dv">2800</span>, <span class="dv">3100</span>, <span class="dv">2900</span>])</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sales_region_b <span class="op">=</span> np.array([<span class="dv">1500</span>, <span class="dv">1600</span>, <span class="dv">1700</span>, <span class="dv">1800</span>])</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine sales data</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>total_sales <span class="op">=</span> sales_region_a <span class="op">+</span> sales_region_b</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>quarters <span class="op">=</span> [<span class="st">'Q1'</span>, <span class="st">'Q2'</span>, <span class="st">'Q3'</span>, <span class="st">'Q4'</span>]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>plt.bar(quarters, total_sales, color<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Quarter'</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Total Sales'</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Combined Quarterly Sales Data for Regions A and B'</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-total1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-total1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="module_2_files/figure-html/fig-total1-output-1.png" width="601" height="449" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-total1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Computing Total Sales using <code>Numpy</code> aggregation method
</figcaption>
</figure>
</div>
</div>
</div>
<p>In the above <code>Python</code> code, we have performed the aggregation operation with the <code>NumPy</code> method. Same can be done in a more data analysis style using <code>pandas</code> inorder to handle tabular data meaningfully. In this approach, quarterly sales data of each region is stored as <code>DataFrames</code>(like an excel sheet). The we combine these two <code>DataFrames</code> into one. After that create a new row with index ‘Total’ and populate this row with sum of quarterly sales in Region A and Region B. Finally a bar plot is created using this ‘Total’ sales. Advantage of this approach is that we don’t need the <code>matplotlib</code> library to create visualizations!. The EDA using this approach is shown in <a href="#fig-tot2" class="quarto-xref">Fig&nbsp;<span>2.2</span></a>.</p>
<div id="cell-fig-tot2" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrames for quarterly sales data</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>df_a <span class="op">=</span> pd.DataFrame({<span class="st">'Q1'</span>: [<span class="dv">2500</span>], <span class="st">'Q2'</span>: [<span class="dv">2800</span>], <span class="st">'Q3'</span>: [<span class="dv">3100</span>], <span class="st">'Q4'</span>: [<span class="dv">2900</span>]}, index<span class="op">=</span>[<span class="st">'Region A'</span>])</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>df_b <span class="op">=</span> pd.DataFrame({<span class="st">'Q1'</span>: [<span class="dv">1500</span>], <span class="st">'Q2'</span>: [<span class="dv">1600</span>], <span class="st">'Q3'</span>: [<span class="dv">1700</span>], <span class="st">'Q4'</span>: [<span class="dv">1800</span>]}, index<span class="op">=</span>[<span class="st">'Region B'</span>])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine data</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>df_combined <span class="op">=</span> df_a.add(df_b, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>df_combined.loc[<span class="st">"Total"</span>] <span class="op">=</span> df_combined.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>df_combined.loc[<span class="st">"Total"</span>].plot(kind<span class="op">=</span><span class="st">'bar'</span>, color<span class="op">=</span>[<span class="st">'green'</span>])</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Quarter'</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Total Sales'</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Combined Quarterly Sales Data for Regions A and B'</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-tot2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="module_2_files/figure-html/fig-tot2-output-1.png" width="601" height="455" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.2: Computation of Total Sales using <code>Pandas</code> method
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can extend this in to more advanced examples. Irrespective to the size of the data, for representation and aggregation tasks matrix models are best options and are used in industry as a standard. Let us consider an advanced example to analyse difference in stock prices. For this example we are using a simulated data. The python code for this simulation process is shown in <a href="#fig-sim" class="quarto-xref">Fig&nbsp;<span>2.3</span></a>.</p>
<div id="cell-fig-sim" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated observed and predicted stock prices</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>observed_prices <span class="op">=</span> np.random.uniform(<span class="dv">100</span>, <span class="dv">200</span>, size<span class="op">=</span>(<span class="dv">100</span>, <span class="dv">5</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>predicted_prices <span class="op">=</span> np.random.uniform(<span class="dv">95</span>, <span class="dv">210</span>, size<span class="op">=</span>(<span class="dv">100</span>, <span class="dv">5</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the difference matrix</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>price_differences <span class="op">=</span> observed_prices <span class="op">-</span> predicted_prices</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>plt.imshow(price_differences, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Stock Price Differences'</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Stock Index'</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Day Index'</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-sim" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="module_2_files/figure-html/fig-sim-output-1.png" width="562" height="449" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.3: Demonstration of Stock Price simulated from a Uniform Distribution
</figcaption>
</figure>
</div>
</div>
</div>
<p>Another important matrix operation relevant to data analytics and Machine Learning application is scaling. This is considered as a statistical tool to make various features (attributes) in to same scale so as to avoid unnecessary misleading impact in data analysis and its intepretation. In Machine Learning context, this pre-processing stage is inevitable so as to make the model relevant and usable.</p>
<p><strong>Simple Example: Normalizing Employee Performance Data</strong></p>
<div id="tbl-EPD" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-EPD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.2: Employee Performance Data
</figcaption>
<div aria-describedby="tbl-EPD-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Employee</th>
<th>Metric A</th>
<th>Metric B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>X</td>
<td>80</td>
<td>700</td>
</tr>
<tr class="even">
<td>Y</td>
<td>90</td>
<td>800</td>
</tr>
<tr class="odd">
<td>Z</td>
<td>100</td>
<td>900</td>
</tr>
<tr class="even">
<td>A</td>
<td>110</td>
<td>1000</td>
</tr>
<tr class="odd">
<td>B</td>
<td>120</td>
<td>1100</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Using simple python code we can simulate the model for <code>min-max</code> scaling. The formula for <code>min-max</code> scaling is: <span class="math display">\[min_max(X)=\dfrac{X-min(X)}{max(X)-min(X)}\]</span></p>
<p>For example, while applying the <code>min-max</code> scaling in the first value of Metric A, the scaled value is <span class="math display">\[min_max(80)\dfrac{80-80}{120-80}=0\]</span></p>
<p>Similarly</p>
<p><span class="math display">\[min_max(100)\dfrac{100-80}{120-80}=0.5\]</span></p>
<p>When we apply this formula to Metric A and Metric B, the scaled output from <a href="#tbl-EPD" class="quarto-xref">Table&nbsp;<span>2.2</span></a> will be as follows:</p>
<div id="tbl-EPDu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-EPDu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.3: Employee Performance Data
</figcaption>
<div aria-describedby="tbl-EPDu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Employee</th>
<th>Metric A</th>
<th>Metric B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>X</td>
<td>0.00</td>
<td>0.00</td>
</tr>
<tr class="even">
<td>Y</td>
<td>0.25</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>Z</td>
<td>0.50</td>
<td>0.50</td>
</tr>
<tr class="even">
<td>A</td>
<td>0.75</td>
<td>0.75</td>
</tr>
<tr class="odd">
<td>B</td>
<td>1.00</td>
<td>1.00</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>It is interesting to look into the scaled data! In the orginal table (<a href="#tbl-EPD" class="quarto-xref">Table&nbsp;<span>2.2</span></a>) it is looked like Metric B is superior. But from the scaled table (<a href="#tbl-EPDu" class="quarto-xref">Table&nbsp;<span>2.3</span></a>), it is clear that both the Metrics are representing same relative information. This will help us to identify the redundency in measure and so skip any one of the Metric before analysis!.</p>
<p>The same can be achieved through a matrix operation. The <code>Python</code> implementation of this scaling process is shown in <a href="#fig-totalsales" class="quarto-xref">Fig&nbsp;<span>2.4</span></a>.</p>
<div id="cell-fig-totalsales" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Employee performance data with varying scales</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([[<span class="dv">80</span>, <span class="dv">700</span>], [<span class="dv">90</span>, <span class="dv">800</span>], [<span class="dv">100</span>, <span class="dv">900</span>], [<span class="dv">110</span>, <span class="dv">1000</span>], [<span class="dv">120</span>, <span class="dv">1100</span>]])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual scaling</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>min_vals <span class="op">=</span> np.<span class="bu">min</span>(data, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>max_vals <span class="op">=</span> np.<span class="bu">max</span>(data, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>scaled_data <span class="op">=</span> (data <span class="op">-</span> min_vals) <span class="op">/</span> (max_vals <span class="op">-</span> min_vals)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>plt.imshow(data, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Original Data'</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>plt.imshow(scaled_data, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scaled Data'</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-totalsales" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-totalsales-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="module_2_files/figure-html/fig-totalsales-output-1.png" width="572" height="431" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-totalsales-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.4: Total sales using <code>pandas</code> method
</figcaption>
</figure>
</div>
</div>
</div>
<p>From the first sub plot, it is clear that there is a significant difference in the distributions (Metric A and Metric B values). But the second sub plot shows that both the distributions have same pattern and the values ranges between 0 and 1. In short the visualization is more appealing and self explanatory in this case.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>min-max</code> scaling method will confine the feature values (attributes) into the range <span class="math inline">\([0,1]\)</span>. So in effect all the features are scaled proportionally to the data spectrum.</p>
</div>
</div>
<p>Similarly, we can use the <code>standard scaling</code> (transformation to normal distribution) using the transformation <span class="math inline">\(\dfrac{x-\bar{x}}{\sigma}\)</span>. Scaling table is given as a practice task to the reader. The python code for this operation is shown in <a href="#fig-minmax" class="quarto-xref">Fig&nbsp;<span>2.5</span></a>.</p>
<div id="cell-fig-minmax" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard scaling from scratch</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> standard_scaling(data):</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    mean <span class="op">=</span> np.mean(data, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    std <span class="op">=</span> np.std(data, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    scaled_data <span class="op">=</span> (data <span class="op">-</span> mean) <span class="op">/</span> std</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> scaled_data</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply standard scaling</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>scaled_data_scratch <span class="op">=</span> standard_scaling(data)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Standard Scaled Data (from scratch):</span><span class="ch">\n</span><span class="st">"</span>, scaled_data_scratch)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">5</span>))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>plt.imshow(data, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Original Data'</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>plt.imshow(scaled_data_scratch, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scaled Data'</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard Scaled Data (from scratch):
 [[-1.41421356 -1.41421356]
 [-0.70710678 -0.70710678]
 [ 0.          0.        ]
 [ 0.70710678  0.70710678]
 [ 1.41421356  1.41421356]]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-minmax" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-minmax-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="module_2_files/figure-html/fig-minmax-output-2.png" width="499" height="431" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-minmax-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.5: Min-max scaling using basic python
</figcaption>
</figure>
</div>
</div>
</div>
<p>To understand the effect of standard scaling, let us consider <a href="#fig-comp1" class="quarto-xref">Fig&nbsp;<span>2.6</span></a>. This plot create the frequency distribution of the data as a histogram along with the density function. From the first sub-plot, it is clear that the distribution has multiple modes (peaks). When we apply the standard scaling, the distribution become un-modal(only one peek). This is demonstrated in the second sub-plot.</p>
<div id="cell-fig-comp1" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard scaling from scratch</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">5</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for original data</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>sns.histplot(data, kde<span class="op">=</span><span class="va">True</span>, bins<span class="op">=</span><span class="dv">10</span>, palette<span class="op">=</span><span class="st">"viridis"</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Original Data Distribution'</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Value'</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for standard scaled data</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>sns.histplot(scaled_data_scratch, kde<span class="op">=</span><span class="va">True</span>, bins<span class="op">=</span><span class="dv">10</span>, palette<span class="op">=</span><span class="st">"viridis"</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Standard Scaled Data Distribution'</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Value'</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-comp1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="module_2_files/figure-html/fig-comp1-output-1.png" width="593" height="470" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.6: Impact of standard scaling on the distribution
</figcaption>
</figure>
</div>
</div>
</div>
<p>A scatter plot showing the compare the impact of scaling on the given distribution is shown in <a href="#fig-scatter" class="quarto-xref">Fig&nbsp;<span>2.7</span></a>.</p>
<div id="cell-fig-scatter" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot original and scaled data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">5</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Original Data</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(data[:, <span class="dv">0</span>], data[:, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Original Data'</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Metric A'</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Metric B'</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard Scaled Data</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>plt.scatter(scaled_data_scratch[:, <span class="dv">0</span>], scaled_data_scratch[:, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Standard Scaled Data'</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Metric A (Standard Scaled)'</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Metric B (Standard Scaled)'</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Min-Max Scaled Data</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>plt.scatter(scaled_data[:, <span class="dv">0</span>], scaled_data[:, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Min-Max Scaled Data'</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Metric A (Min-Max Scaled)'</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Metric B (Min-Max Scaled)'</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-scatter" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="module_2_files/figure-html/fig-scatter-output-1.png" width="593" height="470" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.7: Comparison of impact of scaling on the distribution
</figcaption>
</figure>
</div>
</div>
</div>
<p>From the <a href="#fig-scatter" class="quarto-xref">Fig&nbsp;<span>2.7</span></a>, it is clear that the scaling does not affect the pattern of the data, instead it just scale the distribution proportionally!</p>
<p>We can use the <code>scikit-learn</code> library for do the same thing in a very simple handy approach. The <code>python</code> code for this job is shown below.</p>
<div id="97d4540e" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Min-max scaling using sklearn</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>min_max_scaled_data_sklearn <span class="op">=</span> scaler.fit_transform(data)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Min-Max Scaled Data (using sklearn):</span><span class="ch">\n</span><span class="st">"</span>, min_max_scaled_data_sklearn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Min-Max Scaled Data (using sklearn):
 [[0.   0.  ]
 [0.25 0.25]
 [0.5  0.5 ]
 [0.75 0.75]
 [1.   1.  ]]</code></pre>
</div>
</div>
<div id="4352d4be" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard scaling using sklearn</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>scaled_data_sklearn <span class="op">=</span> scaler.fit_transform(data)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Standard Scaled Data (using sklearn):</span><span class="ch">\n</span><span class="st">"</span>, scaled_data_sklearn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard Scaled Data (using sklearn):
 [[-1.41421356 -1.41421356]
 [-0.70710678 -0.70710678]
 [ 0.          0.        ]
 [ 0.70710678  0.70710678]
 [ 1.41421356  1.41421356]]</code></pre>
</div>
</div>
<p>A scatter plot showing the impact on scaling is shown in <a href="#fig-comp2" class="quarto-xref">Fig&nbsp;<span>2.8</span></a>. This plot compare the m<code>min-max</code> and <code>standard-scaling</code>.</p>
<div id="cell-fig-comp2" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot original and scaled data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">5</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Original Data</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(data[:, <span class="dv">0</span>], data[:, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Original Data'</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Metric A'</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Metric B'</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard Scaled Data</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>plt.scatter(scaled_data_sklearn[:, <span class="dv">0</span>], scaled_data_sklearn[:, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Standard Scaled Data'</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Metric A (Standard Scaled)'</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Metric B (Standard Scaled)'</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Min-Max Scaled Data</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>plt.scatter(min_max_scaled_data_sklearn[:, <span class="dv">0</span>], min_max_scaled_data_sklearn[:, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Min-Max Scaled Data'</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Metric A (Min-Max Scaled)'</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Metric B (Min-Max Scaled)'</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-comp2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comp2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="module_2_files/figure-html/fig-comp2-output-1.png" width="593" height="470" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comp2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.8: Camparison of Min-max and standard scalings with original data
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="more-on-matrix-product-and-its-applications" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="more-on-matrix-product-and-its-applications"><span class="header-section-number">2.2.2</span> More on Matrix Product and its Applications</h3>
<p>In the first module of our course, we introduced matrix products as scalar projections, focusing on how matrices interact through basic operations. In this section, we will expand on this by exploring different types of matrix products that have practical importance in various fields. One such product is the <em>Hadamard product</em>, which is particularly useful in applications ranging from image processing to neural networks and statistical analysis. We will cover the definition, properties, and examples of the Hadamard product, and then delve into practical applications with simulated data.</p>
<section id="hadamard-product" class="level4" data-number="2.2.2.1">
<h4 data-number="2.2.2.1" class="anchored" data-anchor-id="hadamard-product"><span class="header-section-number">2.2.2.1</span> Hadamard Product</h4>
<p>The Hadamard product (or element-wise product) of two matrices is a binary operation that combines two matrices of the same dimensions to produce another matrix of the same dimensions, where each element is the product of corresponding elements in the original matrices.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition (Hadamard Product):
</div>
</div>
<div class="callout-body-container callout-body">
<p>For two matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> of the same dimension <span class="math inline">\(m \times n\)</span>, the Hadamard product <span class="math inline">\(A \circ B\)</span> is defined as:</p>
<p><span class="math display">\[(A \circ B)_{ij} = A_{ij} \cdot B_{ij}\]</span></p>
<p>where <span class="math inline">\(\cdot\)</span> denotes element-wise multiplication.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Properties of Hadamard Product
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Commutativity</strong>: <span class="math display">\[A \circ B = B \circ A\]</span></p></li>
<li><p><strong>Associativity</strong>: <span class="math display">\[(A \circ B) \circ C = A \circ (B \circ C)\]</span></p></li>
<li><p><strong>Distributivity</strong>: <span class="math display">\[A \circ (B + C) = (A \circ B) + (A \circ C)\]</span></p></li>
</ol>
</div>
</div>
<p>Some simple examples to demonstrate the Hadamard product is given below.</p>
<p>Example 1: Basic Hadamard Product</p>
<p>Given matrices:</p>
<p><span class="math display">\[A = \begin{pmatrix}1 &amp; 2 \\3 &amp; 4\end{pmatrix}, \quad B = \begin{pmatrix}5 &amp; 6 \\7 &amp; 8\end{pmatrix}\]</span></p>
<p>The Hadamard product <span class="math inline">\(A \circ B\)</span> is:</p>
<p><span class="math display">\[A \circ B = \begin{pmatrix}1 \cdot 5 &amp; 2 \cdot 6 \\3 \cdot 7 &amp; 4 \cdot 8\end{pmatrix} = \begin{pmatrix}5 &amp; 12 \\21 &amp; 32\end{pmatrix}\]</span></p>
<p>Example 2: Hadamard Product with Larger Matrices</p>
<p>Given matrices:</p>
<p><span class="math display">\[A = \begin{pmatrix}1 &amp; 2 &amp; 3 \\4 &amp; 5 &amp; 6 \\7 &amp; 8 &amp; 9\end{pmatrix}, \quad B = \begin{pmatrix}9 &amp; 8 &amp; 7 \\6 &amp; 5 &amp; 4 \\3 &amp; 2 &amp; 1\end{pmatrix}\]</span></p>
<p>The Hadamard product <span class="math inline">\(A \circ B\)</span> is:</p>
<p><span class="math display">\[A \circ B = \begin{pmatrix}1 \cdot 9 &amp; 2 \cdot 8 &amp; 3 \cdot 7 \\4 \cdot 6 &amp; 5 \cdot 5 &amp; 6 \cdot 4 \\7 \cdot 3 &amp; 8 \cdot  &amp; 9 \cdot 1\end{pmatrix} = \begin{pmatrix}9 &amp; 16 &amp; 21 \\24 &amp; 25 &amp; 24 \\21 &amp; 16 &amp; 9\end{pmatrix}\]</span></p>
<p>In the following code chunks the computational process of Hadamard product is implemented in <code>Python</code>. Here both the from the scratch and use of external module versions are included.</p>
<p><strong>1. Compute Hadamard Product from Scratch (without Libraries)</strong></p>
<p>Here’s how you can compute the Hadamard product manually:</p>
<div id="1363954e" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define matrices A and B</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> [[<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>], [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute Hadamard product</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hadamard_product(A, B):</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the number of rows and columns</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    num_rows <span class="op">=</span> <span class="bu">len</span>(A)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    num_cols <span class="op">=</span> <span class="bu">len</span>(A[<span class="dv">0</span>])</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the result matrix</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> [[<span class="dv">0</span>]<span class="op">*</span>num_cols <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_rows)]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the Hadamard product</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_rows):</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_cols):</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>            result[i][j] <span class="op">=</span> A[i][j] <span class="op">*</span> B[i][j]</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Hadamard product</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>hadamard_product_result <span class="op">=</span> hadamard_product(A, B)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display result</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Hadamard Product (From Scratch):"</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> hadamard_product_result:</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hadamard Product (From Scratch):
[7, 16, 27]
[40, 55, 72]</code></pre>
</div>
</div>
<p><strong>2. Compute Hadamard Product Using <code>SymPy</code></strong></p>
<p>Here’s how to compute the Hadamard product using <code>SymPy</code>:</p>
<div id="9604477f" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define matrices A and B</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> sp.Matrix([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> sp.Matrix([[<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>], [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]])</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Hadamard product using SymPy</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>Hadamard_product_sympy <span class="op">=</span> A.multiply_elementwise(B)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display result</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Hadamard Product (Using SymPy):"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Hadamard_product_sympy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hadamard Product (Using SymPy):
Matrix([[7, 16, 27], [40, 55, 72]])</code></pre>
</div>
</div>
<p><strong>Practical Applications</strong></p>
<p><em>Application 1: Image Masking</em></p>
<p>The Hadamard product can be used for image masking. Here’s how you can apply a mask to an image and visualize it as shown in <a href="#fig-imgmask" class="quarto-xref">Fig&nbsp;<span>2.9</span></a>.</p>
<div id="cell-fig-imgmask" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated large image (2D array) using NumPy</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> np.random.rand(<span class="dv">100</span>, <span class="dv">100</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated mask (binary matrix) using NumPy</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.random.randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(<span class="dv">100</span>, <span class="dv">100</span>))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Hadamard product</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>masked_image <span class="op">=</span> image <span class="op">*</span> mask</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot original image and masked image</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].imshow(image, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Original Image'</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].imshow(masked_image, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Masked Image'</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-imgmask" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-imgmask-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="module_2_files/figure-html/fig-imgmask-output-1.png" width="902" height="431" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-imgmask-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.9: Demonstration of Masking in DIP using Hadamard Product
</figcaption>
</figure>
</div>
</div>
</div>
<p>Application 2: Element-wise Scaling in Neural Networks</p>
<p>The Hadamard product can be used for dropout<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> in neural networks. A simple simulated example is given below.</p>
<div id="cd1ec94d" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated large activations (2D array) using NumPy</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>activations <span class="op">=</span> np.random.rand(<span class="dv">100</span>, <span class="dv">100</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated dropout mask (binary matrix) using NumPy</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>dropout_mask <span class="op">=</span> np.random.randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(<span class="dv">100</span>, <span class="dv">100</span>))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply dropout</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>dropped_activations <span class="op">=</span> activations <span class="op">*</span> dropout_mask</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original Activations:"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(activations)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Dropout Mask:"</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dropout_mask)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Dropped Activations:"</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dropped_activations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original Activations:
[[0.06894617 0.3776627  0.33440532 ... 0.11017061 0.3622906  0.7539885 ]
 [0.50669932 0.62064754 0.36106756 ... 0.36415903 0.59856668 0.67680069]
 [0.22072699 0.90728473 0.43881544 ... 0.88782933 0.00681409 0.47232089]
 ...
 [0.20696451 0.44259024 0.93360471 ... 0.33349169 0.24542978 0.19109216]
 [0.90511144 0.70569249 0.36479526 ... 0.71831819 0.77584359 0.583544  ]
 [0.82030691 0.2622308  0.57648967 ... 0.99234794 0.74023406 0.50952928]]

Dropout Mask:
[[1 0 0 ... 0 0 1]
 [1 1 1 ... 1 0 0]
 [0 1 1 ... 0 0 0]
 ...
 [1 0 0 ... 1 1 1]
 [1 0 0 ... 0 1 1]
 [0 0 0 ... 0 1 1]]

Dropped Activations:
[[0.06894617 0.         0.         ... 0.         0.         0.7539885 ]
 [0.50669932 0.62064754 0.36106756 ... 0.36415903 0.         0.        ]
 [0.         0.90728473 0.43881544 ... 0.         0.         0.        ]
 ...
 [0.20696451 0.         0.         ... 0.33349169 0.24542978 0.19109216]
 [0.90511144 0.         0.         ... 0.         0.77584359 0.583544  ]
 [0.         0.         0.         ... 0.         0.74023406 0.50952928]]</code></pre>
</div>
</div>
<p>Application 3: Statistical Data Analysis</p>
<p>In statistics, the Hadamard product can be applied to scale covariance matrices. Here’s how we can compute the covariance matrix using matrix operations and apply scaling. Following <code>Python</code> code demonstrate this.</p>
<div id="c3b7e4ba" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated large dataset (2D array) using NumPy</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.rand(<span class="dv">100</span>, <span class="dv">10</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the mean of each column</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> np.mean(data, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Center the data</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>centered_data <span class="op">=</span> data <span class="op">-</span> mean</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the covariance matrix using matrix product operation</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>cov_matrix <span class="op">=</span> (centered_data.T <span class="op">@</span> centered_data) <span class="op">/</span> (centered_data.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>cov_matrix_sympy <span class="op">=</span> sp.Matrix(cov_matrix)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated scaling factors (2D array) using SymPy Matrix</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>scaling_factors <span class="op">=</span> sp.Matrix(np.random.rand(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Hadamard product</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>scaled_cov_matrix <span class="op">=</span> cov_matrix_sympy.multiply(scaling_factors)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Covariance Matrix:"</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cov_matrix_sympy)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Scaling Factors:"</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(scaling_factors)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Scaled Covariance Matrix:"</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(scaled_cov_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Covariance Matrix:
Matrix([[0.0917767756549757, -0.00231846920468021, 0.00631956965832033, 0.0103141856142347, 0.00178980482540451, 0.00175382457868899, -0.0169394103738993, 0.00759030424650395, 0.00335462576027497, -0.00673329178528108], [-0.00231846920468021, 0.0780427684025539, -0.0124198364681770, -0.00115432720981541, -0.00755837047352264, 0.00490241023588365, 0.00162704389180416, 0.00193409540629282, -0.00741077245348115, -0.00749399034438090], [0.00631956965832033, -0.0124198364681770, 0.0939413031048832, 0.00436891983117282, 0.00330840248130638, -0.0126415595066759, -0.00266414167487015, 0.00102485322040471, -0.0106289812153509, 0.0104244756319195], [0.0103141856142347, -0.00115432720981541, 0.00436891983117282, 0.0824590379149929, 0.000573918867501743, 0.00957165609934629, -0.00604000123116032, 0.00921663143350825, -0.00367487312182470, 0.00122122964324310], [0.00178980482540451, -0.00755837047352264, 0.00330840248130638, 0.000573918867501743, 0.0837022188162850, 0.00820263257003039, 0.000320865993343124, 0.0177849506610562, -0.00326860347774260, 0.00299231582670636], [0.00175382457868899, 0.00490241023588365, -0.0126415595066759, 0.00957165609934629, 0.00820263257003039, 0.0628257351791684, 0.000874518541289068, 0.00287804725796515, -0.00716117157943885, 0.000394534496818281], [-0.0169394103738993, 0.00162704389180416, -0.00266414167487015, -0.00604000123116032, 0.000320865993343124, 0.000874518541289068, 0.0890248830407284, -0.00330441759213419, 0.00885446559415291, 0.00676958530960561], [0.00759030424650395, 0.00193409540629282, 0.00102485322040471, 0.00921663143350825, 0.0177849506610562, 0.00287804725796515, -0.00330441759213419, 0.0844935599954661, 0.0100738268450946, -0.00906980778727026], [0.00335462576027497, -0.00741077245348115, -0.0106289812153509, -0.00367487312182470, -0.00326860347774260, -0.00716117157943885, 0.00885446559415291, 0.0100738268450946, 0.0754918952259983, -0.0111666568898086], [-0.00673329178528108, -0.00749399034438090, 0.0104244756319195, 0.00122122964324310, 0.00299231582670636, 0.000394534496818281, 0.00676958530960561, -0.00906980778727026, -0.0111666568898086, 0.0875581874238437]])

Scaling Factors:
Matrix([[0.815426278192760, 0.134707914881823, 0.492966917057263, 0.526969458056170, 0.574709310982182, 0.352843255964215, 0.887185538567414, 0.140539544175239, 0.269651721249414, 0.913828005977225], [0.878249897442327, 0.424152682141583, 0.0209393256230820, 0.154139786173812, 0.135654984788258, 0.302018168798723, 0.288731064565096, 0.385354792131266, 0.185641987803183, 0.123777425594904], [0.371153863577965, 0.108219056259665, 0.544093107049168, 0.573962112090211, 0.506379827589065, 0.349658022688059, 0.436759122564185, 0.254120141497413, 0.826337415383872, 0.481451164676728], [0.426152351895796, 0.160936011893139, 0.726475848279090, 0.318398838239760, 0.0869723758761120, 0.669839836406523, 0.410837107230599, 0.877671621998718, 0.634168166978639, 0.274509754325122], [0.453042028776812, 0.327644666684450, 0.571249402049481, 0.624669243676812, 0.832377451182500, 0.0468726218003922, 0.339836882411105, 0.566808438504695, 0.633708492326687, 0.0291543515123359], [0.451736623236072, 0.824457809593277, 0.0468262130838721, 0.414422830791189, 0.665847708940026, 0.150434046078858, 0.205694572941020, 0.442249051575973, 0.952011532573108, 0.832626802888198], [0.653128026260542, 0.160861376206219, 0.565877809471253, 0.214072854043979, 0.0167121306178294, 0.136029674702122, 0.101299626341632, 0.634929678466512, 0.886586287684352, 0.413033646466836], [0.765043992151462, 0.878200823093136, 0.661559847620237, 0.487275955471030, 0.810634716317772, 0.691067279086228, 0.233034346203150, 0.243685028223400, 0.968754188515623, 0.277710612576935], [0.543450644383474, 0.136833643173171, 0.839712926132745, 0.666874558212578, 0.197772746922458, 0.804484447939160, 0.429887114495949, 0.866946178251795, 0.967166730531108, 0.378003417138431], [0.615430489208242, 0.774849940106600, 0.566429331630759, 0.256121121628592, 0.438750969942939, 0.486059612700822, 0.0191618473801575, 0.790279808976955, 0.430604564330450, 0.942181887452992]])

Scaled Covariance Matrix:
Matrix([[0.0735675834825648, 0.0149385187901641, 0.0516691506364356, 0.0573471497773849, 0.0627642664152243, 0.0435159764037236, 0.0900861215506575, 0.0131347392451777, 0.0315642474043691, 0.0810030204681982], [0.0542421786651330, 0.0279647599529843, -0.0194605667032628, -0.00494881038120091, -0.00332087114031559, 0.00997311580445879, 0.0103036633559031, 0.0126202839006710, -0.00433305134650792, -0.00354650575765321], [0.0264453617408100, 0.00420876431073869, 0.0545898315104741, 0.0490641405603461, 0.0474914292929121, 0.0293678673621165, 0.0389687302987745, 0.0176751696094875, 0.0626976046500674, 0.0452241116805442], [0.0506029058391468, 0.0302885624603531, 0.0684033878009331, 0.0394051575658211, 0.0291854480436259, 0.0647043485552080, 0.0467461431273585, 0.0752354463648461, 0.0684913894778833, 0.0418344319333943], [0.0518009455509017, 0.0492146183130805, 0.0620376322953095, 0.0648668338893251, 0.0919509554637798, 0.0162064441614457, 0.0340478685702888, 0.0538227755352786, 0.0786700397081100, 0.0183757748163255], [0.0363435693860420, 0.0589667034107401, 0.00527928117940762, 0.0255471071360049, 0.0458685507822146, 0.0104649053072823, 0.0147813277282509, 0.0351179253014830, 0.0588230612787394, 0.0501255003850680], [0.0491885569563579, 0.0158497359551128, 0.0455311257524880, 0.0135211492700563, -0.00700906936453937, 0.00992381823754170, -0.00573045777848894, 0.0615823219224910, 0.0779441683404056, 0.0280962917012629], [0.0839293436645640, 0.0796584543161477, 0.0786793212754548, 0.0649825149540138, 0.0891164092330685, 0.0726979237431117, 0.0416745499907713, 0.0415726587915474, 0.107869373559443, 0.0304764049507348], [0.0336439567015974, 0.000540425736096700, 0.0595845458181088, 0.0426330754490364, 0.00607677949206663, 0.0550074490683428, 0.0275840912846151, 0.0513690478136324, 0.0653405037449039, 0.0144342366508952], [0.0391513406659179, 0.0579850703928723, 0.0428599800606040, 0.0157098697088934, 0.0322207232826521, 0.0282516350353530, -0.00653510828834694, 0.0633599327175958, 0.0325719569131053, 0.0772411854251056]])</code></pre>
</div>
</div>
</section>
<section id="practice-problems" class="level4" data-number="2.2.2.2">
<h4 data-number="2.2.2.2" class="anchored" data-anchor-id="practice-problems"><span class="header-section-number">2.2.2.2</span> Practice Problems</h4>
<p><strong>Problem 1: Basic Hadamard Product</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}1&amp;2\\3&amp;4\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}5&amp;6\\7&amp;8\end{bmatrix}\]</span></p>
<p>Find the Hadamard product <span class="math inline">\(C=A\circ B\)</span>.</p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[C=\begin{bmatrix}1\cdot 5&amp;2\cdot 6\\3\cdot7&amp;4\cdot 8 \end{bmatrix}=\begin{bmatrix}5&amp;12\\21&amp;32\end{bmatrix}\]</span></p>
<p><strong>Problem 2: Hadamard Product with Identity Matrix</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}1&amp;2&amp;3\\4&amp;5&amp;6\end{bmatrix}\]</span> <span class="math display">\[I=\begin{bmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\end{bmatrix}\]</span></p>
<p>Find the Hadamard product <span class="math inline">\(C=A\circ I\)</span>.</p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[C=\begin{bmatrix}1\cdot1&amp;2\cdot 0&amp;3\cdot 0\\4\cdot 0&amp;5\cdot 1&amp;6\cdot 0 \end{bmatrix}= \begin{bmatrix} 1&amp;0&amp;0\\0&amp;5&amp;0\end{bmatrix}\]</span></p>
<p><strong>Problem 3: Hadamard Product with Zero Matrix</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}3&amp;4\\5&amp;6\end{bmatrix}\]</span> <span class="math display">\[Z=\begin{bmatrix}0&amp;0\\0&amp;0\end{bmatrix}\]</span></p>
<p>Find the Hadamard product <span class="math inline">\(C=A\circ Z\)</span>.</p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[C=\begin{bmatrix}3\cdot 0&amp;4\cdot 0\\ 5\cdot 0&amp;6\cdot 0 \end{bmatrix}=\begin{bmatrix}0&amp;0\\0&amp;0\end{bmatrix}\]</span></p>
<p><strong>Problem 4: Hadamard Product of Two Identity Matrices</strong></p>
<p>Given identity matrices: <span class="math display">\[I_2=\begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix}\]</span> <span class="math display">\[I_3=\begin{bmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\end{bmatrix}\]</span></p>
<p>Find the Hadamard product <span class="math inline">\(C=I_2\circ I_3\)</span> (extend <span class="math inline">\(I_2\)</span> to match dimensions of <span class="math inline">\(I_3\)</span>).</p>
<p><strong>Solution:</strong></p>
<p>Extend <span class="math inline">\(I_2\)</span> to <span class="math inline">\(I_3\)</span>: <span class="math display">\[I_2=\begin{bmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;0\end{bmatrix}\]</span></p>
<p><span class="math display">\[C=\begin{bmatrix}1\cdot 1&amp;0\cdot 0&amp;0\cdot 0\\0\cdot 0&amp;1\cdot 1&amp;0\cdot 0\\0\cdot 0&amp;0\cdot 0&amp;0\cdot 1\end{bmatrix}=\begin{bmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;0\end{bmatrix}\]</span></p>
<p><strong>Problem 5: Hadamard Product with Random Matrices</strong></p>
<p>Given random matrices: <span class="math display">\[A=\begin{bmatrix}2&amp;3\\1&amp;4\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}0&amp;5\\6&amp;2\end{bmatrix}\]</span></p>
<p>Find the Hadamard product <span class="math inline">\(C=A\circ B\)</span>.</p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[C=\begin{bmatrix}2\cdot 0&amp;3\cdot 5\\1\cdot 6&amp;4\cdot 2\end{bmatrix}=\begin{bmatrix}0&amp;15\\6&amp;8\end{bmatrix}\]</span></p>
<p><strong>Problem 6: Hadamard Product of 3x3 Matrices</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}1&amp;2&amp;3\\4&amp;5&amp;6\\7&amp;8&amp;9\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}9&amp;8&amp;7\\6&amp;5&amp;4\\3&amp;2&amp;1\end{bmatrix}\]</span></p>
<p>Find the Hadamard product <span class="math inline">\(C=A\circ B\)</span>.</p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[C=\begin{bmatrix}1\cdot 9&amp;2\cdot 8&amp;3\cdot 7\\4\cdot 6&amp;5\cdot 5&amp;6\cdot 4\\7\cdot 3&amp;8\cdot 2&amp;9\cdot 1\end{bmatrix}=\begin{bmatrix}9&amp;16&amp;21\\24&amp;25&amp;24\\21&amp;16&amp;9\end{bmatrix}\]</span></p>
<p><strong>Problem 7: Hadamard Product of Column Vectors</strong></p>
<p>Given column vectors: <span class="math display">\[u=\begin{bmatrix}2\\3\end{bmatrix}\]</span> <span class="math display">\[v=\begin{bmatrix}5\\6\end{bmatrix}\]</span></p>
<p>Find the Hadamard product <span class="math inline">\(w=u\circ v\)</span>.</p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[w=\begin{bmatrix}2\cdot 5\\3\cdot 6\end{bmatrix}=\begin{bmatrix}10\\18\end{bmatrix}\]</span></p>
<p><strong>Problem 8: Hadamard Product with Non-Square Matrices</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}1&amp;2\\3&amp;4\\5&amp;6\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}7&amp;8\\9&amp;10\end{bmatrix}\]</span></p>
<p>Find the Hadamard product <span class="math inline">\(C=A\circ B\)</span> (extend <span class="math inline">\(B\)</span> to match dimensions of <span class="math inline">\(A\)</span>).</p>
<p><strong>Solution:</strong></p>
<p>Extend <span class="math inline">\(B\)</span> to match dimensions of <span class="math inline">\(A\)</span>: <span class="math display">\[B=\begin{bmatrix}7&amp;8\\9&amp;10\\7&amp;8\end{bmatrix}\]</span></p>
<p><span class="math display">\[C=\begin{bmatrix}1\cdot 7&amp;2\cdot 8\\3\cdot 9&amp;4\cdot 10\\5\cdot 7&amp;6\cdot 8\end{bmatrix}=\begin{bmatrix}7&amp;16\\27&amp;40\\35&amp;48\end{bmatrix}\]</span></p>
<p><strong>Problem 9: Hadamard Product in Image Processing</strong></p>
<p>Given matrices representing image pixel values: <span class="math display">\[A=\begin{bmatrix}10&amp;20\\30&amp;40\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}0.5&amp;1.5\\2.0&amp;0.5\end{bmatrix}\]</span></p>
<p>Find the Hadamard product <span class="math inline">\(C=A\circ B\)</span>.</p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[C=\begin{bmatrix}10\cdot 0.5&amp;20\cdot 1.5\\30\cdot 2.0&amp;40\cdot 0.5\end{bmatrix}=\begin{bmatrix}5&amp;30\\60&amp;20\end{bmatrix}\]</span></p>
<p><strong>Problem 10: Hadamard Product in Statistical Data</strong></p>
<p>Given matrices representing two sets of statistical data:</p>
<p><span class="math display">\[A=\begin{bmatrix}5&amp;6&amp;7\\8&amp;9&amp;10\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}1&amp;2&amp;3\\4&amp;5&amp;6\end{bmatrix}\]</span></p>
<p>Find the Hadamard product <span class="math inline">\(C=A\circ B\)</span>.</p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[C=\begin{bmatrix}5\cdot 1&amp;6\cdot 2&amp;7\cdot 3\\8\cdot 4&amp;9\cdot 5&amp;10\cdot 6\end{bmatrix}=\begin{bmatrix}5&amp;12&amp;21\\32&amp;45&amp;60\end{bmatrix}\]</span></p>
</section>
<section id="inner-product-of-matrices" class="level4" data-number="2.2.2.3">
<h4 data-number="2.2.2.3" class="anchored" data-anchor-id="inner-product-of-matrices"><span class="header-section-number">2.2.2.3</span> Inner Product of Matrices</h4>
<p>The inner product of two matrices is a generalized extension of the dot product, where each matrix is treated as a vector in a high-dimensional space. For two matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> of the same dimension <span class="math inline">\(m \times n\)</span>, the inner product is defined as the sum of the element-wise products of the matrices.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition (Inner product)
</div>
</div>
<div class="callout-body-container callout-body">
<p>For two matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> of dimension <span class="math inline">\(m \times n\)</span>, the inner product <span class="math inline">\(\langle A, B \rangle\)</span> is given by:</p>
<p><span class="math display">\[\langle A, B \rangle = \sum_{i=1}^{m} \sum_{j=1}^{n} A_{ij} \cdot B_{ij}\]</span></p>
<p>where <span class="math inline">\(\cdot\)</span> denotes element-wise multiplication.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Properties
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Commutativity</strong>: <span class="math display">\[\langle A, B \rangle = \langle B, A \rangle\]</span></p></li>
<li><p><strong>Linearity</strong>: <span class="math display">\[\langle A + C, B \rangle = \langle A, B \rangle + \langle C, B \rangle\]</span></p></li>
<li><p><strong>Positive Definiteness</strong>: <span class="math display">\[\langle A, A \rangle \geq 0\]</span> with equality if and only if <span class="math inline">\(A\)</span> is a zero matrix.</p></li>
</ol>
</div>
</div>
<p>Some simple examples showing the mathematical process of calculating the inner product is given bellow.</p>
<p><strong>Example 1: Basic Inner Product</strong></p>
<p>Given matrices:</p>
<p><span class="math display">\[A = \begin{pmatrix}1 &amp; 2 \\3 &amp; 4\end{pmatrix}, \quad B = \begin{pmatrix}5 &amp; 6 \\7 &amp; 8\end{pmatrix}\]</span></p>
<p>The inner product <span class="math inline">\(\langle A, B \rangle\)</span> is:</p>
<p><span class="math display">\[\langle A, B \rangle = 1 \cdot 5 + 2 \cdot 6 + 3 \cdot 7 + 4 \cdot 8 = 5 + 12 + 21 + 32 = 70\]</span></p>
<p><strong>Example 2: Inner Product with Larger Matrices</strong></p>
<p>Given matrices:</p>
<p><span class="math display">\[A = \begin{pmatrix}1 &amp; 2 &amp; 3 \\4 &amp; 5 &amp; 6 \\7 &amp; 8 &amp; 9\end{pmatrix}, \quad B = \begin{pmatrix}9 &amp; 8 &amp; 7 \\6 &amp; 5 &amp; 4 \\3 &amp; 2 &amp; 1\end{pmatrix}\]</span></p>
<p>The inner product <span class="math inline">\(\langle A, B \rangle\)</span> is calculated as: <span class="math display">\[\begin{align*}
\langle A, B \rangle &amp;= 1 \cdot 9 + 2 \cdot 8 + 3 \cdot 7 + 4 \cdot 6 + 5 \cdot 5 + 6 \cdot 4 + 7 \cdot 3 + 8 \cdot 2 + 9 \cdot 1\\
&amp;= 9 + 16 + 21 + 24 + 25 + 24 + 21 + 16 + 9\\
&amp;= 175
\end{align*}\]</span></p>
</section>
<section id="practice-problems-1" class="level4" data-number="2.2.2.4">
<h4 data-number="2.2.2.4" class="anchored" data-anchor-id="practice-problems-1"><span class="header-section-number">2.2.2.4</span> Practice Problems</h4>
<p><strong>Problem 1: Inner Product of 2x2 Matrices</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}1&amp;2\\3&amp;4\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}5&amp;6\\7&amp;8\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
\langle A,B \rangle &amp;= \sum_{i,j} A_{ij} B_{ij} \\
&amp;= 1\cdot5 + 2\cdot6 + 3\cdot7 + 4\cdot8 \\
&amp;= 5 + 12 + 21 + 32 \\
&amp;= 70
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 2: Inner Product of 3x3 Matrices</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}1&amp;0&amp;2\\3&amp;4&amp;5\\6&amp;7&amp;8\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}8&amp;7&amp;6\\5&amp;4&amp;3\\2&amp;1&amp;0\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
\langle A,B \rangle &amp;= \sum_{i,j} A_{ij} B_{ij} \\
&amp;= 1\cdot8 + 0\cdot7 + 2\cdot6 + \\
&amp;\quad 3\cdot5 + 4\cdot4 + 5\cdot3 + \\
&amp;\quad 6\cdot2 + 7\cdot1 + 8\cdot0 \\
&amp;= 8 + 0 + 12 + 15 + 16 + 15 + 12 + 7 + 0 \\
&amp;= 85
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 3: Inner Product of Diagonal Matrices</strong></p>
<p>Given diagonal matrices: <span class="math display">\[A=\begin{bmatrix}2&amp;0&amp;0\\0&amp;3&amp;0\\0&amp;0&amp;4\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}5&amp;0&amp;0\\0&amp;6&amp;0\\0&amp;0&amp;7\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
\langle A,B \rangle &amp;= \sum_{i,j} A_{ij} B_{ij} \\
&amp;= 2\cdot5 + 0\cdot0 + 0\cdot0 + \\
&amp;\quad 0\cdot0 + 3\cdot6 + 0\cdot0 + \\
&amp;\quad 0\cdot0 + 0\cdot0 + 4\cdot7 \\
&amp;= 10 + 0 + 0 + 0 + 18 + 0 + 0 + 0 + 28 \\
&amp;= 56
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 4: Inner Product of Column Vectors</strong></p>
<p>Given column vectors: <span class="math display">\[u=\begin{bmatrix}1\\2\\3\end{bmatrix}\]</span> <span class="math display">\[v=\begin{bmatrix}4\\5\\6\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
\langle u,v \rangle &amp;= \sum_{i} u_i v_i \\
&amp;= 1\cdot4 + 2\cdot5 + 3\cdot6 \\
&amp;= 4 + 10 + 18 \\
&amp;= 32
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 5: Inner Product with Random Matrices</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}3&amp;2\\1&amp;4\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}5&amp;7\\8&amp;6\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
\langle A,B \rangle &amp;= \sum_{i,j} A_{ij} B_{ij} \\
&amp;= 3\cdot5 + 2\cdot7 + \\
&amp;\quad 1\cdot8 + 4\cdot6 \\
&amp;= 15 + 14 + 8 + 24 \\
&amp;= 61
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 6: Inner Product of 2x3 and 3x2 Matrices</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}1&amp;2&amp;3\\4&amp;5&amp;6\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}7&amp;8\\9&amp;10\\11&amp;12\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
\langle A,B \rangle &amp;= \sum_{i,j} A_{ij} B_{ij} \\
&amp;= 1\cdot7 + 2\cdot8 + 3\cdot11 + \\
&amp;\quad 4\cdot9 + 5\cdot10 + 6\cdot12 \\
&amp;= 7 + 16 + 33 + 36 + 50 + 72 \\
&amp;= 214
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 7: Inner Product with Transpose Operation</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}2&amp;3\\4&amp;5\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}6&amp;7\\8&amp;9\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
\langle A,B \rangle &amp;= \sum_{i,j} A_{ij} B_{ij} \\
&amp;= 2\cdot6 + 3\cdot7 + \\
&amp;\quad 4\cdot8 + 5\cdot9 \\
&amp;= 12 + 21 + 32 + 45 \\
&amp;= 110
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 8: Inner Product of Symmetric Matrices</strong></p>
<p>Given symmetric matrices: <span class="math display">\[A=\begin{bmatrix}1&amp;2\\2&amp;3\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}4&amp;5\\5&amp;6\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
\langle A,B \rangle &amp;= \sum_{i,j} A_{ij} B_{ij} \\
&amp;= 1\cdot4 + 2\cdot5 + \\
&amp;\quad 2\cdot5 + 3\cdot6 \\
&amp;= 4 + 10 + 10 + 18 \\
&amp;= 42
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 9: Inner Product with Complex Matrices</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}1+i&amp;2-i\\3+i&amp;4-i\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}5-i&amp;6+i\\7-i&amp;8+i\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
\langle A,B \rangle &amp;= \sum_{i,j} \text{Re}(A_{ij} \overline{B_{ij}}) \\
&amp;= (1+i)\cdot(5+i) + (2-i)\cdot(6-i) + \\
&amp;\quad (3+i)\cdot(7+i) + (4-i)\cdot(8+i) \\
&amp;= (5+i+5i-i^2) + (12-i-6i+i^2) + \\
&amp;\quad (21+i+7i-i^2) + (32+i-8i-i^2) \\
&amp;= 5+5 + 12 - 6 + 21 + 32 - 2 \\
&amp;= 62
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 10: Inner Product of 4x4 Matrices</strong></p>
<p>Given matrices: <span class="math display">\[A=\begin{bmatrix}1&amp;2&amp;3&amp;4\\5&amp;6&amp;7&amp;8\\9&amp;10&amp;11&amp;12\\13&amp;14&amp;15&amp;16\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}16&amp;15&amp;14&amp;13\\12&amp;11&amp;10&amp;9\\8&amp;7&amp;6&amp;5\\4&amp;3&amp;2&amp;1\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
\langle A,B \rangle &amp;= \sum_{i,j} A_{ij} B_{ij} \\
&amp;= 1\cdot16 + 2\cdot15 + 3\cdot14 + 4\cdot13 + \\
&amp;\quad 5\cdot12 + 6\cdot11 + 7\cdot10 + 8\cdot9 + \\
&amp;\quad 9\cdot8 + 10\cdot7 + 11\cdot6 + 12\cdot5 + \\
&amp;\quad 13\cdot4 + 14\cdot3 + 15\cdot2 + 16\cdot1 \\
&amp;= 16 + 30 + 42 + 52 + 60 + 66 + 70 + 72 + \\
&amp;\quad 72 + 70 + 66 + 60 + 52 + 42 + 30 + 16 \\
&amp;= 696
\end{align*}\]</span></p>
<hr>
<p>Now let’s look into the computational part of <em>inner product</em>.</p>
<ol type="1">
<li>Compute Inner Product from Scratch (without Libraries)</li>
</ol>
<p>Here’s how you can compute the inner product from the scratch:</p>
<div id="ace8d1b5" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define matrices A and B</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> [[<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>], [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute inner product</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> inner_product(A, B):</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the number of rows and columns</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    num_rows <span class="op">=</span> <span class="bu">len</span>(A)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    num_cols <span class="op">=</span> <span class="bu">len</span>(A[<span class="dv">0</span>])</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the result</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the inner product</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_rows):</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_cols):</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>            result <span class="op">+=</span> A[i][j] <span class="op">*</span> B[i][j]</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute inner product</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>inner_product_result <span class="op">=</span> inner_product(A, B)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display result</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Inner Product (From Scratch):"</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inner_product_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inner Product (From Scratch):
217</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Compute Inner Product Using <code>NumPy</code></li>
</ol>
<p>Here’s how to compute the inner product using Numpy:</p>
<div id="e8648728" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define matrices A and B</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>], [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]])</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculating innerproduct</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>inner_product <span class="op">=</span> (A<span class="op">*</span>B).<span class="bu">sum</span>() <span class="co"># calculate element-wise product, then column sum</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Inner Product (Using numpy):"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inner_product)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inner Product (Using numpy):
217</code></pre>
</div>
</div>
<p>The same operation can be done using <code>SymPy</code> functions as follows.</p>
<div id="7f678680" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define matrices A and B</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> sp.Matrix([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> sp.Matrix([[<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>], [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]])</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute element-wise product</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>elementwise_product <span class="op">=</span> A.multiply_elementwise(B)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate sum of each column</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>inner_product_sympy <span class="op">=</span> np.<span class="bu">sum</span>(elementwise_product)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display result</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Inner Product (Using SymPy):"</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inner_product_sympy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inner Product (Using SymPy):
217</code></pre>
</div>
</div>
<p>A vector dot product (in Physics) can be calculated using <code>SymPy</code> <code>.dot()</code> function as shown below.</p>
<p>Let <span class="math inline">\(A=\begin{pmatrix}1&amp;2&amp;3\end{pmatrix}\)</span> and <span class="math inline">\(B=\begin{pmatrix}4&amp;5&amp;6\end{pmatrix}\)</span>, then the dot product, <span class="math inline">\(A\cdot B\)</span> is computed as:</p>
<div id="3beca702" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>A<span class="op">=</span>sp.Matrix([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>B<span class="op">=</span>sp.Matrix([<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>])</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>display(A.dot(B)) <span class="co"># calculate fot product of A and B</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><span class="math inline">\(\displaystyle 32\)</span></p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
A word of caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>In <code>SymPy</code> , <code>sp.Matrix([1,2,3])</code> create a column vector. But <code>np.array([1,2,3])</code> creates a row vector. So be careful while applying matrix/ dot product operations on these objects.</p>
</div>
</div>
<p>The same dot product using <code>numpy</code> object can be done as follows:</p>
<div id="1fe9bfbd" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>A<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>B<span class="op">=</span>np.array([<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>])</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>display(A.dot(B.T))<span class="co"># dot() stands for dot product B.T represents the transpose of B</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>32</code></pre>
</div>
</div>
<p><strong>Practical Applications</strong></p>
<p>Application 1: Signal Processing</p>
<p>In signal processing, the inner product can be used to measure the similarity between two signals. Here the most popular measure of similarity is the <code>cosine</code> similarity. This measure is defined as:</p>
<p><span class="math display">\[\cos \theta=\dfrac{A\cdot B}{||A|| ||B||}\]</span></p>
<p>Now consider two digital signals are given. It’s cosine similarity measure can be calculated with a simulated data as shown below.</p>
<div id="3f4e941a" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated large signals (1D array) using NumPy</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>signal1 <span class="op">=</span> np.sin(np.random.rand(<span class="dv">1000</span>))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>signal2 <span class="op">=</span> np.cos(np.random.rand(<span class="dv">1000</span>))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute inner product</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>inner_product_signal <span class="op">=</span> np.dot(signal1, signal2)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">#cosine_sim=np.dot(signal1,signal2)/(np.linalg.norm(signal1)*np.linalg.norm(signal2))</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display result</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>cosine_sim<span class="op">=</span>inner_product_signal<span class="op">/</span>(np.sqrt(np.dot(signal1,signal1))<span class="op">*</span>np.sqrt(np.dot(signal2,signal2)))</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Inner Product (Using numpy):"</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inner_product_signal)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Similarity of signals:"</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cosine_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inner Product (Using numpy):
387.8012139700734
Similarity of signals:
0.8704891845819591</code></pre>
</div>
</div>
<p>Application 2: Machine Learning - Feature Similarity</p>
<p>In machine learning, the inner product is used to calculate the similarity between feature vectors.</p>
<div id="b9eeaafb" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated feature vectors (2D array) using NumPy</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>features1 <span class="op">=</span> np.random.rand(<span class="dv">100</span>, <span class="dv">10</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>features2 <span class="op">=</span> np.random.rand(<span class="dv">100</span>, <span class="dv">10</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute inner product for each feature vector</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>inner_products <span class="op">=</span> np.einsum(<span class="st">'ij,ij-&gt;i'</span>, features1, features2) <span class="co"># use Einstien's sum</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Inner Products of Feature Vectors:"</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>display(inner_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inner Products of Feature Vectors:</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>array([2.61102338, 1.4155999 , 3.25000824, 2.41655936, 1.93157566,
       2.19477819, 2.12679698, 3.06553894, 3.74554647, 4.10990809,
       1.98131966, 2.84450384, 2.2243122 , 2.58409242, 2.2537591 ,
       3.17451944, 3.86092924, 1.90632106, 2.47826298, 2.01204619,
       4.31510112, 2.43671069, 3.58885605, 1.45523711, 2.52128395,
       3.16348974, 3.1847619 , 2.66598594, 2.63693273, 1.48815669,
       1.89682381, 2.00764338, 1.82954687, 2.19787784, 1.82103506,
       2.70682361, 4.14842985, 2.80672499, 3.02116063, 2.19998533,
       3.10230074, 2.60100442, 3.65672942, 1.13288363, 2.23361306,
       2.61852013, 2.43124543, 2.3762841 , 2.99733032, 3.58111295,
       2.60701381, 1.8212961 , 2.6341459 , 1.81749036, 1.98306523,
       2.40974101, 3.89306424, 1.56214172, 2.32677802, 1.26413856,
       3.09345585, 3.70796521, 1.69645084, 2.10669788, 1.72513793,
       1.89343271, 3.40714794, 4.20275318, 2.22815523, 1.60218578,
       0.9772914 , 1.42237772, 1.69563219, 3.28445863, 2.58328416,
       2.46313616, 2.43927919, 2.79230138, 2.60259376, 2.7408041 ,
       2.8551307 , 2.37075423, 3.20620134, 1.91039534, 2.81772451,
       2.82104929, 2.22069818, 3.0052798 , 2.58203716, 1.10423113,
       2.73876471, 1.8166736 , 1.929993  , 1.46680923, 1.79427732,
       3.83369994, 2.37803706, 2.32127536, 1.9612972 , 2.74966051])</code></pre>
</div>
</div>
<p>Application 3: Covariance Matrix in Statistics</p>
<p>The inner product can be used to compute covariance matrices for statistical data analysis. If <span class="math inline">\(X\)</span> is a given distribution and <span class="math inline">\(x=X-\bar{X}\)</span>. Then the covariance of <span class="math inline">\(X\)</span> can be calculated as <span class="math inline">\(cov(X)=\dfrac{1}{n-1}(x\cdot x^T)\)</span> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. The python code a simulated data is shown below.</p>
<div id="c9854530" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated large dataset (2D array) using NumPy</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.rand(<span class="dv">100</span>, <span class="dv">10</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the mean of each column</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> np.mean(data, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Center the data</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>centered_data <span class="op">=</span> data <span class="op">-</span> mean</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the covariance matrix using matrix product operation</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>cov_matrix <span class="op">=</span> (centered_data.T <span class="op">@</span> centered_data) <span class="op">/</span> (centered_data.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>cov_matrix_sympy <span class="op">=</span> sp.Matrix(cov_matrix)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Covariance Matrix:"</span>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>display(cov_matrix_sympy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Covariance Matrix:</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}0.0826206001773978 &amp; 0.0190949660858603 &amp; -0.00657601964915786 &amp; 0.00978377417600984 &amp; -0.00396647392861959 &amp; 0.000802133525943591 &amp; -0.0134785277081127 &amp; -0.00256796402919267 &amp; -0.00185751912007374 &amp; 0.00188002717127027\\0.0190949660858603 &amp; 0.0863758537538684 &amp; 0.00465307022298206 &amp; 0.000634206362120265 &amp; -0.00640940750721016 &amp; 0.0065986789463667 &amp; 0.00406109518532904 &amp; -0.0179234376071376 &amp; -0.00178442832330686 &amp; 0.00369185471729624\\-0.00657601964915786 &amp; 0.00465307022298206 &amp; 0.101676710745905 &amp; 0.00129246783357073 &amp; 0.0115252858291662 &amp; -0.01255532067245 &amp; -0.0192138774615725 &amp; 0.00485976103158238 &amp; -0.00322152721653495 &amp; 0.00922517245585824\\0.00978377417600984 &amp; 0.000634206362120265 &amp; 0.00129246783357073 &amp; 0.085566173675165 &amp; -0.0158016024825646 &amp; -0.00404732296208295 &amp; 0.00589174594818515 &amp; -0.00714704177669192 &amp; -0.000932476370712307 &amp; 0.0105522552620407\\-0.00396647392861959 &amp; -0.00640940750721016 &amp; 0.0115252858291662 &amp; -0.0158016024825646 &amp; 0.0924268262154616 &amp; 0.000905376524254485 &amp; -0.00719787223360057 &amp; 0.0120360350180386 &amp; -0.00659030600004849 &amp; -0.0098195132374878\\0.000802133525943591 &amp; 0.0065986789463667 &amp; -0.01255532067245 &amp; -0.00404732296208295 &amp; 0.000905376524254485 &amp; 0.0880898700386659 &amp; 0.0147620989308444 &amp; 0.00727920696730826 &amp; 0.00475276495566338 &amp; 0.00114623860884323\\-0.0134785277081127 &amp; 0.00406109518532904 &amp; -0.0192138774615725 &amp; 0.00589174594818515 &amp; -0.00719787223360057 &amp; 0.0147620989308444 &amp; 0.0825882799176838 &amp; 0.0112752622146153 &amp; 0.00113978535836565 &amp; 0.00439117016673781\\-0.00256796402919267 &amp; -0.0179234376071376 &amp; 0.00485976103158238 &amp; -0.00714704177669192 &amp; 0.0120360350180386 &amp; 0.00727920696730826 &amp; 0.0112752622146153 &amp; 0.0968847538289747 &amp; 0.0102075882160858 &amp; -0.0101947768632437\\-0.00185751912007374 &amp; -0.00178442832330686 &amp; -0.00322152721653495 &amp; -0.000932476370712307 &amp; -0.00659030600004849 &amp; 0.00475276495566338 &amp; 0.00113978535836565 &amp; 0.0102075882160858 &amp; 0.0860985487815505 &amp; -0.00919047492964528\\0.00188002717127027 &amp; 0.00369185471729624 &amp; 0.00922517245585824 &amp; 0.0105522552620407 &amp; -0.0098195132374878 &amp; 0.00114623860884323 &amp; 0.00439117016673781 &amp; -0.0101947768632437 &amp; -0.00919047492964528 &amp; 0.0779287838710158\end{matrix}\right]\)</span></p>
</div>
</div>
<p>These examples demonstrate the use of inner product and dot product in various applications.</p>
</section>
<section id="outer-product" class="level4" data-number="2.2.2.5">
<h4 data-number="2.2.2.5" class="anchored" data-anchor-id="outer-product"><span class="header-section-number">2.2.2.5</span> Outer Product</h4>
<p>The outer product of two vectors results in a matrix, and it is a way to combine these vectors into a higher-dimensional representation.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition (Outer Product)
</div>
</div>
<div class="callout-body-container callout-body">
<p>For two vectors <span class="math inline">\(\mathbf{u}\)</span> and <span class="math inline">\(\mathbf{v}\)</span> of dimensions <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> respectively, the outer product <span class="math inline">\(\mathbf{u} \otimes \mathbf{v}\)</span> is an <span class="math inline">\(m \times n\)</span> matrix defined as:</p>
<p><span class="math display">\[(\mathbf{u} \otimes \mathbf{v})_{ij} = u_i \cdot v_j\]</span></p>
<p>where <span class="math inline">\(\cdot\)</span> denotes the outer product operation. In matrix notation, for two column vectors <span class="math inline">\(u,v\)</span>, <span class="math display">\[u\otimes v=uv^T\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Properties
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Linearity</strong>: <span class="math display">\[(\mathbf{u} + \mathbf{w}) \otimes \mathbf{v} = (\mathbf{u} \otimes \mathbf{v}) + (\mathbf{w} \otimes \mathbf{v})\]</span></p></li>
<li><p><strong>Distributivity</strong>: <span class="math display">\[\mathbf{u} \otimes (\mathbf{v} + \mathbf{w}) = (\mathbf{u} \otimes \mathbf{v}) + (\mathbf{u} \otimes \mathbf{w})\]</span></p></li>
<li><p><strong>Associativity</strong>: <span class="math display">\[(\mathbf{u} \otimes \mathbf{v}) \otimes \mathbf{w} = \mathbf{u} \otimes (\mathbf{v} \otimes \mathbf{w})\]</span></p></li>
</ol>
</div>
</div>
<p>Some simple examples of outer product is given below.</p>
<p><strong>Example 1: Basic Outer Product</strong></p>
<p>Given vectors:</p>
<p><span class="math display">\[\mathbf{u} = \begin{pmatrix}1 \\2\end{pmatrix}, \quad\mathbf{v} = \begin{pmatrix}3 \\4 \\5\end{pmatrix}\]</span></p>
<p>The outer product <span class="math inline">\(\mathbf{u} \otimes \mathbf{v}\)</span> is:</p>
<p><span class="math display">\[\mathbf{u} \otimes \mathbf{v} = \begin{pmatrix}1 \cdot 3 &amp; 1 \cdot 4 &amp; 1 \cdot 5 \\2 \cdot 3 &amp; 2 \cdot 4 &amp; 2 \cdot 5\end{pmatrix} = \begin{pmatrix}3 &amp; 4 &amp; 5 \\6 &amp; 8 &amp; 10\end{pmatrix}\]</span></p>
<p><strong>Example 2: Outer Product with Larger Vectors</strong></p>
<p>Given vectors: <span class="math display">\[\mathbf{u} = \begin{pmatrix}1 \\2 \\3\end{pmatrix}, \quad\mathbf{v} = \begin{pmatrix}4 \\5\end{pmatrix}\]</span></p>
<p>The outer product <span class="math inline">\(\mathbf{u} \otimes \mathbf{v}\)</span> is:</p>
<p><span class="math display">\[\mathbf{u} \otimes \mathbf{v} = \begin{pmatrix}1 \cdot 4 &amp; 1 \cdot 5 \\2 \cdot 4 &amp; 2 \cdot 5 \\3 \cdot 4 &amp; 3 \cdot 5\end{pmatrix} = \begin{pmatrix}4 &amp; 5 \\8 &amp; 10 \\12 &amp; 15\end{pmatrix}\]</span></p>
</section>
<section id="practice-problems-2" class="level4" data-number="2.2.2.6">
<h4 data-number="2.2.2.6" class="anchored" data-anchor-id="practice-problems-2"><span class="header-section-number">2.2.2.6</span> Practice Problems</h4>
<p><strong>Find the outer product of A and B where A and B are given as follows:</strong></p>
<p><strong>Problem 1:</strong></p>
<p>Find the outer product of: <span class="math display">\[A=\begin{bmatrix}1\\2\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}3&amp;4\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}1\\2\end{bmatrix} \otimes \begin{bmatrix}3&amp;4\end{bmatrix} \\
&amp;= \begin{bmatrix}
1 \cdot 3 &amp; 1 \cdot 4 \\
2 \cdot 3 &amp; 2 \cdot 4
\end{bmatrix} \\
&amp;= \begin{bmatrix}
3 &amp; 4 \\
6 &amp; 8
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 2:</strong></p>
<p>Find the outer product of: <span class="math display">\[A=\begin{bmatrix}1\\2\\3\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}4&amp;5&amp;6\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}1\\2\\3\end{bmatrix} \otimes \begin{bmatrix}4&amp;5&amp;6\end{bmatrix} \\
&amp;= \begin{bmatrix}
1 \cdot 4 &amp; 1 \cdot 5 &amp; 1 \cdot 6 \\
2 \cdot 4 &amp; 2 \cdot 5 &amp; 2 \cdot 6 \\
3 \cdot 4 &amp; 3 \cdot 5 &amp; 3 \cdot 6
\end{bmatrix} \\
&amp;= \begin{bmatrix}
4 &amp; 5 &amp; 6 \\
8 &amp; 10 &amp; 12 \\
12 &amp; 15 &amp; 18
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 3:</strong></p>
<p>Find the outer product of: <span class="math display">\[A=\begin{bmatrix}1&amp;2\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}3\\4\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}1&amp;2\end{bmatrix} \otimes \begin{bmatrix}3\\4\end{bmatrix} \\
&amp;= \begin{bmatrix}
1 \cdot 3 &amp; 1 \cdot 4 \\
2 \cdot 3 &amp; 2 \cdot 4
\end{bmatrix} \\
&amp;= \begin{bmatrix}
3 &amp; 4 \\
6 &amp; 8
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 4:</strong></p>
<p>Find the outer product of: <span class="math display">\[A=\begin{bmatrix}0\\1\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}1&amp;-1\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}0\\1\end{bmatrix} \otimes \begin{bmatrix}1&amp;-1\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 \cdot 1 &amp; 0 \cdot -1 \\
1 \cdot 1 &amp; 1 \cdot -1
\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 &amp; 0 \\
1 &amp; -1
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 5:</strong></p>
<p>Find the outer product of: <span class="math display">\[A=\begin{bmatrix}2\\3\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}5&amp;-2\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}2\\3\end{bmatrix} \otimes \begin{bmatrix}5&amp;-2\end{bmatrix} \\
&amp;= \begin{bmatrix}
2 \cdot 5 &amp; 2 \cdot -2 \\
3 \cdot 5 &amp; 3 \cdot -2
\end{bmatrix} \\
&amp;= \begin{bmatrix}
10 &amp; -4 \\
15 &amp; -6
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 6:</strong></p>
<p>Find the outer product of: <span class="math display">\[A=\begin{bmatrix}1\\0\\1\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}2&amp;-1&amp;0\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}1\\0\\1\end{bmatrix} \otimes \begin{bmatrix}2&amp;-1&amp;0\end{bmatrix} \\
&amp;= \begin{bmatrix}
1 \cdot 2 &amp; 1 \cdot -1 &amp; 1 \cdot 0 \\
0 \cdot 2 &amp; 0 \cdot -1 &amp; 0 \cdot 0 \\
1 \cdot 2 &amp; 1 \cdot -1 &amp; 1 \cdot 0
\end{bmatrix} \\
&amp;= \begin{bmatrix}
2 &amp; -1 &amp; 0 \\
0 &amp; 0 &amp; 0 \\
2 &amp; -1 &amp; 0
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 7:</strong></p>
<p>Find the outer product of: <span class="math display">\[A=\begin{bmatrix}1\\-1\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}2&amp;0\\3&amp;-1\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;=\begin{bmatrix}1\\-1\end{bmatrix}\otimes \begin{bmatrix}2&amp;0\\3&amp;-1\end{bmatrix}\\
&amp;= \begin{bmatrix}
2 &amp; 3&amp;0&amp;-1 \\
-2&amp;-3&amp;0&amp;1
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 8:</strong></p>
<p>Find the outer product of: <span class="math display">\[A=\begin{bmatrix}3\\4\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}1&amp;-2&amp;3\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}3\\4\end{bmatrix} \otimes \begin{bmatrix}1&amp;-2&amp;3\end{bmatrix} \\
&amp;= \begin{bmatrix}
3 \cdot 1 &amp; 3 \cdot -2 &amp; 3 \cdot 3 \\
4 \cdot 1 &amp; 4 \cdot -2 &amp; 4 \cdot 3
\end{bmatrix} \\
&amp;= \begin{bmatrix}
3 &amp; -6 &amp; 9 \\
4 &amp; -8 &amp; 12
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 9:</strong></p>
<p>Find the outer product of: <span class="math display">\[A=\begin{bmatrix}2\\3\\-1\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}4&amp;-2\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}2\\3\\-1\end{bmatrix} \otimes \begin{bmatrix}4&amp;-2\end{bmatrix} \\
&amp;= \begin{bmatrix}
2 \cdot 4 &amp; 2 \cdot -2 \\
3 \cdot 4 &amp; 3 \cdot -2 \\
-1 \cdot 4 &amp; -1 \cdot -2
\end{bmatrix} \\
&amp;= \begin{bmatrix}
8 &amp; -4 \\
12 &amp; -6 \\
-4 &amp; 2
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 10:</strong></p>
<p>Find the outer product of: <span class="math display">\[A=\begin{bmatrix}0\\5\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}3&amp;1\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}0\\5\end{bmatrix} \otimes \begin{bmatrix}3&amp;1\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 \cdot 3 &amp; 0 \cdot 1 \\
5 \cdot 3 &amp; 5 \cdot 1
\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 &amp; 0 \\
15 &amp; 5
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>1. Compute Outer Product of Vectors from Scratch (without Libraries)</strong></p>
<p>Here’s how you can compute the outer product manually:</p>
<div id="14977925" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define vectors u and v</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute outer product</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> outer_product(u, v):</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the result</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> [[a <span class="op">*</span> b <span class="cf">for</span> b <span class="kw">in</span> v] <span class="cf">for</span> a <span class="kw">in</span> u]</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute outer product</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>outer_product_result <span class="op">=</span> outer_product(u, v)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display result</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Outer Product of Vectors (From Scratch):"</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> outer_product_result:</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Outer Product of Vectors (From Scratch):
[3, 4, 5]
[6, 8, 10]</code></pre>
</div>
</div>
<p><strong>2. Compute Outer Product of Vectors Using SymPy</strong></p>
<p>Here’s how to compute the outer product using <code>SymPy</code>:</p>
<div id="18c52435" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define vectors u and v</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> sp.Matrix([<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> sp.Matrix([<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute outer product using SymPy</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>outer_product_sympy <span class="op">=</span> u <span class="op">*</span> v.T</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display result</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Outer Product of Vectors (Using SymPy):"</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>display(outer_product_sympy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Outer Product of Vectors (Using SymPy):</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}3 &amp; 4 &amp; 5\\6 &amp; 8 &amp; 10\end{matrix}\right]\)</span></p>
</div>
</div>
<p><strong>Outer Product of Matrices</strong></p>
<p>The outer product of two matrices extends the concept from vectors to higher-dimensional tensors. For two matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, the outer product results in a higher-dimensional tensor and is generally expressed as block matrices.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition (Outer Product of Matrices)
</div>
</div>
<div class="callout-body-container callout-body">
<p>For two matrices <span class="math inline">\(A\)</span> of dimension <span class="math inline">\(m \times p\)</span> and <span class="math inline">\(B\)</span> of dimension <span class="math inline">\(q \times n\)</span>, the outer product <span class="math inline">\(A \otimes B\)</span> results in a tensor of dimension <span class="math inline">\(m \times q \times p \times n\)</span>. The entries of the tensor are given by:</p>
<p><span class="math display">\[(A \otimes B)_{ijkl} = A_{ij} \cdot B_{kl}\]</span></p>
<p>where <span class="math inline">\(\cdot\)</span> denotes the outer product operation.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Properties
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Linearity</strong>: <span class="math display">\[(A + C) \otimes B = (A \otimes B) + (C \otimes B)\]</span></p></li>
<li><p><strong>Distributivity</strong>: <span class="math display">\[A \otimes (B + D) = (A \otimes B) + (A \otimes D)\]</span></p></li>
<li><p><strong>Associativity</strong>:</p></li>
</ol>
<p><span class="math display">\[(A \otimes B) \otimes C = A \otimes (B \otimes C)\]</span></p>
</div>
</div>
<p>Here are some simple examples to demonstrate the mathematical procedure to find outer product of matrices.</p>
<p><strong>Example 1: Basic Outer Product of Matrices</strong></p>
<p>Given matrices: <span class="math display">\[A = \begin{pmatrix}1 &amp; 2 \\3 &amp; 4\end{pmatrix}, \quad B = \begin{pmatrix}5 \\6\end{pmatrix}\]</span></p>
<p>The outer product <span class="math inline">\(A \otimes B\)</span> is:</p>
<p><span class="math display">\[A \otimes B = \begin{pmatrix}1 \cdot 5 &amp; 1 \cdot 6 \\2 \cdot 5 &amp; 2 \cdot 6 \\3 \cdot 5 &amp; 3 \cdot 6 \\4 \cdot 5 &amp; 4 \cdot 6\end{pmatrix} = \begin{pmatrix}5 &amp; 6 \\10 &amp; 12 \\15 &amp; 18 \\20 &amp; 24\end{pmatrix}\]</span></p>
<p><strong>Example 2: Outer Product with Larger Matrices</strong></p>
<p>Given matrices:</p>
<p><span class="math display">\[A = \begin{pmatrix}1 &amp; 2 &amp; 3 \\4 &amp; 5 &amp; 6\end{pmatrix}, \quad B = \begin{pmatrix}7 \\8\end{pmatrix}\]</span></p>
<p>The outer product <span class="math inline">\(A \otimes B\)</span> is:</p>
<p><span class="math display">\[A \otimes B = \begin{pmatrix}1 \cdot 7 &amp; 1 \cdot 8 \\2 \cdot 7 &amp; 2 \cdot 8 \\3 \cdot 7 &amp; 3 \cdot 8 \\4 \cdot 7 &amp; 4 \cdot 8 \\5 \cdot 7 &amp; 5 \cdot 8 \\6 \cdot 7 &amp; 6 \cdot 8\end{pmatrix} = \begin{pmatrix}7 &amp; 8 \\14 &amp; 16 \\21 &amp; 24 \\28 &amp; 32 \\35 &amp; 40 \\42 &amp; 48\end{pmatrix}\]</span></p>
<p>Example 3: Compute the outer product of the following vectors <span class="math inline">\(\mathbf{u} = [0, 1, 2]\)</span> and <span class="math inline">\(\mathbf{v} = [2, 3, 4]\)</span>.</p>
<p>To find the outer product, we calculate each element <span class="math inline">\((i, j)\)</span> as the product of the <span class="math inline">\((i)\)</span>-th element of <span class="math inline">\(\mathbf{u}\)</span> and the <span class="math inline">\((j)\)</span>-th element of <span class="math inline">\(\mathbf{v}\)</span>. Mathematically:</p>
<p><span class="math display">\[\mathbf{u} \otimes \mathbf{v} = \begin{bmatrix}0 \cdot 2 &amp; 0 \cdot 3 &amp; 0 \cdot 4 \\1 \cdot 2 &amp; 1 \cdot 3 &amp; 1 \cdot 4 \\2 \cdot 2 &amp; 2 \cdot 3 &amp; 2 \cdot 4\end{bmatrix}= \begin{bmatrix}0 &amp; 0 &amp; 0 \\2 &amp; 3 &amp; 4 \\4 &amp; 6 &amp; 8\end{bmatrix}\]</span></p>
<p><strong>1. Compute Outer Product of Matrices from Scratch (without Libraries)</strong></p>
<p>Here’s how you can compute the outer product manually:</p>
<div id="52c87396" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define matrices A and B</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> [[<span class="dv">5</span>], [<span class="dv">6</span>]]</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute outer product</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> outer_product_matrices(A, B):</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="bu">len</span>(A)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="bu">len</span>(A[<span class="dv">0</span>])</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    q <span class="op">=</span> <span class="bu">len</span>(B)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(B[<span class="dv">0</span>])</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">*</span> p) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(m <span class="op">*</span> q)]</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(m):</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(p):</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(q):</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>                    result[i<span class="op">*</span>q <span class="op">+</span> k][j<span class="op">*</span>n <span class="op">+</span> l] <span class="op">=</span> A[i][j] <span class="op">*</span> B[k][l]</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute outer product</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>outer_product_result_matrices <span class="op">=</span> outer_product_matrices(A, B)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display result</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Outer Product of Matrices (From Scratch):"</span>)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> outer_product_result_matrices:</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Outer Product of Matrices (From Scratch):
[5, 10]
[6, 12]
[15, 20]
[18, 24]</code></pre>
</div>
</div>
<p>Here is the <code>Python</code> code to compute the outer product of these vectors using the <code>NumPy</code> function <code>.outer()</code>:</p>
<div id="a9fa9003" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define vectors</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([[<span class="dv">5</span>],[<span class="dv">4</span>]])</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute outer product</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>outer_product <span class="op">=</span> np.outer(u, v)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Outer Product of u and v:"</span>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>display(outer_product)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Outer Product of u and v:</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>array([[ 5,  4],
       [10,  8],
       [15, 12],
       [20, 16]])</code></pre>
</div>
</div>
<p><strong>Example 3: Real-world Application in Recommendation Systems</strong></p>
<p>In recommendation systems, the outer product can represent user-item interactions. A simple context is here. Let the user preferences of items is given as <span class="math inline">\(u=[4, 3, 5]\)</span> and the item scores is given by <span class="math inline">\(v=[2, 5, 4]\)</span>. Now the recommendation score can be calculated as the outer product of these two vectors. Calculation of this score is shown below. The outer product <span class="math inline">\(\mathbf{u} \otimes \mathbf{v}\)</span> is calculated as follows:</p>
<p><span class="math display">\[\mathbf{u} \otimes \mathbf{v} = \begin{bmatrix}4 \cdot 2 &amp; 4 \cdot 5 &amp; 4 \cdot 4 \\3 \cdot 2 &amp; 3 \cdot 5 &amp; 3 \cdot 4 \\5 \cdot 2 &amp; 5 \cdot 5 &amp; 5 \cdot 4\end{bmatrix}= \begin{bmatrix}8 &amp; 20 &amp; 16 \\6 &amp; 15 &amp; 12 \\10 &amp; 25 &amp; 20\end{bmatrix}\]</span></p>
<p>The python code for this task is given below.</p>
<div id="531c6d5d" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the user and product ratings vectors</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>user_ratings <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>])</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>product_ratings <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>])</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the outer product</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>predicted_ratings <span class="op">=</span> np.outer(user_ratings, product_ratings)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the predicted ratings matrix</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Predicted Ratings Matrix:"</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>display(predicted_ratings)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the result</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>plt.imshow(predicted_ratings, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, interpolation<span class="op">=</span><span class="st">'nearest'</span>)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Predicted Ratings Matrix (Recommendation System)'</span>)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Product Ratings'</span>)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'User Ratings'</span>)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>np.arange(<span class="bu">len</span>(product_ratings)), labels<span class="op">=</span>product_ratings)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>plt.yticks(ticks<span class="op">=</span>np.arange(<span class="bu">len</span>(user_ratings)), labels<span class="op">=</span>user_ratings)</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Predicted Ratings Matrix:</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>array([[ 8, 20, 16],
       [ 6, 15, 12],
       [10, 25, 20]])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="module_2_files/figure-html/cell-29-output-3.png" width="509" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Additional Properties &amp; Definitions
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Definition and Properties</strong></p>
<p>Given two vectors:</p>
<ul>
<li><span class="math inline">\(\mathbf{u} \in \mathbb{R}^m\)</span></li>
<li><span class="math inline">\(\mathbf{v} \in \mathbb{R}^n\)</span></li>
</ul>
<p>The outer product <span class="math inline">\(\mathbf{u} \otimes \mathbf{v}\)</span> results in an <span class="math inline">\(m \times n\)</span> matrix where each element <span class="math inline">\((i, j)\)</span> of the matrix is calculated as: <span class="math display">\[(\mathbf{u} \otimes \mathbf{v})_{ij} = u_i \cdot v_j\]</span></p></li>
<li><p><strong>Non-Symmetry</strong></p>
<p>The outer product is generally not symmetric. For vectors <span class="math inline">\(\mathbf{u}\)</span> and <span class="math inline">\(\mathbf{v}\)</span>, the matrix <span class="math inline">\(\mathbf{u} \otimes \mathbf{v}\)</span> is not necessarily equal to <span class="math inline">\(\mathbf{v} \otimes \mathbf{u}\)</span>: <span class="math display">\[\mathbf{u} \otimes \mathbf{v} \neq \mathbf{v} \otimes \mathbf{u}\]</span></p></li>
<li><p><strong>Rank of the Outer Product</strong></p>
<p>The rank of the outer product matrix <span class="math inline">\(\mathbf{u} \otimes \mathbf{v}\)</span> is always 1, provided neither <span class="math inline">\(\mathbf{u}\)</span> nor <span class="math inline">\(\mathbf{v}\)</span> is a zero vector. This is because the matrix can be expressed as a single rank-1 matrix.</p></li>
<li><p><strong>Distributive Property</strong></p>
<p>The outer product is distributive over vector addition. For vectors <span class="math inline">\(\mathbf{u}_1, \mathbf{u}_2 \in \mathbb{R}^m\)</span> and <span class="math inline">\(\mathbf{v} \in \mathbb{R}^n\)</span>: <span class="math display">\[(\mathbf{u}_1 + \mathbf{u}_2) \otimes \mathbf{v} = (\mathbf{u}_1 \otimes \mathbf{v}) + (\mathbf{u}_2 \otimes \mathbf{v})\]</span></p></li>
<li><p><strong>Associativity with Scalar Multiplication</strong></p>
<p>The outer product is associative with scalar multiplication. For a scalar <span class="math inline">\(\alpha\)</span> and vectors <span class="math inline">\(\mathbf{u} \in \mathbb{R}^m\)</span> and <span class="math inline">\(\mathbf{v} \in \mathbb{R}^n\)</span>: <span class="math display">\[\alpha (\mathbf{u} \otimes \mathbf{v}) = (\alpha \mathbf{u}) \otimes \mathbf{v} = \mathbf{u} \otimes (\alpha \mathbf{v})\]</span></p></li>
<li><p><strong>Matrix Trace</strong></p>
<p>The trace of the outer product of two vectors is given by: <span class="math display">\[\text{tr}(\mathbf{u} \otimes \mathbf{v}) = (\mathbf{u}^T \mathbf{v})= (\mathbf{v}^T \mathbf{u})\]</span> Here, <span class="math inline">\(\text{tr}\)</span> denotes the trace of a matrix, which is the sum of its diagonal elements.</p></li>
<li><p><strong>Matrix Norm</strong></p>
<p>The Frobenius norm of the outer product matrix can be expressed in terms of the norms of the original vectors: <span class="math display">\[\| \mathbf{u} \otimes \mathbf{v} \|_F = \| \mathbf{u} \|_2 \cdot \| \mathbf{v} \|_2\]</span> where <span class="math inline">\(\| \cdot \|_2\)</span> denotes the Euclidean norm.</p></li>
</ol>
</div>
</div>
<p><strong>Example Calculation in <code>Python</code></strong></p>
<p>Here’s how to compute and visualize the outer product properties using <code>Python</code>:</p>
<div id="cell-fig-op" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define vectors</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute outer product</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>outer_product <span class="op">=</span> np.outer(u, v)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Outer Product Matrix:"</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(outer_product)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and display rank</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>rank <span class="op">=</span> np.linalg.matrix_rank(outer_product)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Rank of Outer Product Matrix: </span><span class="sc">{</span>rank<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Frobenius norm</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>frobenius_norm <span class="op">=</span> np.linalg.norm(outer_product, <span class="st">'fro'</span>)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Frobenius Norm: </span><span class="sc">{</span>frobenius_norm<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the result</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>plt.imshow(outer_product, cmap<span class="op">=</span><span class="st">'viridis'</span>, interpolation<span class="op">=</span><span class="st">'nearest'</span>)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Outer Product Matrix'</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Vector v'</span>)</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Vector u'</span>)</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>np.arange(<span class="bu">len</span>(v)), labels<span class="op">=</span>v)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>plt.yticks(ticks<span class="op">=</span>np.arange(<span class="bu">len</span>(u)), labels<span class="op">=</span>u)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Outer Product Matrix:
[[ 4  5]
 [ 8 10]
 [12 15]]
Rank of Outer Product Matrix: 1
Frobenius Norm: 23.958297101421877</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-op" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-op-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="module_2_files/figure-html/fig-op-output-2.png" width="373" height="449" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-op-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.10: Demonstration of Outer Product and its Properties
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="kronecker-product" class="level4" data-number="2.2.2.7">
<h4 data-number="2.2.2.7" class="anchored" data-anchor-id="kronecker-product"><span class="header-section-number">2.2.2.7</span> Kronecker Product</h4>
<p>In mathematics, the Kronecker product, sometimes denoted by <span class="math inline">\(\otimes\)</span>, is an operation on two matrices of arbitrary size resulting in a <em>block matrix</em>. It is a specialization of the tensor product (which is denoted by the same symbol) from vectors to matrices and gives the matrix of the tensor product linear map with respect to a standard choice of basis. The Kronecker product is to be distinguished from the usual matrix multiplication, which is an entirely different operation. The Kronecker product is also sometimes called <em>matrix direct product</em>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(A\)</span> is an <span class="math inline">\(m \times n\)</span> matrix and <span class="math inline">\(B\)</span> is a <span class="math inline">\(p \times q\)</span> matrix, then the Kronecker product <span class="math inline">\(A\otimes B\)</span> is the <span class="math inline">\(pm \times qn\)</span> block matrix defined as: Each <span class="math inline">\(a_{ij}\)</span> of <span class="math inline">\(A\)</span> is replaced by the matrix <span class="math inline">\(a_{ij}B\)</span>. Symbolically this will result in a block matrix defined by:</p>
<p><span class="math display">\[A\otimes B=A \otimes B = \begin{bmatrix}a_{11}B &amp; a_{12}B &amp; \cdots &amp; a_{1n}B \\a_{21}B &amp; a_{22}B &amp; \cdots &amp; a_{2n}B \\\vdots &amp; \vdots &amp; \ddots &amp; vdots \\a_{m1}B &amp; a_{m2}B &amp; \cdots &amp; a_{mn}B\end{bmatrix}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Properties of the Kronecker Product
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Associativity</strong></p>
<p>The Kronecker product is associative. For matrices <span class="math inline">\(A \in \mathbb{R}^{m \times n}\)</span>, <span class="math inline">\(B \in \mathbb{R}^{p \times q}\)</span>, and <span class="math inline">\(C \in \mathbb{R}^{r \times s}\)</span>: <span class="math display">\[(A \otimes B) \otimes C = A \otimes (B \otimes C)\]</span></p></li>
<li><p><strong>Distributivity Over Addition</strong></p>
<p>The Kronecker product distributes over matrix addition. For matrices <span class="math inline">\(A \in \mathbb{R}^{m \times n}\)</span>, <span class="math inline">\(B \in \mathbb{R}^{p \times q}\)</span>, and <span class="math inline">\(C \in \mathbb{R}^{p \times q}\)</span>: <span class="math display">\[A \otimes (B + C) = (A \otimes B) + (A \otimes C)\]</span></p></li>
<li><p><strong>Mixed Product Property</strong></p>
<p>The Kronecker product satisfies the mixed product property with the matrix product. For matrices <span class="math inline">\(A \in \mathbb{R}^{m \times n}\)</span>, <span class="math inline">\(B \in \mathbb{R}^{p \times q}\)</span>, <span class="math inline">\(C \in \mathbb{R}^{r \times s}\)</span>, and <span class="math inline">\(D \in \mathbb{R}^{r \times s}\)</span>: <span class="math display">\[(A \otimes B) (C \otimes D) = (A C) \otimes (B D)\]</span></p></li>
<li><p><strong>Transpose</strong></p>
<p>The transpose of the Kronecker product is given by: <span class="math display">\[(A \otimes B)^T = A^T \otimes B^T\]</span></p></li>
<li><p><strong>Norm</strong></p>
<p>The Frobenius norm of the Kronecker product can be computed as: <span class="math display">\[\| A \otimes B \|_F = \| A \|_F \cdot \| B \|_F\]</span> where <span class="math inline">\(\| \cdot \|_F\)</span> denotes the Frobenius norm.</p></li>
</ol>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Frobenius Norm
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Frobenius norm, also known as the Euclidean norm for matrices, is a measure of a matrix’s magnitude. It is defined as the square root of the sum of the absolute squares of its elements. Mathematically, for a matrix <span class="math inline">\(A\)</span> with elements <span class="math inline">\(a_{ij}\)</span>, the Frobenius norm is given by:</p>
<p><span class="math display">\[\|A\|_F = \sqrt{\sum_{i,j} |a_{ij}|^2}\]</span></p>
</div>
</div>
<p>Example 1: Calculation of Frobenius Norm</p>
<p>Consider the matrix <span class="math inline">\(A\)</span>:</p>
<p><span class="math display">\[A = \begin{bmatrix}1 &amp; 2 \\3 &amp; 4\end{bmatrix}\]</span></p>
<p>To compute the Frobenius norm:</p>
<p><span class="math display">\[\|A\|_F = \sqrt{1^2 + 2^2 + 3^2 + 4^2}= \sqrt{1 + 4 + 9 + 16}= \sqrt{30}\approx 5.48\]</span></p>
<p>Example 2: Frobenius Norm of a Sparse Matrix</p>
<p>Consider the sparse matrix <span class="math inline">\(B\)</span>:</p>
<p><span class="math display">\[B = \begin{bmatrix}0 &amp; 0 &amp; 0 \\0 &amp; 5 &amp; 0 \\0 &amp; 0 &amp; 0\end{bmatrix}\]</span></p>
<p>To compute the Frobenius norm:</p>
<p><span class="math display">\[\|B\|_F = \sqrt{0^2 + 0^2 + 0^2 + 5^2 + 0^2 + 0^2}= \sqrt{25}= 5\]</span></p>
<p>Example 3: Frobenius Norm in a Large Matrix</p>
<p>Consider the matrix <span class="math inline">\(C\)</span> of size $3 $:</p>
<p><span class="math display">\[C = \begin{bmatrix}1 &amp; 2 &amp; 3 \\4 &amp; 5 &amp; 6 \\7 &amp; 8 &amp; 9\end{bmatrix}\]</span></p>
<p>To compute the Frobenius norm:</p>
<p><span class="math display">\[\begin{align*}
\|C\|_F &amp;= \sqrt{1^2 + 2^2 + 3^2 + 4^2 + 5^2 + 6^2 + 7^2 + 8^2 + 9^2}\\
&amp;= \sqrt{1 + 4 + 9 + 16 + 25 + 36 + 49 + 64 + 81}\\
&amp;= \sqrt{285}\\
&amp;\approx 16.88
\end{align*}\]</span></p>
<p><strong>Applications of the Frobenius Norm</strong></p>
<ul>
<li><p><em>Application 1: Image Compression:</em> In image processing, the Frobenius norm can measure the difference between the original and compressed images, indicating how well the compression has preserved the original image quality.</p></li>
<li><p><em>Application 2: Matrix Factorization:</em> In numerical analysis, Frobenius norm is used to evaluate the error in matrix approximations, such as in Singular Value Decomposition (SVD). A lower Frobenius norm of the error indicates a better approximation.</p></li>
<li><p><em>Application 3: Error Measurement in Numerical Solutions:</em> In solving systems of linear equations, the Frobenius norm can be used to measure the error between the true solution and the computed solution, providing insight into the accuracy of numerical methods.</p></li>
</ul>
<p>The <code>linalg</code> sub module of <code>NumPy</code> library can be used to calculate various norms. Basically norm is the generalized form of Euclidean distance.</p>
<div id="6b2602f8" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1: Simple Matrix</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>frobenius_norm_A <span class="op">=</span> np.linalg.norm(A, <span class="st">'fro'</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Frobenius Norm of A: </span><span class="sc">{</span>frobenius_norm_A<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 2: Sparse Matrix</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]])</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>frobenius_norm_B <span class="op">=</span> np.linalg.norm(B, <span class="st">'fro'</span>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Frobenius Norm of B: </span><span class="sc">{</span>frobenius_norm_B<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 3: Large Matrix</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>frobenius_norm_C <span class="op">=</span> np.linalg.norm(C, <span class="st">'fro'</span>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Frobenius Norm of C: </span><span class="sc">{</span>frobenius_norm_C<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Frobenius Norm of A: 5.48
Frobenius Norm of B: 5.00
Frobenius Norm of C: 16.88</code></pre>
</div>
</div>
<p><strong>Frobenius norm of Kronecker product</strong></p>
<p>Let us consider two matrices,</p>
<p><span class="math display">\[A = \begin{bmatrix}1 &amp; 2 \\3 &amp; 4\end{bmatrix}\]</span></p>
<p>and</p>
<p><span class="math display">\[B = \begin{bmatrix}0 &amp; 5 \\6 &amp; 7\end{bmatrix}\]</span></p>
<p>The Kronecker product <span class="math inline">\(C = A \otimes B\)</span> is:</p>
<p><span class="math display">\[C = \begin{bmatrix}1 \cdot B &amp; 2 \cdot B \\3 \cdot B &amp; 4 \cdot B\end{bmatrix}= \begin{bmatrix}\begin{bmatrix}0 &amp; 5 \\6 &amp; 7\end{bmatrix} &amp; \begin{bmatrix}0 \cdot 2 &amp; 5 \cdot 2 \\6 \cdot 2 &amp; 7 \cdot 2\end{bmatrix} \\\begin{bmatrix}0 \cdot 3 &amp; 5 \cdot 3 \\6 \cdot 3 &amp; 7 \cdot 3\end{bmatrix} &amp; \begin{bmatrix}0 \cdot 4 &amp; 5 \cdot 4 \\6 \cdot 4 &amp; 7 \cdot 4\end{bmatrix}\end{bmatrix}\]</span></p>
<p>This expands to:</p>
<p><span class="math display">\[C = \begin{bmatrix}0 &amp; 5 &amp; 0 &amp; 10 \\6 &amp; 7 &amp; 12 &amp; 14 \\0 &amp; 15 &amp; 0 &amp; 20 \\18 &amp; 21 &amp; 24 &amp; 28\end{bmatrix}\]</span></p>
<p><em>Computing the Frobenius Norm</em></p>
<p>To compute the Frobenius norm of <span class="math inline">\(C\)</span>:</p>
<p><span class="math display">\[\|C\|_F = \sqrt{\sum_{i=1}^{4} \sum_{j=1}^{4} |c_{ij}|^2}\]</span></p>
<p><span class="math display">\[\|C\|_F = \sqrt{0^2 + 5^2 + 0^2 + 10^2 + 6^2 + 7^2 + 12^2 + 14^2 + 0^2 + 15^2 + 0^2 + 20^2 + 18^2 + 21^2 + 24^2 + 28^2}\]</span></p>
<p><span class="math display">\[\|C\|_F = \sqrt{0 + 25 + 0 + 100 + 36 + 49 + 144 + 196 + 0 + 225 + 0 + 400 + 324 + 441 + 576 + 784}\]</span></p>
<p><span class="math display">\[\|C\|_F = \sqrt{2896}\]</span> <span class="math display">\[\|C\|_F \approx 53.87\]</span></p>
<hr>
</section>
<section id="practice-problems-3" class="level4" data-number="2.2.2.8">
<h4 data-number="2.2.2.8" class="anchored" data-anchor-id="practice-problems-3"><span class="header-section-number">2.2.2.8</span> Practice Problems</h4>
<p><strong>Find the Kronecker product of A and B where A and B are given as follows:</strong></p>
<p><strong>Problem 1:</strong></p>
<p>Find the Kronecker product of: <span class="math display">\[A=\begin{bmatrix}1&amp;2\\3&amp;4\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}1&amp;2\\3&amp;4\end{bmatrix} \otimes \begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix} \\
&amp;= \begin{bmatrix}
1 \cdot \begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix} &amp; 2 \cdot \begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix} \\
3 \cdot \begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix} &amp; 4 \cdot \begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix}
\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 &amp; 1 &amp; 0 &amp; 2 \\
1 &amp; 0 &amp; 2&amp; 0\\
0 &amp; 3 &amp; 0 &amp; 4 \\
3 &amp; 0 &amp; 4 &amp; 0
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 2:</strong></p>
<p>Find the Kronecker product of: <span class="math display">\[A=\begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}2&amp;3\\4&amp;5\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix} \otimes \begin{bmatrix}2&amp;3\\4&amp;5\end{bmatrix} \\
&amp;= \begin{bmatrix}
1 \cdot \begin{bmatrix}2&amp;3\\4&amp;5\end{bmatrix} &amp; 0 \cdot \begin{bmatrix}2&amp;3\\4&amp;5\end{bmatrix} \\
0 \cdot \begin{bmatrix}2&amp;3\\4&amp;5\end{bmatrix} &amp; 1 \cdot \begin{bmatrix}2&amp;3\\4&amp;5\end{bmatrix}
\end{bmatrix} \\
&amp;= \begin{bmatrix}
2 &amp; 3 &amp; 0 &amp; 0 \\
4 &amp; 5 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 2 &amp; 3 \\
0 &amp; 0 &amp; 4 &amp; 5
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 3:</strong></p>
<p>Find the Kronecker product of: <span class="math display">\[A=\begin{bmatrix}1&amp;2\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}3\\4\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}1&amp;2\end{bmatrix} \otimes \begin{bmatrix}3\\4\end{bmatrix} \\
&amp;= \begin{bmatrix}
1 \cdot \begin{bmatrix}3\\4\end{bmatrix} &amp; 2 \cdot \begin{bmatrix}3\\4\end{bmatrix}
\end{bmatrix} \\
&amp;= \begin{bmatrix}
3 &amp; 6 \\
4 &amp; 8
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 4:</strong></p>
<p>Find the Kronecker product of: <span class="math display">\[A=\begin{bmatrix}0&amp;1\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}1&amp;-1\\2&amp;0\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}0&amp;1\end{bmatrix} \otimes \begin{bmatrix}1&amp;-1\\2&amp;0\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 \cdot \begin{bmatrix}1&amp;-1\\2&amp;0\end{bmatrix} &amp; 1 \cdot \begin{bmatrix}1&amp;-1\\2&amp;0\end{bmatrix}
\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 &amp; 0 &amp;1&amp;-1\\
0 &amp; 0&amp;2&amp;0 \\
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 5:</strong></p>
<p>Find the Kronecker product of: <span class="math display">\[A=\begin{bmatrix}2\\3\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}4&amp;-2\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}2\\3\end{bmatrix} \otimes \begin{bmatrix}4&amp;-2\end{bmatrix} \\
&amp;= \begin{bmatrix}
2 \cdot \begin{bmatrix}4&amp;-2\end{bmatrix} \\
3 \cdot \begin{bmatrix}4&amp;-2\end{bmatrix}
\end{bmatrix} \\
&amp;= \begin{bmatrix}
8 &amp; -4 \\
12 &amp; -6
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 6:</strong></p>
<p>Find the Kronecker product of: <span class="math display">\[A=\begin{bmatrix}1&amp;-1\\0&amp;2\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}1&amp;-1\\0&amp;2\end{bmatrix} \otimes \begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix} \\
&amp;= \begin{bmatrix}
1 \cdot \begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix} &amp; -1 \cdot \begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix} \\
0 \cdot \begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix} &amp; 2 \cdot \begin{bmatrix}0&amp;1\\1&amp;0\end{bmatrix}
\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 &amp; 1 &amp; 0 &amp; -1 \\
1 &amp; 0 &amp; -1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 2 \\
0 &amp; 0 &amp; 2 &amp; 0
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 7:</strong></p>
<p>Find the Kronecker product of: <span class="math display">\[A=\begin{bmatrix}2\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}3&amp;4\\5&amp;6\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}2\end{bmatrix} \otimes \begin{bmatrix}3&amp;4\\5&amp;6\end{bmatrix} \\
&amp;= 2 \cdot \begin{bmatrix}3&amp;4\\5&amp;6\end{bmatrix} \\
&amp;= \begin{bmatrix}
6 &amp; 8 \\
10 &amp; 12
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 8:</strong></p>
<p>Find the Kronecker product of: <span class="math display">\[A=\begin{bmatrix}0&amp;1\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}0&amp;1\end{bmatrix} \otimes \begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 \cdot \begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix} &amp; 1 \cdot \begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix}
\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 &amp; 0 \\
0 &amp; 1
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 9:</strong></p>
<p>Find the Kronecker product of: <span class="math display">\[A=\begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}1&amp;1\\1&amp;1\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}1&amp;0\\0&amp;1\end{bmatrix} \otimes \begin{bmatrix}1&amp;1\\1&amp;1\end{bmatrix} \\
&amp;= \begin{bmatrix}
1 \cdot \begin{bmatrix}1&amp;1\\1&amp;1\end{bmatrix} &amp; 0 \cdot \begin{bmatrix}1&amp;1\\1&amp;1\end{bmatrix} \\
0 \cdot \begin{bmatrix}1&amp;1\\1&amp;1\end{bmatrix} &amp; 1 \cdot \begin{bmatrix}1&amp;1\\1&amp;1\end{bmatrix}
\end{bmatrix} \\
&amp;= \begin{bmatrix}
1 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; 1 &amp; 1
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
<p><strong>Problem 10:</strong></p>
<p>Find the Kronecker product of: <span class="math display">\[A=\begin{bmatrix}2&amp;-1\\3&amp;4\end{bmatrix}\]</span> <span class="math display">\[B=\begin{bmatrix}0&amp;5\\-2&amp;3\end{bmatrix}\]</span></p>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\begin{align*}
A \otimes B &amp;= \begin{bmatrix}2&amp;-1\\3&amp;4\end{bmatrix} \otimes \begin{bmatrix}0&amp;5\\-2&amp;3\end{bmatrix} \\
&amp;= \begin{bmatrix}
2 \cdot \begin{bmatrix}0&amp;5\\-2&amp;3\end{bmatrix} &amp; -1 \cdot \begin{bmatrix}0&amp;5\\-2&amp;3\end{bmatrix} \\
3 \cdot \begin{bmatrix}0&amp;5\\-2&amp;3\end{bmatrix} &amp; 4 \cdot \begin{bmatrix}0&amp;5\\-2&amp;3\end{bmatrix}
\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 &amp; 10 &amp; 0 &amp; -5 \\
-4 &amp; 6 &amp; 2 &amp; -3 \\
0 &amp; 15 &amp; 0 &amp; 20 \\
-6 &amp; 9 &amp; -8 &amp; 12
\end{bmatrix}
\end{align*}\]</span></p>
<hr>
</section>
<section id="connection-between-outer-product-and-kronecker-product" class="level4" data-number="2.2.2.9">
<h4 data-number="2.2.2.9" class="anchored" data-anchor-id="connection-between-outer-product-and-kronecker-product"><span class="header-section-number">2.2.2.9</span> Connection Between Outer Product and Kronecker Product</h4>
<ol type="1">
<li><p><strong>Conceptual Connection:</strong></p>
<ul>
<li><p>The <strong>outer product</strong> is a special case of the <strong>Kronecker product</strong>. Specifically, if <span class="math inline">\(\mathbf{A}\)</span> is a column vector and <span class="math inline">\(\mathbf{B}\)</span> is a row vector, then <span class="math inline">\(\mathbf{A}\)</span> is a <span class="math inline">\(m \times 1\)</span> matrix and <span class="math inline">\(\mathbf{B}\)</span> is a <span class="math inline">\(1 \times n\)</span> matrix. The Kronecker product of these two matrices will yield the same result as the outer product of these vectors.</p></li>
<li><p>For matrices <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span>, the Kronecker product involves taking the outer product of each element of <span class="math inline">\(\mathbf{A}\)</span> with the entire matrix <span class="math inline">\(\mathbf{B}\)</span>.</p></li>
</ul></li>
<li><p><strong>Mathematical Formulation:</strong></p>
<ul>
<li>Let <span class="math inline">\(\mathbf{A} = \begin{bmatrix}a_{11} &amp; a_{12}\\ a_{21} &amp; a_{22}\end{bmatrix}\)</span> and <span class="math inline">\(\mathbf{B} = \begin{bmatrix}b_{11} &amp; b_{12}\\ b_{21} &amp; b_{22}\end{bmatrix}\)</span>. Then:</li>
</ul>
<p><span class="math display">\[\mathbf{A} \otimes \mathbf{B} = \begin{bmatrix} a_{11} \mathbf{B} &amp; a_{12} \mathbf{B} \\ a_{21} \mathbf{B} &amp; a_{22} \mathbf{B} \end{bmatrix}\]</span></p>
<ul>
<li>If <span class="math inline">\(\mathbf{A} = \mathbf{u} \mathbf{v}^T\)</span> where <span class="math inline">\(\mathbf{u}\)</span> is a column vector and <span class="math inline">\(\mathbf{v}^T\)</span> is a row vector, then the Kronecker product of <span class="math inline">\(\mathbf{u}\)</span> and <span class="math inline">\(\mathbf{v}^T\)</span> yields the same result as the outer product <span class="math inline">\(\mathbf{u} \otimes \mathbf{v}\)</span>.</li>
</ul></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Summary</strong></p>
<ul>
<li>The <strong>outer product</strong> is a specific case of the <strong>Kronecker product</strong> where one of the matrices is a vector (either row or column).</li>
<li>The <strong>Kronecker product</strong> generalizes the outer product to matrices and is more versatile in applications involving tensor products and higher-dimensional constructs.</li>
</ul>
</div>
</div>
</section>
<section id="matrix-multiplication-as-kronecker-product" class="level4" data-number="2.2.2.10">
<h4 data-number="2.2.2.10" class="anchored" data-anchor-id="matrix-multiplication-as-kronecker-product"><span class="header-section-number">2.2.2.10</span> Matrix Multiplication as Kronecker Product</h4>
<p>Given matrices <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span>, where: - <span class="math inline">\(\mathbf{A}\)</span> is an <span class="math inline">\(m \times n\)</span> matrix - <span class="math inline">\(\mathbf{B}\)</span> is an <span class="math inline">\(n \times p\)</span> matrix</p>
<p>The product <span class="math inline">\(\mathbf{C} = \mathbf{A} \mathbf{B}\)</span> can be expressed using Kronecker products as:</p>
<p><span class="math display">\[\mathbf{C} = \sum_{k=1}^n (\mathbf{A}_{:,k} \otimes \mathbf{B}_{k,:})\]</span></p>
<p>where: - <span class="math inline">\(\mathbf{A}_{:,k}\)</span> denotes the <span class="math inline">\(k\)</span>-th column of matrix <span class="math inline">\(\mathbf{A}\)</span> - <span class="math inline">\(\mathbf{B}_{k,:}\)</span> denotes the <span class="math inline">\(k\)</span>-th row of matrix <span class="math inline">\(\mathbf{B}\)</span></p>
<p><strong>Example:</strong></p>
<p>Let:</p>
<p><span class="math display">\[\mathbf{A} = \begin{bmatrix}1 &amp; 2 \\3 &amp; 4\end{bmatrix}\]</span></p>
<p>and:</p>
<p><span class="math display">\[\mathbf{B} = \begin{bmatrix}0 &amp; 1 \\1 &amp; 0\end{bmatrix}\]</span></p>
<p>To find <span class="math inline">\(\mathbf{C} = \mathbf{A} \mathbf{B}\)</span> using Kronecker products:</p>
<ol type="1">
<li><p><strong>Compute the Kronecker Product of Columns of <span class="math inline">\(\mathbf{A}\)</span> and Rows of <span class="math inline">\(\mathbf{B}\)</span>:</strong></p>
<ul>
<li><p>For column <span class="math inline">\(\mathbf{A}_{:,1} = \begin{bmatrix} 1 \\ 3 \end{bmatrix}\)</span> and row <span class="math inline">\(\mathbf{B}_{1,:} = \begin{bmatrix} 0 &amp; 1 \end{bmatrix}\)</span>: <span class="math display">\[\mathbf{A}_{:,1} \otimes \mathbf{B}_{1,:} = \begin{bmatrix}     0 &amp; 1 \\     0 &amp; 3     \end{bmatrix}\]</span></p></li>
<li><p>For column <span class="math inline">\(\mathbf{A}_{:,2} = \begin{bmatrix} 2 \\ 4 \end{bmatrix}\)</span> and row <span class="math inline">\(\mathbf{B}_{2,:} = \begin{bmatrix} 1 &amp; 0 \end{bmatrix}\)</span>: <span class="math display">\[\mathbf{A}_{:,2} \otimes \mathbf{B}_{2,:} = \begin{bmatrix}2 &amp; 0 \\ 4 &amp; 0\end{bmatrix}\]</span></p></li>
</ul></li>
<li><p><strong>Sum the Kronecker Products:</strong></p>
<p><span class="math display">\[\mathbf{C} = \begin{bmatrix}0 &amp; 1 \\ 0 &amp; 3\end{bmatrix} +\begin{bmatrix} 2 &amp; 0 \\ 4 &amp; 0 \end{bmatrix}  = \begin{bmatrix} 2 &amp; 1 \\ 4 &amp; 3\end{bmatrix}\]</span></p></li>
</ol>
<hr>
<p>In the previous block we have discussed the Frobenius norm and its applications. Now came back to the discussions on the Kronecker product. The Kronecker product is particularly useful in scenarios where interactions between different types of data need to be modeled comprehensively. In recommendation systems, it allows us to integrate user preferences with item relationships to improve recommendation accuracy.</p>
<p>In addition to recommendation systems, Kronecker products are used in various fields such as:</p>
<ul>
<li>Signal Processing: For modeling multi-dimensional signals.</li>
<li>Machine Learning: In building features for complex models.</li>
<li>Communication Systems: For modeling network interactions.</li>
</ul>
<p>By understanding the Kronecker product and its applications, we can extend it to solve complex problems and enhance systems across different domains. To understand the practical use of Kronecker product in a Machine Learning scenario let us consider the following problem statement and its solution.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problem statement
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the realm of recommendation systems, predicting user preferences for various product categories based on past interactions is a common challenge. Suppose we have data on user preferences for different products and categories. We can use this data to recommend the best products for each user by employing mathematical tools such as the Kronecker product. The User Preference and Category relationships are given in <a href="#tbl-UPM" class="quarto-xref">Table&nbsp;<span>2.4</span></a> and <a href="#tbl-CRM" class="quarto-xref">Table&nbsp;<span>2.5</span></a> .</p>
<div id="tbl-UPM" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-UPM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.4: User Preference
</figcaption>
<div aria-describedby="tbl-UPM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>User/Item</th>
<th>Electronics</th>
<th>Clothing</th>
<th>Books</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>User 1</td>
<td>5</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td>User 2</td>
<td>2</td>
<td>4</td>
<td>5</td>
</tr>
<tr class="odd">
<td>User 3</td>
<td>3</td>
<td>4</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="tbl-CRM" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-CRM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.5: Category Relationships
</figcaption>
<div aria-describedby="tbl-CRM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Category/Feature</th>
<th>Feature 1</th>
<th>Feature 2</th>
<th>Feature 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Electronics</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>Clothing</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Books</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Predict user preferences for different product categories using the Kronecker product matrix.</p>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Solution Procedure</strong></p>
</blockquote>
<ol type="1">
<li><p><em>Compute the Kronecker Product:</em> Calculate the Kronecker product of matrices <span class="math inline">\(U\)</span> and <span class="math inline">\(C\)</span> to obtain matrix <span class="math inline">\(K\)</span>.</p>
<p>To model the problem, we use the Kronecker product of the user preference matrix <span class="math inline">\(U\)</span> and the category relationships matrix <span class="math inline">\(C\)</span>. This product allows us to predict the user’s rating for each category by combining their preferences with the category features.</p></li>
</ol>
<p><em>Formulating Matrices</em></p>
<p>User Preference Matrix (U): - Dimension: <span class="math inline">\(3\times 3\)</span> (3 users, 3 items) - from the User preference data, we can create the User Preference Matrix as follows:</p>
<p><span class="math display">\[U = \begin{pmatrix}5 &amp; 3 &amp; 4 \\2 &amp; 4 &amp; 5 \\3 &amp; 4 &amp; 4 \end{pmatrix}\]</span></p>
<p>Category Relationships Matrix (C): - Dimension: <span class="math inline">\(3 \times 3\)</span> (3 categories) - from the Category Relationships data, we can create the Category Relationship Matrix as follows:</p>
<p><span class="math display">\[C = \begin{pmatrix}1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 1 \\ 0 &amp; 1 &amp; 1\end{pmatrix}\]</span></p>
<p><em>Kronecker Product Calculation</em></p>
<p>The Kronecker product <span class="math inline">\(K\)</span> of <span class="math inline">\(U\)</span> and <span class="math inline">\(C\)</span> is calculated as follows:</p>
<ol type="1">
<li><strong>Matrix Dimensions:</strong></li>
</ol>
<ul>
<li><span class="math inline">\(U\)</span> is <span class="math inline">\(3 \times 3\)</span> (3 users, 3 items).</li>
<li><span class="math inline">\(C\)</span> is <span class="math inline">\(3 \times 3\)</span> (3 categories, 3 features).</li>
</ul>
<ol start="2" type="1">
<li><strong>Calculate Kronecker Product:</strong></li>
</ol>
<ul>
<li>For each element <span class="math inline">\(u_{ij}\)</span> in <span class="math inline">\(U\)</span>, multiply by the entire matrix <span class="math inline">\(C\)</span>.</li>
</ul>
<p>The Kronecker product <span class="math inline">\(K\)</span> is computed as:</p>
<p><span class="math display">\[K = U \otimes C\]</span></p>
<p>Explicitly, the Kronecker product <span class="math inline">\(K\)</span> is:</p>
<p><span class="math display">\[K = \begin{pmatrix}5 \cdot C &amp; 3 \cdot C &amp; 4 \cdot C \\ 2 \cdot C &amp; 4 \cdot C &amp; 5 \cdot C \\    3 \cdot C &amp; 4 \cdot C &amp; 4 \cdot C\end{pmatrix}\]</span></p>
<p>As an example the blocks in first row are:</p>
<p><span class="math display">\[5 \cdot C = \begin{pmatrix}   5 &amp; 0 &amp; 0 \\   0 &amp; 5 &amp; 5 \\   0 &amp; 5 &amp; 5   \end{pmatrix}, \quad    3 \cdot C = \begin{pmatrix}   3 &amp; 0 &amp; 0 \\   0 &amp; 3 &amp; 3 \\   0 &amp; 3 &amp; 3   \end{pmatrix}, \quad   4 \cdot C = \begin{pmatrix}   4 &amp; 0 &amp; 0 \\   0 &amp; 4 &amp; 4 \\   0 &amp; 4 &amp; 4   \end{pmatrix}\]</span></p>
<p>Combining these blocks:</p>
<p><span class="math display">\[K = \begin{pmatrix}   5 &amp; 0 &amp; 0 &amp; 3 &amp; 0 &amp; 0 &amp; 4 &amp; 0 &amp; 0\\   0 &amp; 5 &amp; 5 &amp; 0 &amp; 3 &amp; 3 &amp; 0 &amp; 4 &amp; 4\\   0 &amp; 5 &amp; 5 &amp; 0 &amp; 3 &amp; 3 &amp; 0 &amp; 4 &amp; 4\\   2 &amp; 0 &amp; 0 &amp; 4 &amp; 0 &amp; 0 &amp; 5 &amp; 0 &amp; 0\\   0 &amp; 2 &amp; 2 &amp; 0 &amp; 4 &amp; 4 &amp; 0 &amp; 5 &amp; 5\\   0 &amp; 2 &amp; 2 &amp; 0 &amp; 4 &amp; 4 &amp; 0 &amp; 5 &amp; 5\\   3 &amp; 0 &amp; 0 &amp; 4 &amp; 0 &amp; 0 &amp; 4 &amp; 0 &amp; 0\\   0 &amp; 3 &amp; 3 &amp; 0 &amp; 4 &amp; 4 &amp; 0 &amp; 4 &amp; 4\\   0 &amp; 3 &amp; 3 &amp; 0 &amp; 4 &amp; 4 &amp; 0 &amp; 4 &amp; 4\end{pmatrix}\]</span></p>
<ol start="2" type="1">
<li><p><strong>Interpret the Kronecker Product Matrix:</strong> The resulting matrix <span class="math inline">\(K\)</span> represents all possible combinations of user preferences and category features.</p></li>
<li><p><strong>Predict Ratings:</strong> For each user, use matrix <span class="math inline">\(K\)</span> to predict the rating for each category by summing up the values in the corresponding rows.</p></li>
<li><p><strong>Generate Recommendations:</strong> Identify the top categories with the highest predicted ratings for each user.</p></li>
</ol>
<p>The <code>python</code> code to solve this problem computationally is given below.</p>
<div id="f192cda8" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the matrices</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> np.array([[<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>]])</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>]])</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Kronecker product</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> np.kron(U, C)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame to visualize the Kronecker product matrix</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>df_K <span class="op">=</span> pd.DataFrame(K, </span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>                    columns<span class="op">=</span>[<span class="st">'Electronics_F1'</span>, <span class="st">'Electronics_F2'</span>, <span class="st">'Electronics_F3'</span>, </span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'Clothing_F1'</span>, <span class="st">'Clothing_F2'</span>, <span class="st">'Clothing_F3'</span>, </span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'Books_F1'</span>, <span class="st">'Books_F2'</span>, <span class="st">'Books_F3'</span>],</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>                    index<span class="op">=</span>[<span class="st">'User 1 Electronics'</span>, <span class="st">'User 1 Clothing'</span>, <span class="st">'User 1 Books'</span>, </span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'User 2 Electronics'</span>, <span class="st">'User 2 Clothing'</span>, <span class="st">'User 2 Books'</span>, </span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'User 3 Electronics'</span>, <span class="st">'User 3 Clothing'</span>, <span class="st">'User 3 Books'</span>])</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the Kronecker product matrix</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Kronecker Product Matrix (K):</span><span class="ch">\n</span><span class="st">"</span>, df_K)</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict ratings and create recommendations</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recommend(user_index, top_n<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Recommend top_n categories for a given user based on Kronecker product matrix. """</span></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>    user_ratings <span class="op">=</span> K[user_index <span class="op">*</span> <span class="bu">len</span>(C):(user_index <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="bu">len</span>(C), :]</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>    predicted_ratings <span class="op">=</span> np.<span class="bu">sum</span>(user_ratings, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>    recommendations <span class="op">=</span> np.argsort(predicted_ratings)[::<span class="op">-</span><span class="dv">1</span>][:top_n]</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> recommendations</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Recommendations for User 1</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>user_index <span class="op">=</span> <span class="dv">0</span>  <span class="co"># User 1</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>top_n <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>recommendations <span class="op">=</span> recommend(user_index, top_n)</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Top </span><span class="sc">{</span>top_n<span class="sc">}</span><span class="ss"> recommendations for User </span><span class="sc">{</span>user_index <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> rec <span class="kw">in</span> recommendations:</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_K.columns[rec])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kronecker Product Matrix (K):
                     Electronics_F1  Electronics_F2  Electronics_F3  \
User 1 Electronics               5               0               0   
User 1 Clothing                  0               5               5   
User 1 Books                     0               5               5   
User 2 Electronics               2               0               0   
User 2 Clothing                  0               2               2   
User 2 Books                     0               2               2   
User 3 Electronics               3               0               0   
User 3 Clothing                  0               3               3   
User 3 Books                     0               3               3   

                    Clothing_F1  Clothing_F2  Clothing_F3  Books_F1  Books_F2  \
User 1 Electronics            3            0            0         4         0   
User 1 Clothing               0            3            3         0         4   
User 1 Books                  0            3            3         0         4   
User 2 Electronics            4            0            0         5         0   
User 2 Clothing               0            4            4         0         5   
User 2 Books                  0            4            4         0         5   
User 3 Electronics            4            0            0         4         0   
User 3 Clothing               0            4            4         0         4   
User 3 Books                  0            4            4         0         4   

                    Books_F3  
User 1 Electronics         0  
User 1 Clothing            4  
User 1 Books               4  
User 2 Electronics         0  
User 2 Clothing            5  
User 2 Books               5  
User 3 Electronics         0  
User 3 Clothing            4  
User 3 Books               4  

Top 3 recommendations for User 1:
Electronics_F3
Electronics_F2
Books_F3</code></pre>
</div>
</div>
<p>A simple visualization of this recomendation system is shown in <a href="#fig-reco" class="quarto-xref">Fig&nbsp;<span>2.11</span></a>.</p>
<div id="cell-fig-reco" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_recommendations(user_index):</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Plot the predicted ratings for each category for a given user. """</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    user_ratings <span class="op">=</span> K[user_index <span class="op">*</span> <span class="bu">len</span>(C):(user_index <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="bu">len</span>(C), :]</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    predicted_ratings <span class="op">=</span> np.<span class="bu">sum</span>(user_ratings, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    categories <span class="op">=</span> df_K.columns</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">5</span>))</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    plt.bar(categories, predicted_ratings)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Categories'</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Predicted Ratings'</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f'Predicted Ratings for User </span><span class="sc">{</span>user_index <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot recommendations for User 1</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>plot_recommendations(user_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-reco" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-reco-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="module_2_files/figure-html/fig-reco-output-1.png" width="510" height="513" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-reco-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.11: EDA for the Recommendation System
</figcaption>
</figure>
</div>
</div>
</div>
<p>This micro project illustrate one of the popular use of Kronecker product on ML application.</p>
</section>
</section>
<section id="matrix-measures-of-practical-importance" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="matrix-measures-of-practical-importance"><span class="header-section-number">2.2.3</span> Matrix Measures of Practical Importance</h3>
<p>Matrix measures, such as rank and determinant, play crucial roles in linear algebra. While both rank and determinant provide valuable insights into the properties of a matrix, they serve different purposes. Understanding their roles and applications is essential for solving complex problems in computer science, engineering, and applied mathematics.</p>
<section id="determinant" class="level4" data-number="2.2.3.1">
<h4 data-number="2.2.3.1" class="anchored" data-anchor-id="determinant"><span class="header-section-number">2.2.3.1</span> Determinant</h4>
<p>Determinant of a <span class="math inline">\(2\times 2\)</span> matrix <span class="math inline">\(A=\begin{pmatrix}a&amp;b\\c&amp;d\end{pmatrix}\)</span> is defined as <span class="math inline">\(|A|=ad-bc\)</span>. Determinant of higher order square matrices can be found using the Laplace method or Sarrus method.</p>
<p>The determinant of a matrix provides information about the matrix’s invertibility and scaling factor for volume transformation. Specifically:</p>
<ol type="1">
<li><p><em>Invertibility:</em> A matrix is invertible if and only if its determinant is non-zero.</p></li>
<li><p><em>Volume Scaling:</em> The absolute value of the determinant gives the scaling factor by which the matrix transforms volume.</p></li>
<li><p><em>Parallelism:</em> If the determinant of a matrix composed of vectors is zero, the vectors are linearly dependent, meaning they are parallel or redundant.</p></li>
<li><p><em>Redundancy:</em> A zero determinant indicates that the vectors span a space of lower dimension than the number of vectors, showing redundancy.</p></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Least Possible Values of Determinant
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><em>Least Positive Determinant:</em> For a <span class="math inline">\(1\times 1\)</span> matrix, the smallest non-zero determinant is any positive value, typically <span class="math inline">\(\epsilon\)</span>, where <span class="math inline">\(\epsilon\)</span> is a small positive number.</li>
<li>Least Non-Zero Determinant: For higher-dimensional matrices, the smallest non-zero determinant is a non-zero value that represents the smallest area or volume spanned by the matrix’s rows or columns. For example a <span class="math inline">\(2\times 2\)</span> matrix with determinant <span class="math inline">\(\epsilon\)</span> could be: <span class="math display">\[B=\begin{pmatrix}\epsilon&amp;0\\ 0&amp;\epsilon\end{pmatrix}\]</span> Here, <span class="math inline">\(\epsilon\)</span> is a small positive number, indicating a very small but <em>non-zero</em> area.</li>
</ol>
</div>
</div>
<p>Now let’s look into the most important matrix measure for advanced application in Linear Algebra.</p>
<p>As we know the matrix is basically a representation tool that make things abstract- remove unnecessary details. Then the matrix itself can be represented in many ways. This is the real story telling with this most promising mathematical structure. Consider a context of collecting feedback about a product in three aspects- cost, quality and practicality. For simplicity in calculation, we consider responses from 3 customers only. The data is shown in <a href="#tbl-RT" class="quarto-xref">Table&nbsp;<span>2.6</span></a>.</p>
<div id="tbl-RT" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-RT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.6: User rating of a consumer product
</figcaption>
<div aria-describedby="tbl-RT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>User</th>
<th>Cost</th>
<th>Quality</th>
<th>Practicality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>User-1</td>
<td>1</td>
<td>4</td>
<td>5</td>
</tr>
<tr class="even">
<td>User-2</td>
<td>3</td>
<td>2</td>
<td>5</td>
</tr>
<tr class="odd">
<td>User-3</td>
<td>2</td>
<td>1</td>
<td>3</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>It’s perfect and nice looking. But both mathematics and a computer can’t handle this table as it is. So we create an abstract representation of this data- the rating matrix. Using the traditional approach, let’s represent this rating data as: <span class="math display">\[A=\begin{bmatrix}1&amp;4&amp;5\\3&amp;2&amp;5\\2&amp;1&amp;3\end{bmatrix}\]</span></p>
<p>Now both the column names and row indices were removed and the data is transformed into the abstract form. This representation has both advantages and disadvantages. Be positive! So we are focused only in the advantages.</p>
<p>Just consider the product. Its sales fully based on its features. So the product sales perspective will be represented in terms of the features- cost, quality and practicality. These features are columns of our rating matrix. Definitly people will have different rating for these features. Keeping all these in mind let’s introduce the concept of <em>linear combination</em>. This leads to a new matrix product as shown below.</p>
<p><span class="math display">\[\begin{align*}
Ax&amp;=\begin{bmatrix}
1&amp;4&amp;5\\
3&amp;2&amp;5\\
2&amp;1&amp;3
\end{bmatrix}x\\
&amp;=\begin{bmatrix}
1&amp;4&amp;5\\
3&amp;2&amp;5\\
2&amp;1&amp;3
\end{bmatrix}\cdot\begin{bmatrix}x_1\\x_2\\x_3\end{bmatrix}\\
&amp;=\begin{bmatrix}1\\3\\2\end{bmatrix}x_1+\begin{bmatrix}4\\2\\1\end{bmatrix}x_2+\begin{bmatrix}5\\5\\3\end{bmatrix}x_3
\end{align*}\]</span></p>
<p>As the number of users increases, the product sales perspective become more informative. In short the span of the features define the feature space of the product. In real cases, a manufacture wants to know what are the features really inflence the customers. This new matrix product will help the manufactures to identify that features!</p>
<p>So we are going to define this new matrix product as the feature space, that will provide more insights to this context as:</p>
<p><span class="math display">\[A=CR\]</span></p>
<p>Where <span class="math inline">\(C\)</span> is the column space and <span class="math inline">\(R\)</span> is the row reduced Echelon form of <span class="math inline">\(A\)</span>. But the product is not the usual scalar projection, Instead the weight of linear combination of elements in the column space.</p>
<p>Let’s formally illustrate this in our example. From the first observation itself, it is clear that last column is just the sum of first and second columns (That is in our context the feature ‘practicality’ is just depends on ‘cost’ and ‘quality’. meaningful?). So only first columns are independent and so spans the column space.</p>
<p><span class="math display">\[C=\begin{bmatrix}1&amp;4\\3&amp;2\\2&amp;1\end{bmatrix}\]</span></p>
<p>Now look into the matrix <span class="math inline">\(R\)</span>. Applying elementary row tansformations, <span class="math inline">\(A\)</span> will transformed into:</p>
<p><span class="math display">\[R=\begin{bmatrix}1&amp;0&amp;1\\0&amp;1&amp;1\\0&amp;0&amp;0\end{bmatrix}\]</span></p>
<p>Hence we can form a decomposition for the given rating matrix, <span class="math inline">\(A\)</span> as: <span class="math display">\[\begin{align*}
A&amp;=CR\\
&amp;=\begin{bmatrix}1&amp;4\\3&amp;2\\2&amp;1\end{bmatrix}\begin{bmatrix}1&amp;0&amp;1\\0&amp;1&amp;1\\\mbox{}&amp;&amp;\end{bmatrix}
\end{align*}\]</span></p>
<p>This decomposition says that there are only two independent features (columns) and the third feature (column) is the sum of first two features (columns).</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interpretation of the <span class="math inline">\(R\)</span> matrix
</div>
</div>
<div class="callout-body-container callout-body">
<p>Each column in the <span class="math inline">\(R\)</span> matrix represents the weights for linear combination of vectors in the column space to get that column in <span class="math inline">\(A\)</span>. In this example, third column of <span class="math inline">\(R\)</span> is <span class="math inline">\(\begin{bmatrix}1\\1\end{bmatrix}\)</span>. This means that third column of <span class="math inline">\(A\)</span> will be <span class="math inline">\(1\times C_1+1\times C_2\)</span> of the column space, <span class="math inline">\(C\)</span>!</p>
</div>
</div>
<p>This first matrix decompostion donate a new type of matrix product (outer product) and a new measure- the number of independent columns and number of independent rows. This count is called the <em>rank</em> of the matrix <span class="math inline">\(A\)</span>. In the case of features, if the rank of the column space is less than the number of features then definitly a less number of feature set will perfectly represent the data. This will help us to reduce the dimension of the dataset and there by reducing computational complexities in data analysis and machine Learning jobs.</p>
<p>In the above discussion, we consider only the columns of <span class="math inline">\(A\)</span>. Now we will mention the row space. It is the set of all linearly independent rows of <span class="math inline">\(A\)</span>. For any matrix <span class="math inline">\(A\)</span>, both the row space and column space are of same rank. This correspondance is a helpful result in many practical applications.</p>
<p>Now we consider a stable equation, <span class="math inline">\(Ax=0\)</span>. With the usual notation of dot product, it implies that <span class="math inline">\(x\)</span> is orthogonal to <span class="math inline">\(A\)</span>. Set of all those independent vectors which are orthogonal to <span class="math inline">\(A\)</span> constitute a new space of interest. It is called the <em>null space</em> of <span class="math inline">\(A\)</span>. If <span class="math inline">\(A\)</span> represents a linear transformation, then the null space will be populated by those non-zero vectors which are <em>nullified</em> by the transformation <span class="math inline">\(A\)</span>. As a summary of this discussion, the row space and null space of a matrix <span class="math inline">\(A\)</span> creates an orthogonal system. Considering the relationship between <span class="math inline">\(A\)</span> and <span class="math inline">\(A^T\)</span>, it is clear that row space of <span class="math inline">\(A\)</span> is same as the column space of <span class="math inline">\(A^T\)</span> and vice verse are. So we can restate the orthogonality as: ‘the null space of <span class="math inline">\(A\)</span> is orthogonal to the column space of <span class="math inline">\(A^T\)</span>’ and ‘the null space of <span class="math inline">\(A^T\)</span> is orthogonal to the column space of <span class="math inline">\(A\)</span>’. Mathematically this property can be represents as follows.</p>
<div id="note-ortho" class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
\mathcal{N}(A)&amp;\perp \mathcal{C}(A^T)\\
\mathcal{N}(A^T)&amp;\perp \mathcal{C}(A)
\end{align*}\]</span></p>
</div>
</div>
<p>In the given example, solving <span class="math inline">\(Ax=0\)</span> we get <span class="math inline">\(x=\begin{bmatrix}1&amp;1&amp;-1\end{bmatrix}^T\)</span>.</p>
<p>So the rank of <span class="math inline">\(\mathcal{N}(A)=1\)</span>. Already we have rank of <span class="math inline">\(A=2\)</span>. This leads to an interesting result:</p>
<p><span class="math display">\[\text{Rank}(A)+\text{Rank}(\mathcal{N}(A))=3\]</span></p>
<p>This observation can be framed as a theorem.</p>
</section>
</section>
<section id="rank-nullity-theorem" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="rank-nullity-theorem"><span class="header-section-number">2.2.4</span> Rank Nullity Theorem</h3>
<p>The rank-nullity theorem is a fundamental theorem in linear algebra that is important for understanding the connections between mathematical operations in engineering, physics, and computer science. It states that the sum of the rank and nullity of a matrix equals the number of columns in the matrix. The rank is the maximum number of linearly independent columns, and the nullity is the dimension of the nullspace.</p>
<div id="thm-RNT" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.1 (Rank Nullitty Theorem)</strong></span> The Rank-Nullity Theorem states that for any <span class="math inline">\(m \times n\)</span> matrix <span class="math inline">\(A\)</span>, the following relationship holds:</p>
<p><span class="math display">\[
\text{Rank}(A) + \text{Nullity}(A) = n
\]</span></p>
<p>where: - <strong>Rank</strong> of <span class="math inline">\(A\)</span> is the dimension of the column space of <span class="math inline">\(A\)</span>, which is also equal to the dimension of the row space of <span class="math inline">\(A\)</span>. - <strong>Nullity</strong> of <span class="math inline">\(A\)</span> is the dimension of the null space of <span class="math inline">\(A\)</span>, which is the solution space to the homogeneous system <span class="math inline">\(A \mathbf{x} = \mathbf{0}\)</span>.</p>
</div>
<p><em>Steps to Formulate for Matrix <span class="math inline">\(A\)</span></em></p>
<ol type="1">
<li><p><strong>Find the Rank of <span class="math inline">\(A\)</span></strong>: The rank of a matrix is the maximum number of linearly independent columns (or rows). It can be determined by transforming <span class="math inline">\(A\)</span> into its row echelon form or reduced row echelon form (RREF).</p></li>
<li><p><strong>Find the Nullity of <span class="math inline">\(A\)</span></strong>: The nullity is the dimension of the solution space of <span class="math inline">\(A \mathbf{x} = \mathbf{0}\)</span>. This can be found by solving the homogeneous system and counting the number of free variables.</p></li>
<li><p><strong>Apply the Rank-Nullity Theorem</strong>: Use the rank-nullity theorem to verify the relationship.</p></li>
</ol>
<hr>
<p><em>Example 1:</em> Calculate the rank and nullity of <span class="math inline">\(A=\begin{bmatrix}   1 &amp; 4 &amp; 5 \\   3 &amp; 2 &amp; 5 \\   2 &amp; 1 &amp; 3   \end{bmatrix}\)</span> and verify the rank nullity theorem.</p>
<ol type="1">
<li><p><strong>Row Echelon Form</strong>:</p>
<p>Perform Gaussian elimination on <span class="math inline">\(A\)</span>:</p>
<p><span class="math display">\[A = \begin{bmatrix} 1 &amp; 4 &amp; 5 \\  3 &amp; 2 &amp; 5 \\   2 &amp; 1 &amp; 3   \end{bmatrix}\]</span></p>
<p>Perform row operations to get it to row echelon form:</p>
<ul>
<li><p>Subtract 3 times row 1 from row 2: <span class="math display">\[\begin{bmatrix}     1 &amp; 4 &amp; 5 \\     0 &amp; -10 &amp; -10 \\     2 &amp; 1 &amp; 3     \end{bmatrix}\]</span></p></li>
<li><p>Subtract 2 times row 1 from row 3: <span class="math display">\[\begin{bmatrix}     1 &amp; 4 &amp; 5 \\     0 &amp; -10 &amp; -10 \\     0 &amp; -7 &amp; -7     \end{bmatrix}\]</span></p></li>
<li><p>Add <span class="math inline">\(\frac{7}{10}\)</span> times row 2 to row 3: <span class="math display">\[\begin{bmatrix}     1 &amp; 4 &amp; 5 \\     0 &amp; -10 &amp; -10 \\     0 &amp; 0 &amp; 0     \end{bmatrix}\]</span></p></li>
</ul>
<p>The matrix is now in row echelon form.</p>
<p><strong>Rank</strong> is the number of non-zero rows, which is 2.</p></li>
<li><p><strong>Find the Nullity</strong>: The matrix <span class="math inline">\(A\)</span> has 3 columns. The number of free variables in the solution of <span class="math inline">\(A \mathbf{x} = \mathbf{0}\)</span> is <span class="math inline">\(3 - \text{Rank}\)</span>.</p>
<p>So, <span class="math display">\[\text{Nullity}(A) = 3 - 2 = 1\]</span></p></li>
<li><p><strong>Apply the Rank-Nullity Theorem</strong>: <span class="math display">\[\text{Rank}(A) + \text{Nullity}(A) = 2 + 1 = 3\]</span></p>
<p>This matches the number of columns of <span class="math inline">\(A\)</span>, confirming the theorem.</p></li>
</ol>
</section>
<section id="fundamental-subspaces" class="level3" data-number="2.2.5">
<h3 data-number="2.2.5" class="anchored" data-anchor-id="fundamental-subspaces"><span class="header-section-number">2.2.5</span> Fundamental Subspaces</h3>
<p>In section <span class="citation" data-cites="note-ortho">(<a href="references.html#ref-note-ortho" role="doc-biblioref"><strong>note-ortho?</strong></a>)</span>, we have seen that for any matrix <span class="math inline">\(A\)</span>, there is two pairs of inter-related orthogonal spaces. This leads to the concept of Fundamental sup spaces.</p>
<p>Matrices are not just arrays of numbers; they can represent linear transformations too. A linear transformation maps vectors from one vector space to another while preserving vector addition and scalar multiplication. The matrix <span class="math inline">\(A\)</span> can be viewed as a representation of a linear transformation <span class="math inline">\(T\)</span> from <span class="math inline">\(\mathbb{R}^n\)</span> to <span class="math inline">\(\mathbb{R}^m\)</span> where:</p>
<p><span class="math display">\[T(\mathbf{x}) = A \mathbf{x}\]</span></p>
<p>In this context:</p>
<ul>
<li>The column space of <span class="math inline">\(A\)</span> represents the range of <span class="math inline">\(T\)</span>, which is the set of all possible outputs.</li>
<li>The null space of <span class="math inline">\(A\)</span> represents the kernel of <span class="math inline">\(T\)</span>, which is the set of vectors that are mapped to the zero vector.</li>
</ul>
<p><strong>The Four Fundamental Subspaces</strong></p>
<p>Understanding the four fundamental subspaces helps in analyzing the properties of a linear transformation. These subspaces are:</p>
<div id="def-FFS" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.1 (Four Fundamental Subspaces)</strong></span> Let <span class="math inline">\(T:\mathbb{R^n}\longrightarrow \mathbb{R^m}\)</span> be a linear transformation and <span class="math inline">\(A\)</span> represents the matrix of transformation. The four fundamental subspaces are defined as:</p>
<ol type="1">
<li><p><strong>Column Space (Range)</strong>: The set of all possible outputs of the transformation. For matrix <span class="math inline">\(A\)</span>, this is the span of its columns. It represents the image of <span class="math inline">\(\mathbb{R}^n\)</span> under <span class="math inline">\(T\)</span>.</p></li>
<li><p><strong>Null Space (Kernel)</strong>: The set of all vectors that are mapped to the zero vector by the transformation. For matrix <span class="math inline">\(A\)</span>, this is the solution space of <span class="math inline">\(A \mathbf{x} = \mathbf{0}\)</span>.</p></li>
<li><p><strong>Row Space</strong>: The span of the rows of <span class="math inline">\(A\)</span>. This space is crucial because it helps in understanding the rank of <span class="math inline">\(A\)</span>. The dimension of the row space is equal to the rank of <span class="math inline">\(A\)</span>, which represents the maximum number of linearly independent rows.</p></li>
<li><p><strong>Left Null Space</strong>: The set of all vectors <span class="math inline">\(\mathbf{y}\)</span> such that <span class="math inline">\(A^T \mathbf{y} = \mathbf{0}\)</span>. It provides insight into the orthogonal complement of the row space.</p></li>
</ol>
</div>
<p>This idea is depicted as a ‘Big picture of the four sub spaces of a matrix’ in the Strang’s text book on Linear algebra for every one <span class="citation" data-cites="strang2020linear">(<a href="references.html#ref-strang2020linear" role="doc-biblioref">Strang 2020</a>)</span>. This ‘Big Picture’ is shown in <a href="#fig-big-pic" class="quarto-xref">Fig-&nbsp;<span>2.12</span></a>.</p>
<div id="fig-big-pic" class="lightbox quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-big-pic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://i.pinimg.com/originals/fb/c5/f9/fbc5f91d82681dd7341dda6915d11e92.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;2.12: The Big Pictue of Fundamental Subspaces"><img src="https://i.pinimg.com/originals/fb/c5/f9/fbc5f91d82681dd7341dda6915d11e92.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-big-pic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.12: The Big Pictue of Fundamental Subspaces
</figcaption>
</figure>
</div>
<p>A video session from Strang’s session is here:</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/rwLOfdfc4dw?si=DsJb8KJTF05hHc76" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<section id="practice-problems-4" class="level4" data-number="2.2.5.1">
<h4 data-number="2.2.5.1" class="anchored" data-anchor-id="practice-problems-4"><span class="header-section-number">2.2.5.1</span> Practice Problems</h4>
<p><strong>Problem 1:</strong> Express the vector <span class="math inline">\((1,-2,5)\)</span> as a linear combination of the vectors <span class="math inline">\((1,1,1)\)</span>, <span class="math inline">\((1,2,3)\)</span> and <span class="math inline">\((2,-1,1)\)</span>.</p>
<p><strong>Problem 2:</strong> Show that the feature vector <span class="math inline">\((2,-5,3)\)</span> is not linearly associated with the features <span class="math inline">\((1,-3,2)\)</span>, <span class="math inline">\((2,-4,-1)\)</span> and <span class="math inline">\((1,-5,7)\)</span>.</p>
<p><strong>Problem 3:</strong> Show that the feature vectors <span class="math inline">\((1,1,1)\)</span>, <span class="math inline">\((1,2,3)\)</span> and <span class="math inline">\((2,-1,1)\)</span> are non-redundant.</p>
<p><strong>Problem 4:</strong> Prove that the features <span class="math inline">\((1,-1,1)\)</span>, <span class="math inline">\((0,1,2)\)</span> and <span class="math inline">\((3,0,-1)\)</span> form basis for the feature space.</p>
<p><strong>Problem 5:</strong> Check whether the vectors <span class="math inline">\((1,2,1)\)</span>, <span class="math inline">\((2,1,4)\)</span> and <span class="math inline">\((4,5,6)\)</span> form a basis for <span class="math inline">\(\mathbb{R}^3\)</span>.</p>
<p><strong>Problem 6:</strong> Find the four fundamental subspaces of the feature space created by <span class="math inline">\((1,2,1)\)</span>, <span class="math inline">\((2,1,4)\)</span> and <span class="math inline">\((4,5,6)\)</span>.</p>
<p><strong>Problem 7:</strong> Find the four fundamental subspaces and its dimensions of the matrix <span class="math inline">\(\begin{bmatrix}1&amp;2&amp;4\\2&amp;1&amp;5\\1&amp;4&amp;6\end{bmatrix}\)</span>.</p>
<p><strong>Problem 8:</strong> Express <span class="math inline">\(A=\begin{bmatrix}1&amp;2&amp;-1\\3&amp;1&amp;-1\\2&amp;-1&amp;0\end{bmatrix}\)</span> as the Kronecker product of the column space and the row space in the form <span class="math inline">\(A=C\otimes R\)</span>.</p>
<p><strong>Problem 9:</strong> Find the four fundamental subspaces of <span class="math inline">\(A=\begin{bmatrix} 1&amp;2&amp;0&amp;2&amp;5\\-2&amp;-5&amp;1&amp;-1&amp;-8\\0&amp;-3&amp;3&amp;4&amp;1\\3&amp;6&amp;0&amp;-7&amp;2\end{bmatrix}\)</span>.</p>
<p><strong>Problem 10:</strong> Find the four fundamental subspaces of <span class="math inline">\(A=\begin{bmatrix}-1&amp;2&amp;-1&amp;5&amp;6\\4&amp;-4&amp;-4&amp;-12&amp;-8\\2&amp;0&amp;-6&amp;-2&amp;4\\-3&amp;1&amp;7&amp;-2&amp;12\end{bmatrix}\)</span>.</p>
<p><strong>Problem 11:</strong> Express <span class="math inline">\(A=\begin{bmatrix}2&amp;3&amp;-1&amp;-1\\1&amp;-1&amp;-2&amp;-4\\3&amp;1&amp;3&amp;-2\\6&amp;3&amp;0&amp;-7\end{bmatrix}\)</span> in <span class="math inline">\(A=C\otimes R\)</span>, where <span class="math inline">\(C\)</span> is the column space and <span class="math inline">\(R\)</span> is the row space of <span class="math inline">\(A\)</span>.</p>
<p><strong>Problem 12:</strong> Express <span class="math inline">\(A=\begin{bmatrix}0&amp;1&amp;-3&amp;-1\\1&amp;0&amp;1&amp;1\\3&amp;1&amp;0&amp;2\\1&amp;1&amp;-2&amp;0\end{bmatrix}\)</span> in <span class="math inline">\(A=C\otimes R\)</span>, where <span class="math inline">\(C\)</span> is the column space and <span class="math inline">\(R\)</span> is the row space of <span class="math inline">\(A\)</span>.</p>
<p><strong>Problem 13:</strong> Show that the feature vectors <span class="math inline">\((2,3,0)\)</span>, <span class="math inline">\((1,2,0)\)</span> and <span class="math inline">\((8,13,0)\)</span> are redundant and hence find the relationship between them.</p>
<p><strong>Problem 14:</strong> Show that the feature vectors <span class="math inline">\((1,2,1)\)</span>, <span class="math inline">\((4,1,2)\)</span>, <span class="math inline">\((-3,8,1)\)</span> and <span class="math inline">\((6,5,4)\)</span> are redundant and hence find the relationship between them.</p>
<p><strong>Problem 15:</strong> Show that the feature vectors <span class="math inline">\((1,2,-1,0)\)</span>, <span class="math inline">\((1,3,1,2)\)</span>, <span class="math inline">\((4,2,1,0)\)</span> and <span class="math inline">\((6,1,0,1)\)</span> are redundant and hence find the relationship between them.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Three Parts of the <em>Fundamental theorem</em></strong> The fundamental theorem of linear algebra relates all four of the fundamental subspaces in a number of different ways. There are main parts to the theorem:</p>
<p><strong>Part 1:(Rank nullity theorem)</strong> The column and row spaces of an <span class="math inline">\(m\times n\)</span> matrix <span class="math inline">\(A\)</span> both have dimension <span class="math inline">\(r\)</span>, the rank of the matrix. The nullspace has dimension <span class="math inline">\(n−r\)</span>, and the left nullspace has dimension <span class="math inline">\(m−r\)</span>.</p>
<p><strong>Part 2:(Orthogonal subspaces)</strong> The nullspace and row space are orthogonal. The left nullspace and the column space are also orthogonal.</p>
<p><strong>Part 3:(Matrix decomposition)</strong> The final part of the fundamental theorem of linear algebra constructs an orthonormal basis, and demonstrates a singular value decomposition: any matrix <span class="math inline">\(M\)</span> can be written in the form <span class="math inline">\(M=U\Sigma V^T\)</span> , where <span class="math inline">\(U_{m\times m}\)</span> and <span class="math inline">\(V_{n\times n}\)</span> are unitary matrices, <span class="math inline">\(\Sigma_{m\times n}\)</span> matrix with nonnegative values on the diagonal.</p>
<p>This part of the fundamental theorem allows one to immediately find a basis of the subspace in question. This can be summarized in the following table.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 12%">
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Subspace</th>
<th style="text-align: center;">Subspace of</th>
<th style="text-align: center;">Symbol</th>
<th style="text-align: center;">Dimension</th>
<th style="text-align: center;">Basis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Column space</td>
<td style="text-align: center;"><span class="math inline">\(\mathbb{R}^m\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\operatorname{im}(A)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r\)</span></td>
<td style="text-align: center;">First <span class="math inline">\(r\)</span> columns of <span class="math inline">\(U\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Nullspace (kernel)</td>
<td style="text-align: center;"><span class="math inline">\(\mathbb{R}^n\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\ker(A)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n - r\)</span></td>
<td style="text-align: center;">Last <span class="math inline">\(n - r\)</span> columns of <span class="math inline">\(V\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Row space</td>
<td style="text-align: center;"><span class="math inline">\(\mathbb{R}^n\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\operatorname{im}(A^T)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r\)</span></td>
<td style="text-align: center;">First <span class="math inline">\(r\)</span> columns of <span class="math inline">\(V\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Left nullspace (kernel)</td>
<td style="text-align: center;"><span class="math inline">\(\mathbb{R}^m\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\ker(A^T)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(m - r\)</span></td>
<td style="text-align: center;">Last <span class="math inline">\(m - r\)</span> columns of <span class="math inline">\(U\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="computational-methods-to-find-all-the-four-fundamental-subspaces-of-a-matrix" class="level4" data-number="2.2.5.2">
<h4 data-number="2.2.5.2" class="anchored" data-anchor-id="computational-methods-to-find-all-the-four-fundamental-subspaces-of-a-matrix"><span class="header-section-number">2.2.5.2</span> Computational methods to find all the four fundamental subspaces of a matrix</h4>
<p>There are different approaches to find the four fundamental subspaces of a matrix using <code>Python</code>. Simplest method is just convert our mathematical procedure into <code>Python</code> functions and call them to find respective spaces. This method is illustrated below.</p>
<div id="74cdaf06" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># importing numpy library for numerical computation</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define the function create the row-reduced Echelon form of given matrix</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> row_echelon_form(A):</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Convert matrix A to its row echelon form."""</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> A.astype(<span class="bu">float</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    rows, cols <span class="op">=</span> A.shape</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">min</span>(rows, cols)):</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Pivot: find the maximum element in the current column</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>        max_row <span class="op">=</span> np.argmax(np.<span class="bu">abs</span>(A[i:, i])) <span class="op">+</span> i</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> A[max_row, i] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span>  <span class="co"># Skip if the column is zero</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Swap the current row with the max_row</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        A[[i, max_row]] <span class="op">=</span> A[[max_row, i]]</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Eliminate entries below the pivot</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, rows):</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>            factor <span class="op">=</span> A[j, i] <span class="op">/</span> A[i, i]</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>            A[j, i:] <span class="op">-=</span> factor <span class="op">*</span> A[i, i:]</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> A</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="co"># define function to generate null space from the row-reduced echelon form</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> null_space_of_matrix(A, rtol<span class="op">=</span><span class="fl">1e-5</span>):</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute the null space of a matrix A using row reduction."""</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>    A_reduced <span class="op">=</span> row_echelon_form(A)</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>    rows, cols <span class="op">=</span> A_reduced.shape</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Identify pivot columns</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>    pivots <span class="op">=</span> []</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows):</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols):</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> np.<span class="bu">abs</span>(A_reduced[i, j]) <span class="op">&gt;</span> rtol:</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>                pivots.append(j)</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>    free_vars <span class="op">=</span> <span class="bu">set</span>(<span class="bu">range</span>(cols)) <span class="op">-</span> <span class="bu">set</span>(pivots)</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>    null_space <span class="op">=</span> []</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> free_var <span class="kw">in</span> free_vars:</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>        null_vector <span class="op">=</span> np.zeros(cols)</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>        null_vector[free_var] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> pivot, row <span class="kw">in</span> <span class="bu">zip</span>(pivots, A_reduced[:<span class="bu">len</span>(pivots)]):</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>            null_vector[pivot] <span class="op">=</span> <span class="op">-</span>row[free_var]</span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>        null_space.append(null_vector)</span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(null_space).T</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a><span class="co"># define the function to generate the row-space of A</span></span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> row_space_of_matrix(A):</span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute the row space of a matrix A using row reduction."""</span></span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>    A_reduced <span class="op">=</span> row_echelon_form(A)</span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The non-zero rows of the reduced matrix form the row space</span></span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a>    non_zero_rows <span class="op">=</span> A_reduced[<span class="op">~</span>np.<span class="bu">all</span>(A_reduced <span class="op">==</span> <span class="dv">0</span>, axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> non_zero_rows</span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a><span class="co"># define the function to generate the column space of A</span></span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> column_space_of_matrix(A):</span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute the column space of a matrix A using row reduction."""</span></span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a>    A_reduced <span class="op">=</span> row_echelon_form(A)</span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a>    rows, cols <span class="op">=</span> A_reduced.shape</span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Identify pivot columns</span></span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a>    pivots <span class="op">=</span> []</span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows):</span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols):</span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> np.<span class="bu">abs</span>(A_reduced[i, j]) <span class="op">&gt;</span> <span class="fl">1e-5</span>:</span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a>                pivots.append(j)</span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a>    column_space <span class="op">=</span> A[:, pivots]</span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> column_space</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="examples" class="level4" data-number="2.2.5.3">
<h4 data-number="2.2.5.3" class="anchored" data-anchor-id="examples"><span class="header-section-number">2.2.5.3</span> Examples:</h4>
<ol type="1">
<li>Find all the fundamental subspaces of <span class="math inline">\(A=\begin{pmatrix}1&amp;2&amp;3\\ 4&amp;5&amp;6\\7&amp;8&amp;9\end{pmatrix}\)</span>.</li>
</ol>
<div id="875594b7" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Matrix A:"</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Null Space</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>null_space_A <span class="op">=</span> null_space_of_matrix(A)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Null Space of A:"</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(null_space_A)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Row Space</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>row_space_A <span class="op">=</span> row_space_of_matrix(A)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Row Space of A:"</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(row_space_A)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Column Space</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>column_space_A <span class="op">=</span> column_space_of_matrix(A)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Column Space of A:"</span>)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(column_space_A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Matrix A:
[[1 2 3]
 [4 5 6]
 [7 8 9]]

Null Space of A:
[[-9.        ]
 [-1.71428571]
 [ 1.        ]]

Row Space of A:
[[7.00000000e+00 8.00000000e+00 9.00000000e+00]
 [0.00000000e+00 8.57142857e-01 1.71428571e+00]
 [0.00000000e+00 5.55111512e-17 1.11022302e-16]]

Column Space of A:
[[1 2]
 [4 5]
 [7 8]]</code></pre>
</div>
</div>
</section>
<section id="rank-and-solution-of-system-of-linear-equations" class="level4" data-number="2.2.5.4">
<h4 data-number="2.2.5.4" class="anchored" data-anchor-id="rank-and-solution-of-system-of-linear-equations"><span class="header-section-number">2.2.5.4</span> Rank and Solution of System of Linear Equations</h4>
<p>In linear algebra, the rank of a matrix is a crucial concept for understanding the structure of a system of linear equations. It provides insight into the solutions of these systems, helping us determine the number of independent equations and the nature of the solution space.</p>
<div id="def-soln" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.2 (Rank and System Consistency)</strong></span> The rank of a matrix <span class="math inline">\(A\)</span> is defined as the maximum number of linearly independent rows or columns. When solving a system of linear equations represented by <span class="math inline">\(A\mathbf{x} = \mathbf{b}\)</span>, where <span class="math inline">\(A\)</span> is an <span class="math inline">\(m \times n\)</span> matrix and <span class="math inline">\(\mathbf{b}\)</span> is a vector, the rank of <span class="math inline">\(A\)</span> plays a crucial role in determining the solution’s existence and uniqueness.</p>
<p><strong>Consistency of the System</strong></p>
<ol type="1">
<li><strong>Consistent System:</strong> A system of linear equations is consistent if there exists at least one solution. This occurs if the rank of the coefficient matrix <span class="math inline">\(A\)</span> is equal to the rank of the augmented matrix <span class="math inline">\([A|\mathbf{b}]\)</span>. Mathematically, this can be expressed as: <span class="math display">\[\text{rank}(A) = \text{rank}([A|\mathbf{b}])\]</span> If this condition is met, the system has solutions. The solutions can be:
<ul>
<li><strong>Unique</strong> if the rank equals the number of variables.</li>
<li><strong>Infinitely many</strong> if the rank is less than the number of variables.</li>
</ul></li>
<li><strong>Inconsistent System:</strong> A system is inconsistent if there are no solutions. This occurs when: <span class="math display">\[\text{rank}(A) \ne \text{rank}([A|\mathbf{b}])\]</span> In this case, the equations represent parallel or conflicting constraints that cannot be satisfied simultaneously.</li>
</ol>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Use of Null space in creation of general solution from particular solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the system <span class="math inline">\(AX=b\)</span> has many solutions, then the general solution of the system can be found using a particular solution and the elements in the null space of the coefficient matrix <span class="math inline">\(A\)</span> as</p>
<p><span class="math display">\[X=x_p+tX_N\]</span></p>
<p>where <span class="math inline">\(X\)</span> is the general solution and <span class="math inline">\(t\)</span> is a free variable (parameter) and <span class="math inline">\(X_N\in N(A)\)</span>.</p>
</div>
</div>
</section>
<section id="computational-method-to-solve-system-of-linear-equations." class="level4" data-number="2.2.5.5">
<h4 data-number="2.2.5.5" class="anchored" data-anchor-id="computational-method-to-solve-system-of-linear-equations."><span class="header-section-number">2.2.5.5</span> Computational method to solve system of linear equations.</h4>
<p>If for a system <span class="math inline">\(AX=b\)</span>, <span class="math inline">\(det(A)\neq 0\)</span>, then the system has a unique solution and can be found by <code>solve()</code> function from <code>NumPy</code>. If the system is consistant and many solutions, then computationally we will generate the general solution using the <span class="math inline">\(N(A)\)</span>. A detailed <code>Python</code> code is given below.</p>
<div id="d18e590a" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_consistency(A, b):</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Check the consistency of a linear system Ax = b and return the solution if consistent.</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co">    A (numpy.ndarray): Coefficient matrix.</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co">    b (numpy.ndarray): Right-hand side vector.</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co">    tuple: A tuple with consistency status, particular solution (if consistent), and null space (if infinite solutions).</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> np.array(A)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> np.array(b)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Augment the matrix A with vector b</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    augmented_matrix <span class="op">=</span> np.column_stack((A, b))</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute ranks</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>    rank_A <span class="op">=</span> np.linalg.matrix_rank(A)</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>    rank_augmented <span class="op">=</span> np.linalg.matrix_rank(augmented_matrix)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check for consistency</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> rank_A <span class="op">==</span> rank_augmented:</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> rank_A <span class="op">==</span> A.shape[<span class="dv">1</span>]:</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Unique solution</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>            solution <span class="op">=</span> np.linalg.solve(A, b)</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"Consistent and has a unique solution"</span>, solution, <span class="va">None</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Infinitely many solutions</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>            particular_solution <span class="op">=</span> np.linalg.lstsq(A, b, rcond<span class="op">=</span><span class="va">None</span>)[<span class="dv">0</span>]</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>            null_space <span class="op">=</span> null_space_of_matrix(A)</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"Consistent but has infinitely many solutions"</span>, particular_solution, null_space</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Inconsistent system (no solution)"</span>, <span class="va">None</span>, <span class="va">None</span></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> null_space_of_matrix(A):</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a><span class="co">    Compute the null space of matrix A, which gives the set of solutions to Ax = 0.</span></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a><span class="co">    A (numpy.ndarray): Coefficient matrix.</span></span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a><span class="co">    numpy.ndarray: Basis for the null space of A.</span></span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>    u, s, vh <span class="op">=</span> np.linalg.svd(A)</span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>    null_mask <span class="op">=</span> (s <span class="op">&lt;=</span> <span class="fl">1e-10</span>)  <span class="co"># Singular values near zero</span></span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>    null_space <span class="op">=</span> np.compress(null_mask, vh, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> null_space.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><em>Example 1:</em> Solve <span class="math display">\[\begin{align*}
2x-y+z&amp;=1\\
x+2y&amp;=3\\
3x+2y+z&amp;=4
\end{align*}\]</span></p>
</blockquote>
<div id="404741ad" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage 1: System with a unique solution</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>A1 <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>]])</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>status1, solution1, null_space1 <span class="op">=</span> check_consistency(A1, b1)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Example 1 - Status:"</span>, status1)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> solution1 <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Solution:"</span>, solution1)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> null_space1 <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Null Space:"</span>, null_space1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Example 1 - Status: Consistent and has a unique solution
Solution: [0.27272727 0.90909091 1.36363636]</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><em>Example 2:</em> Solve the system of equations, <span class="math display">\[\begin{align*}
x+2y+z&amp;=3\\
2x+4y+2z&amp;=6\\
x+y+z&amp;=2
\end{align*}\]</span></p>
</blockquote>
<div id="10a5ec0c" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage 2: System with infinitely many solutions</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>A2 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>], [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">2</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]])</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">2</span>])</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>status2, solution2, null_space2 <span class="op">=</span> check_consistency(A2, b2)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 2 - Status:"</span>, status2)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> solution2 <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Particular Solution:"</span>, solution2)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> null_space2 <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Null Space (Basis for infinite solutions):"</span>, null_space2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Example 2 - Status: Consistent but has infinitely many solutions
Particular Solution: [0.5 1.  0.5]
Null Space (Basis for infinite solutions): [[ 7.07106781e-01]
 [ 1.11022302e-16]
 [-7.07106781e-01]]</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="module-review" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="module-review"><span class="header-section-number">2.3</span> Module review</h2>
<ol type="1">
<li>Define the Hadamard Product in Linear Algebra and Provide a Suitable Example.
<ul>
<li><strong>Hint</strong>: Element-wise product of matrices of the same dimensions.<br>
</li>
<li><strong>Example</strong>: For <span class="math inline">\(A = \begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix}\)</span> and <span class="math inline">\(B = \begin{bmatrix} 5 &amp; 6 \\ 7 &amp; 8 \end{bmatrix}\)</span>, <span class="math inline">\(A \circ B = \begin{bmatrix} 5 &amp; 12 \\ 21 &amp; 32 \end{bmatrix}\)</span>.</li>
</ul></li>
<li>Give Two Applications of the Hadamard Product in Machine Learning.
<ul>
<li><strong>Hint</strong>: Gradient updates and feature scaling in deep learning.</li>
</ul></li>
<li>Find the Outer Product of Two Vectors $S_1 = [1, 2, 7] $ and <span class="math inline">\(S_2 = \begin{bmatrix} 7 \\ 2 \\ 1 \end{bmatrix}\)</span>.
<ul>
<li><strong>Hint</strong>: Compute <span class="math inline">\(S_1 \cdot S_2^T\)</span>.</li>
</ul></li>
<li>Define and Differentiate Between the Dot Product and the Outer Product of Two Vectors.
<ul>
<li><strong>Hint</strong>: Dot product results in a scalar; outer product results in a matrix.</li>
</ul></li>
<li>Write a Pseudocode to Compute the Hadamard Product of Two Matrices.
<ul>
<li><strong>Hint</strong>: Use nested loops for element-wise multiplication.</li>
</ul></li>
<li>Compute the Row Norms of Matrix <span class="math inline">\(A = \begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix}\)</span>.
<ul>
<li><strong>Hint</strong>: Use <span class="math inline">\(\|A_{i*}\| = \sqrt{\sum_j A_{ij}^2}\)</span>.</li>
</ul></li>
<li>Find the Column Norms of Matrix <span class="math inline">\(A = \begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix}\)</span>.
<ul>
<li><strong>Hint</strong>: Use <span class="math inline">\(\|A_{*j}\| = \sqrt{\sum_i A_{ij}^2}\)</span>.</li>
</ul></li>
<li>Compute the Frobenius Norm of Matrix <span class="math inline">\(A = \begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix}\)</span>.
<ul>
<li><strong>Hint</strong>: <span class="math inline">\(\|A\|_F = \sqrt{\sum_{i,j} A_{ij}^2}\)</span>.</li>
</ul></li>
<li>Prove the Hadamard Product Is Commutative and Associative.
<ul>
<li><strong>Hint</strong>: Based on properties of element-wise operations.</li>
</ul></li>
<li>Explain the Use of the Hadamard Product in Convolutional Neural Networks.
<ul>
<li><strong>Hint</strong>: Used in depth-wise convolutions and attention mechanisms.</li>
</ul></li>
<li>For Vectors <span class="math inline">\(u = [1, 2, 3]\)</span> and <span class="math inline">\(v = [4, 5, 6]\)</span>, Compute <span class="math inline">\(u \circ v\)</span> and <span class="math inline">\(u \cdot v\)</span>.
<ul>
<li><strong>Hint</strong>: Hadamard product is element-wise, dot product is summation.</li>
</ul></li>
<li>Write Pseudocode for Outer Product of Two Vectors.
<ul>
<li><strong>Hint</strong>: Compute <span class="math inline">\(u_i \cdot v_j\)</span> for all <span class="math inline">\(i, j\)</span>.</li>
</ul></li>
<li>Discuss the Role of the Outer Product in Tensor Decomposition.
<ul>
<li><strong>Hint</strong>: Used to represent rank-1 tensors.</li>
</ul></li>
<li>Find Hadamard Product of <span class="math inline">\(A = \begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix}\)</span> and <span class="math inline">\(B = \begin{bmatrix} 2 &amp; 0 \\ 1 &amp; 5 \end{bmatrix}\)</span>.
<ul>
<li><strong>Hint</strong>: Multiply corresponding elements.</li>
</ul></li>
<li>Use Python to Compute Outer Product of <span class="math inline">\(x = [1, 2]\)</span> and <span class="math inline">\(y = [3, 4]\)</span>.
<ul>
<li><strong>Hint</strong>: Use NumPy’s <code>np.outer(x, y)</code>.</li>
</ul></li>
<li>Write all the fundamental subspaces of <span class="math inline">\(A = \begin{bmatrix} 1 &amp; 2 &amp; 5 \\ 3 &amp; 4 &amp; 10 \\ 5 &amp; 6 &amp; 16 \end{bmatrix}\)</span>.
<ul>
<li><strong>Hint</strong>: Determine the column space, null space, row space, and left null space using Gaussian elimination and rank of <span class="math inline">\(A\)</span>.</li>
</ul></li>
<li>In a recommendation system, the user preference is <span class="math inline">\(u = [4, 3, 5]\)</span> and the item score is <span class="math inline">\(v = [2, 5, 4]\)</span>. Find the user-item interaction score and its Frobenius norm.
<ul>
<li><strong>Hint</strong>: Compute the outer product <span class="math inline">\(u \cdot v^T\)</span> and the Frobenius norm <span class="math inline">\(\|u \cdot v^T\|_F = \sqrt{\sum u_iv_j^2}\)</span>.</li>
</ul></li>
<li>Verify the rank-nullity theorem for <span class="math inline">\(A = \begin{bmatrix} 7 &amp; -3 &amp; 5 \\ 9 &amp; 11 &amp; 2 \\ 16 &amp; 8 &amp; 7 \end{bmatrix}\)</span>.
<ul>
<li><strong>Hint</strong>: Compute the rank of <span class="math inline">\(A\)</span>, the dimension of its null space, and verify <span class="math inline">\(\text{rank}(A) + \text{nullity}(A) = \text{number of columns of } A\)</span>.</li>
</ul></li>
<li>Define the Kronecker product of two matrices. Find the Kronecker product of <span class="math inline">\(A = \begin{bmatrix} -1 &amp; 1 \\ 1 &amp; -1 \end{bmatrix}\)</span> and <span class="math inline">\(B = \begin{bmatrix} 1 &amp; 0 &amp; 1 &amp; 8 \\ 2 &amp; -2 &amp; 2 &amp; -2 \\ -4 &amp; 0 &amp; 3 &amp; -1 \end{bmatrix}\)</span> in block matrix form.
<ul>
<li><strong>Hint</strong>: Use the definition <span class="math inline">\(A \otimes B = \begin{bmatrix} a_{11}B &amp; a_{12}B \\ a_{21}B &amp; a_{22}B \end{bmatrix}\)</span>.</li>
</ul></li>
<li>Explain and compute the rank of the Kronecker product of two matrices $A $ and <span class="math inline">\(B\)</span>, where $A $ is <span class="math inline">\(2 \times 2\)</span> and $B $ is <span class="math inline">\(3 \times 3\)</span>.
<ul>
<li><strong>Hint</strong>: Use the property <span class="math inline">\(\text{rank}(A \otimes B) = \text{rank}(A) \cdot \text{rank}(B)\)</span>.</li>
</ul></li>
<li>Find the row space and column space of <span class="math inline">\(A = \begin{bmatrix} 2 &amp; 4 &amp; 6 \\ 1 &amp; 2 &amp; 3 \\ 0 &amp; 0 &amp; 0 \end{bmatrix}\)</span>.
<ul>
<li><strong>Hint</strong>: Row space is spanned by independent rows; column space is spanned by independent columns.</li>
</ul></li>
<li>Determine if <span class="math inline">\(A = \begin{bmatrix} 1 &amp; 2 \\ 2 &amp; 4 \end{bmatrix}\)</span> is invertible. If not, explain why using its fundamental subspaces.
<ul>
<li><strong>Hint</strong>: Check if the null space is trivial or if the determinant of <span class="math inline">\(A\)</span> is zero.</li>
</ul></li>
<li>Write a pseudocode to calculate the Frobenius norm of any <span class="math inline">\(m \times n\)</span> matrix.
<ul>
<li><strong>Hint</strong>: Use <span class="math inline">\(\|A\|_F = \sqrt{\sum_{i=1}^m \sum_{j=1}^n A_{ij}^2}\)</span>.</li>
</ul></li>
<li>Find the projection of <span class="math inline">\(b = \begin{bmatrix} 3 \\ 4 \\ 5 \end{bmatrix}\)</span> onto the column space of <span class="math inline">\(A = \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \\ 1 &amp; 1 \end{bmatrix}\)</span>.
<ul>
<li><strong>Hint</strong>: Use <span class="math inline">\(P = A(A^T A)^{-1}A^T b\)</span>.</li>
</ul></li>
<li>Write a pseudocode to compute the outer product of two vectors <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.
<ul>
<li><strong>Hint</strong>: Use a nested loop or NumPy’s <code>np.outer()</code> function to compute the product.</li>
</ul></li>
</ol>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-strang2020linear" class="csl-entry" role="listitem">
Strang, Gilbert. 2020. <em>Linear Algebra for Everyone</em>. SIAM.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>A regularization techniques in Deep learning. This approach deactivate some selected neurons to control model over-fitting<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Remember that the covariance of <span class="math inline">\(X\)</span> is defined as <span class="math inline">\(Cov(X)=\dfrac{\sum (X-\bar{X})^2}{n-1}\)</span><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./module_1.html" class="pagination-link" aria-label="Python for Linear Algebra">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Python for Linear Algebra</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./module_3.html" class="pagination-link" aria-label="Python Libraries for Computational Linear Algebra">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python Libraries for Computational Linear Algebra</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","descPosition":"bottom","loop":false,"openEffect":"zoom","closeEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>