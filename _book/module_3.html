<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Python Libraries for Computational Linear Algebra – Computational Linear Algebra</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./module_2.html" rel="prev">
<link href="./CME_logo.JPG" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./module_3.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python Libraries for Computational Linear Algebra</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computational Linear Algebra</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/sijuswamy/Computational-Linear-Algebra" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Computational-Linear-Algebra.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Computational-Linear-Algebra.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./module_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Python for Linear Algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./module_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Transforming Linear Algebra to Computational Language</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./module_3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python Libraries for Computational Linear Algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CME_logo.JPG" class="img-fluid figure-img"></p>
<figcaption>Computational Mathematics</figcaption>
</figure>
</div>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-to-numpy" id="toc-introduction-to-numpy" class="nav-link active" data-scroll-target="#introduction-to-numpy"><span class="header-section-number">3.1</span> Introduction to NumPy</a>
  <ul class="collapse">
  <li><a href="#purpose-of-using-numpy" id="toc-purpose-of-using-numpy" class="nav-link" data-scroll-target="#purpose-of-using-numpy"><span class="header-section-number">3.1.1</span> Purpose of Using NumPy</a></li>
  </ul></li>
  <li><a href="#basic-operations-in-numpy" id="toc-basic-operations-in-numpy" class="nav-link" data-scroll-target="#basic-operations-in-numpy"><span class="header-section-number">3.2</span> Basic Operations in NumPy</a>
  <ul class="collapse">
  <li><a href="#define-different-types-of-numpy-arrays" id="toc-define-different-types-of-numpy-arrays" class="nav-link" data-scroll-target="#define-different-types-of-numpy-arrays"><span class="header-section-number">3.2.1</span> Define different types of <code>numpy</code> arrays</a></li>
  <li><a href="#review-questions" id="toc-review-questions" class="nav-link" data-scroll-target="#review-questions"><span class="header-section-number">3.2.2</span> Review Questions</a></li>
  <li><a href="#tensors-in-numpy" id="toc-tensors-in-numpy" class="nav-link" data-scroll-target="#tensors-in-numpy"><span class="header-section-number">3.2.3</span> Tensors in NumPy</a></li>
  <li><a href="#array-indexing-accessing-single-elements" id="toc-array-indexing-accessing-single-elements" class="nav-link" data-scroll-target="#array-indexing-accessing-single-elements"><span class="header-section-number">3.2.4</span> Array Indexing: Accessing Single Elements</a></li>
  <li><a href="#array-concatenation-and-splitting" id="toc-array-concatenation-and-splitting" class="nav-link" data-scroll-target="#array-concatenation-and-splitting"><span class="header-section-number">3.2.5</span> Array Concatenation and Splitting</a></li>
  <li><a href="#review-questions-1" id="toc-review-questions-1" class="nav-link" data-scroll-target="#review-questions-1"><span class="header-section-number">3.2.6</span> Review Questions</a></li>
  </ul></li>
  <li><a href="#some-important-numpy-function-for-linear-algrbra" id="toc-some-important-numpy-function-for-linear-algrbra" class="nav-link" data-scroll-target="#some-important-numpy-function-for-linear-algrbra"><span class="header-section-number">3.3</span> Some important <code>NumPy</code> function for Linear Algrbra</a>
  <ul class="collapse">
  <li><a href="#linear-regression-using-numpy" id="toc-linear-regression-using-numpy" class="nav-link" data-scroll-target="#linear-regression-using-numpy"><span class="header-section-number">3.3.1</span> Linear Regression using <code>NumPy</code></a></li>
  <li><a href="#some-interesting-handy-matrix-operations-using-numpy-arrays" id="toc-some-interesting-handy-matrix-operations-using-numpy-arrays" class="nav-link" data-scroll-target="#some-interesting-handy-matrix-operations-using-numpy-arrays"><span class="header-section-number">3.3.2</span> Some interesting handy matrix operations using numpy arrays</a></li>
  </ul></li>
  <li><a href="#basics-of-scipy-library-for-computational-linear-algebra" id="toc-basics-of-scipy-library-for-computational-linear-algebra" class="nav-link" data-scroll-target="#basics-of-scipy-library-for-computational-linear-algebra"><span class="header-section-number">3.4</span> Basics of <code>SciPy</code> Library for Computational Linear Algebra</a>
  <ul class="collapse">
  <li><a href="#basic-matrix-operations" id="toc-basic-matrix-operations" class="nav-link" data-scroll-target="#basic-matrix-operations"><span class="header-section-number">3.4.1</span> Basic Matrix operations</a></li>
  </ul></li>
  <li><a href="#sparse-matrices" id="toc-sparse-matrices" class="nav-link" data-scroll-target="#sparse-matrices"><span class="header-section-number">3.5</span> Sparse Matrices</a>
  <ul class="collapse">
  <li><a href="#sparse-matrix-operations-in-scipy" id="toc-sparse-matrix-operations-in-scipy" class="nav-link" data-scroll-target="#sparse-matrix-operations-in-scipy"><span class="header-section-number">3.5.1</span> Sparse Matrix operations in <code>SciPy</code></a></li>
  </ul></li>
  <li><a href="#visualization-libraries" id="toc-visualization-libraries" class="nav-link" data-scroll-target="#visualization-libraries"><span class="header-section-number">3.6</span> Visualization Libraries</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python Libraries for Computational Linear Algebra</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In the first two modules, we gained a foundational understanding of <code>Python</code> programming and the basics of linear algebra, including fundamental subspaces such as row space, column space, and null space, both theoretically and through Python implementations. These essential concepts provided the groundwork for solving linear algebra problems manually and computationally. Now, as we move into Module 3, the focus shifts toward leveraging advanced <code>Python</code> libraries to handle more complex and large-scale computations in linear algebra efficiently.</p>
<p>This module introduces the powerful computational tools available in <code>Python</code>, such as <code>NumPy</code>, <code>SymPy</code>, <code>SciPy</code>, and <code>Matplotlib</code>. These libraries are designed to enhance the ability to perform both numerical and symbolic operations on matrices, vectors, and systems of equations. With <code>NumPy</code>’s high-performance array operations, <code>SymPy</code>’s symbolic computation abilities, and <code>SciPy</code>’s extensive collection of scientific routines, students will be able to compute solutions for real-world problems with ease. The module also incorporates visualization techniques through <code>Matplotlib</code>, allowing students to graphically represent mathematical solutions, interpret data, and communicate their findings effectively. This module empowers students to move beyond manual calculations and explore advanced problem-solving strategies computationally.</p>
<section id="introduction-to-numpy" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="introduction-to-numpy"><span class="header-section-number">3.1</span> Introduction to NumPy</h2>
<p>In this section, we will introduce <strong>NumPy</strong>, the core library for scientific computing in Python. NumPy provides support for arrays, matrices, and a host of mathematical functions to operate on these structures. This is particularly useful for linear algebra computations, making it an essential tool in computational mathematics. The library also serves as the foundation for many other Python libraries like SciPy, Pandas, and Matplotlib.</p>
<section id="purpose-of-using-numpy" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="purpose-of-using-numpy"><span class="header-section-number">3.1.1</span> Purpose of Using NumPy</h3>
<p>The primary purpose of NumPy is to enable efficient numerical computations involving large datasets, vectors, and matrices. With NumPy, one can perform mathematical operations on arrays and matrices in a way that is highly optimized for performance, both in terms of memory and computational efficiency <span class="citation" data-cites="harris2020array">(<a href="references.html#ref-harris2020array" role="doc-biblioref">Harris et al. 2020</a>)</span>.</p>
<p>Some key advantages of using NumPy include:</p>
<ul>
<li><strong>Efficient handling of large datasets</strong>: Arrays in NumPy are optimized for performance and consume less memory compared to native Python lists.</li>
<li><strong>Matrix operations</strong>: NumPy provides built-in functions for basic matrix operations, allowing one to perform tasks like matrix multiplication, transpose, and inversion easily.</li>
<li><strong>Linear algebra</strong>: It includes functions for solving systems of equations, finding eigenvalues and eigenvectors, computing matrix factorizations, and more.</li>
</ul>
</section>
</section>
<section id="basic-operations-in-numpy" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="basic-operations-in-numpy"><span class="header-section-number">3.2</span> Basic Operations in NumPy</h2>
<p>This section will present several examples of using NumPy array manipulation to access data and subarrays, and to split, reshape, and join the arrays. While the types of operations shown here may seem a bit dry and pedantic, they comprise the building blocks of many other examples used throughout the book. Get to know them well!</p>
<p>We’ll cover a few categories of basic array manipulations here:</p>
<ul>
<li><em>Attributes of arrays</em>: Determining the size, shape, memory consumption, and data types of arrays</li>
<li><em>Indexing of arrays</em>: Getting and setting the value of individual array elements</li>
<li><em>Slicing of arrays</em>: Getting and setting smaller subarrays within a larger array</li>
<li><em>Reshaping of arrays</em>: Changing the shape of a given array</li>
<li><em>Joining and splitting of arrays</em>: Combining multiple arrays into one, and splitting one array into many</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Loading <code>numpy</code> to a python programme
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p>Syntax</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> <span class="st">"name of instance"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>eg: <code>import numpy as np</code></p>
</div>
</div>
<section id="array-creation" class="level4" data-number="3.2.0.1">
<h4 data-number="3.2.0.1" class="anchored" data-anchor-id="array-creation"><span class="header-section-number">3.2.0.1</span> Array Creation</h4>
<p>At the core of NumPy is the <strong>ndarray</strong> object, which represents arrays and matrices. Here’s how to create arrays using NumPy:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a 1D array</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a 2D matrix</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>matrix <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1D Array: </span><span class="ch">\n</span><span class="st">"</span>, arr)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"2D Matrix: </span><span class="ch">\n</span><span class="st">"</span>, matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="define-different-types-of-numpy-arrays" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="define-different-types-of-numpy-arrays"><span class="header-section-number">3.2.1</span> Define different types of <code>numpy</code> arrays</h3>
<p>As the first step to understand different types of arrays in <code>NumPy</code> let us consider the following examples.</p>
<section id="d-array-vector" class="level4" data-number="3.2.1.1">
<h4 data-number="3.2.1.1" class="anchored" data-anchor-id="d-array-vector"><span class="header-section-number">3.2.1.1</span> 1D Array (Vector)</h4>
<p>In NumPy, a one-dimensional (1D) array is similar to a list or vector in mathematics. It consists of a single row or column of numbers, making it an ideal structure for storing sequences of values.</p>
<div id="f1069015" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a 1D array</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3 4]</code></pre>
</div>
</div>
<p>Here, <code>np.array()</code> is used to create a 1D array (or vector) containing the values <code>[1, 2, 3, 4]</code>. The array represents a single sequence of numbers, and it is the basic structure of <code>NumPy</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Use:
</div>
</div>
<div class="callout-body-container callout-body">
<p>A 1D array can represent many things, such as a vector in linear algebra, a list of numbers, or a single dimension of data in a machine learning model.</p>
</div>
</div>
</section>
<section id="d-array-matrix" class="level4" data-number="3.2.1.2">
<h4 data-number="3.2.1.2" class="anchored" data-anchor-id="d-array-matrix"><span class="header-section-number">3.2.1.2</span> 2D Array (Matrix)</h4>
<p>A two-dimensional (2D) array is equivalent to a matrix in mathematics. It consists of rows and columns and is often used to store tabular data or perform matrix operations.</p>
<div id="b20cd44b" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, HTML</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a 2D array (Matrix)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>matrix <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>display(matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[1, 2, 3],
       [4, 5, 6]])</code></pre>
</div>
</div>
<p>In this example, the 2D array (or matrix) is created using <code>np.array()</code> by providing a list of lists, where each list represents a row in the matrix. The result is a matrix with two rows and three columns.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Use:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Matrices are fundamental structures in linear algebra. They can represent anything from transformation matrices in graphics to coefficients in systems of linear equations.</p>
</div>
</div>
</section>
<section id="zero-arrays" class="level4" data-number="3.2.1.3">
<h4 data-number="3.2.1.3" class="anchored" data-anchor-id="zero-arrays"><span class="header-section-number">3.2.1.3</span> Zero Arrays</h4>
<p>Zero arrays are used to initialize matrices or arrays with all elements set to zero. This can be useful when creating placeholder arrays where the values will be computed or updated later.</p>
<div id="97a17fd1" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating an array of zeros</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>zero_matrix <span class="op">=</span> np.zeros((<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(zero_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]</code></pre>
</div>
</div>
<p>The <code>np.zeros()</code> function creates an array filled with zeros. In this example, we create a 3x3 matrix with all elements set to zero.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Use:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Zero arrays are commonly used in algorithms that require the allocation of memory for arrays that will be updated later.</p>
</div>
</div>
</section>
<section id="identity-matrix" class="level4" data-number="3.2.1.4">
<h4 data-number="3.2.1.4" class="anchored" data-anchor-id="identity-matrix"><span class="header-section-number">3.2.1.4</span> Identity Matrix</h4>
<p>An identity matrix is a square matrix with ones on the diagonal and zeros elsewhere. It plays a crucial role in linear algebra, especially in solving systems of linear equations and matrix factorizations.</p>
<div id="b5bb038e" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating an identity matrix</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>identity_matrix <span class="op">=</span> np.eye(<span class="dv">3</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(identity_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]</code></pre>
</div>
</div>
<p>The <code>np.eye(n)</code> function creates an identity matrix with the specified size. In this case, we create a 3x3 identity matrix, where all diagonal elements are 1, and off-diagonal elements are 0.</p>
</section>
<section id="arange-function" class="level4" data-number="3.2.1.5">
<h4 data-number="3.2.1.5" class="anchored" data-anchor-id="arange-function"><span class="header-section-number">3.2.1.5</span> Arange Function</h4>
<p>The <code>np.arange()</code> function is used to create an array with evenly spaced values within a given range. It’s similar to Python’s built-in ``range() function but returns a NumPy array instead of a list.</p>
<div id="6faca4d4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating an array using arange</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 3 5 7 9]</code></pre>
</div>
</div>
<p>Here, <code>np.arange(1, 10, 2)</code> generates an array of numbers starting at 1, ending before 10, with a step size of 2. The result is <code>[1, 3, 5, 7, 9]</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Use:
</div>
</div>
<div class="callout-body-container callout-body">
<p>This function is useful when creating arrays for loops, data generation, or defining sequences for analysis.</p>
</div>
</div>
</section>
<section id="linspace-function" class="level4" data-number="3.2.1.6">
<h4 data-number="3.2.1.6" class="anchored" data-anchor-id="linspace-function"><span class="header-section-number">3.2.1.6</span> Linspace Function</h4>
<p>The <code>np.linspace()</code> function generates an array of evenly spaced values between a specified start and end, with the number of intervals defined by the user.</p>
<div id="341caa56" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating an array using linspace</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.   0.25 0.5  0.75 1.  ]</code></pre>
</div>
</div>
<p><code>np.linspace(0, 1, 5)</code> creates an array with 5 evenly spaced values between 0 and 1, including both endpoints. The result is <code>[0. , 0.25, 0.5 , 0.75, 1. ]</code>. :::{.callout-note} ### Use: linspace() is often used when you need a specific number of evenly spaced points within a range, such as for plotting functions or simulating data. :::</p>
</section>
<section id="reshaping-arrays" class="level4" data-number="3.2.1.7">
<h4 data-number="3.2.1.7" class="anchored" data-anchor-id="reshaping-arrays"><span class="header-section-number">3.2.1.7</span> Reshaping Arrays</h4>
<p>The <code>reshape()</code> function changes the shape of an existing array without changing its data. It’s useful when you need to convert an array to a different shape for computations or visualizations.</p>
<div id="7d7f764a" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshaping an array</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>reshaped_arr <span class="op">=</span> arr.reshape(<span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reshaped_arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [4 5 6]
 [7 8 9]]</code></pre>
</div>
</div>
<p>In this example, a 1D array with 9 elements is reshaped into a 3x3 matrix using the <code>reshape()</code> method. The data remains the same but is now structured in a 2D form.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Use:
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Reshaping</em> is critical in linear algebra and machine learning when working with input data of different dimensions.</p>
</div>
</div>
</section>
<section id="random-arrays" class="level4" data-number="3.2.1.8">
<h4 data-number="3.2.1.8" class="anchored" data-anchor-id="random-arrays"><span class="header-section-number">3.2.1.8</span> Random Arrays</h4>
<p>NumPy’s random module is used to generate arrays with random values. These arrays are useful in simulations, testing algorithms, and initializing variables in machine learning.</p>
<div id="2693f638" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a random array</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>random_arr <span class="op">=</span> np.random.rand(<span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(random_arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.97047251 0.54420443 0.8794029 ]
 [0.61048216 0.68796938 0.10196261]
 [0.48323932 0.88322942 0.24459062]]</code></pre>
</div>
</div>
<p><code>np.random.rand(3, 3)</code> creates a 3x3 matrix with random values between 0 and 1. The <code>rand()</code> function generates random floats in the range <span class="math inline">\([0, 1)\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Use:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Random arrays are commonly used for initializing weights in machine learning algorithms, simulating stochastic processes, or for testing purposes.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Syntax
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>One-Dimensional Array:</strong> <code>np.array([list of values])</code><br>
</li>
<li><strong>Two-Dimensional Array:</strong> <code>np.array([[list of values], [list of values]])</code><br>
</li>
<li><strong>Zero Array:</strong> <code>np.zeros(shape)</code>
<ul>
<li><code>shape</code> is a tuple representing the dimensions (e.g., <code>(3, 3)</code> for a 3x3 matrix).</li>
</ul></li>
<li><strong>Identity Matrix:</strong> <code>np.eye(n)</code>
<ul>
<li><code>n</code> is the size of the matrix.</li>
</ul></li>
<li><strong>Arrange Function:</strong> <code>np.arange(start, stop, step)</code>
<ul>
<li><code>start</code> is the starting value, <code>stop</code> is the end value (exclusive), and <code>step</code> is the increment.</li>
</ul></li>
<li><strong>Linspace Function:</strong> <code>np.linspace(start, stop, num)</code>
<ul>
<li><code>start</code> and <code>stop</code> define the range, and <code>num</code> is the number of evenly spaced values.</li>
</ul></li>
<li><strong>Reshaping Arrays:</strong> <code>np.reshape(array, new_shape)</code>
<ul>
<li><code>array</code> is the existing array, and <code>new_shape</code> is the desired shape (e.g., <code>(3, 4)</code>).</li>
</ul></li>
<li><strong>Random Arrays without Using rand:</strong> <code>np.random.randint(low, high, size)</code>
<ul>
<li><code>low</code> and <code>high</code> define the range of values, and <code>size</code> defines the shape of the array.</li>
</ul></li>
</ul>
</div>
</div>
</section>
</section>
<section id="review-questions" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="review-questions"><span class="header-section-number">3.2.2</span> Review Questions</h3>
<p><strong>Q1: What is the purpose of using <code>np.array()</code> in NumPy?</strong><br>
<strong>Ans:</strong> <code>np.array()</code> is used to create arrays in NumPy, which can be 1D, 2D, or multi-dimensional arrays.</p>
<p><strong>Q2: How do you create a 2D array in NumPy?</strong><br>
<strong>Ans:</strong> A 2D array can be created using <code>np.array([[list of values], [list of values]])</code>.</p>
<p><strong>Q3: What is the difference between <code>np.zeros()</code> and <code>np.eye()</code>?</strong><br>
<strong>Ans:</strong> <code>np.zeros()</code> creates an array filled with zeros of a specified shape, while <code>np.eye()</code> creates an identity matrix of size <code>n</code>.</p>
<p><strong>Q4: What is the syntax to create an evenly spaced array using <code>np.linspace()</code>?</strong><br>
<strong>Ans:</strong> The syntax is <code>np.linspace(start, stop, num)</code>, where <code>num</code> specifies the number of evenly spaced points between <code>start</code> and <code>stop</code>.</p>
<p><strong>Q5: How can you reshape an array in NumPy?</strong><br>
<strong>Ans:</strong> Arrays can be reshaped using <code>np.reshape(array, new_shape)</code>, where <code>new_shape</code> is the desired shape for the array.</p>
<p><strong>Q6: How do you create a random integer array in a specific range using NumPy?</strong><br>
<strong>Ans:</strong> You can use <code>np.random.randint(low, high, size)</code> to generate a random array with integers between <code>low</code> and <code>high</code>, and <code>size</code> defines the shape of the array.</p>
<p><strong>Q7: What does the function <code>np.arange(start, stop, step)</code> do?</strong><br>
<strong>Ans:</strong> It generates an array of values from <code>start</code> to <code>stop</code> (exclusive) with a step size of <code>step</code>.</p>
<p><strong>Q8: What is array broadcasting in NumPy?</strong><br>
<strong>Ans:</strong> Array broadcasting allows NumPy to perform element-wise operations on arrays of different shapes by automatically expanding the smaller array to match the shape of the larger array.</p>
<p><strong>Q9: How do you generate a zero matrix of size 4x4 in NumPy?</strong><br>
<strong>Ans:</strong> A zero matrix of size 4x4 can be generated using <code>np.zeros((4, 4))</code>.</p>
<p><strong>Q10: What is the difference between <code>np.arange()</code> and <code>np.linspace()</code>?</strong><br>
<strong>Ans:</strong> <code>np.arange()</code> generates values with a specified step size, while <code>np.linspace()</code> generates evenly spaced values over a specified range and includes the endpoint.</p>
<hr>
</section>
<section id="tensors-in-numpy" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="tensors-in-numpy"><span class="header-section-number">3.2.3</span> Tensors in NumPy</h3>
<p>A tensor is a generalized concept of matrices and vectors. In mathematical terms, tensors are multi-dimensional arrays, and their dimensionality (or rank) is what differentiates them from simpler structures like scalars (rank 0), vectors (rank 1), and matrices (rank 2). A tensor with three dimensions or more is often referred to as a higher-order tensor.</p>
<p>In practical terms, tensors can be seen as multi-dimensional arrays where each element is addressed by multiple indices. Tensors play a significant role in machine learning and deep learning frameworks, where operations on these multi-dimensional data structures are common.</p>
<section id="types-of-tensors" class="level4" data-number="3.2.3.1">
<h4 data-number="3.2.3.1" class="anchored" data-anchor-id="types-of-tensors"><span class="header-section-number">3.2.3.1</span> Types of Tensors:</h4>
<ol type="1">
<li><em>Scalar (0-D Tensor)</em>: A single number.</li>
</ol>
<p>Example: 5 Rank: 0 Shape: ()</p>
<ol start="2" type="1">
<li><em>Vector (1-D Tensor)</em>: An array of numbers.</li>
</ol>
<p>Example: [1, 2, 3] Rank: 1 Shape: (3)</p>
<ol start="3" type="1">
<li><em>Matrix (2-D Tensor)</em>: A 2D array (rows and columns).</li>
</ol>
<p>Example: [[1, 2, 3], [4, 5, 6]] Rank: 2 Shape: (2, 3)</p>
<ol start="4" type="1">
<li><em>3-D Tensor</em>: An array of matrices.</li>
</ol>
<p>Example: [[[1, 2, 3], [4, 5, 6]], [[7, 8, 9], [10, 11, 12]]] Rank: 3 Shape: (2, 2, 3)</p>
<ol start="5" type="1">
<li><em>N-D Tensor</em>: A tensor with N dimensions, where <span class="math inline">\(N &gt; 3\)</span>.</li>
</ol>
<p>Example: A 4-D tensor could represent data with shape <code>(n_samples, n_channels, height, width)</code> in image processing.</p>
</section>
<section id="creating-tensors-using-numpy" class="level4" data-number="3.2.3.2">
<h4 data-number="3.2.3.2" class="anchored" data-anchor-id="creating-tensors-using-numpy"><span class="header-section-number">3.2.3.2</span> Creating Tensors Using NumPy</h4>
<p>In <code>NumPy</code>, tensors are represented as multi-dimensional arrays. You can create tensors in a way similar to how you create arrays, but you extend the dimensions to represent higher-order tensors.</p>
<p><strong>Creating a 1D Tensor (Vector)</strong></p>
<p>A 1D tensor is simply a vector. You can create one using <code>np.array()</code>:</p>
<div id="69c67655" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>vector <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3]</code></pre>
</div>
</div>
<p><strong>Creating a 2D Tensor (Matrix)</strong></p>
<p>A 2D tensor is a matrix:</p>
<div id="78f8ad67" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>matrix <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [4 5 6]]</code></pre>
</div>
</div>
<p><strong>Creating a 3D Tensor</strong></p>
<p>To create a 3D tensor (a stack of matrices):</p>
<div id="e7dc792c" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tensor_3d <span class="op">=</span> np.array([[[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]], [[<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>], [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]]])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tensor_3d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[[ 1  2  3]
  [ 4  5  6]]

 [[ 7  8  9]
  [10 11 12]]]</code></pre>
</div>
</div>
<p><strong>Creating a 4D Tensor</strong></p>
<p>In applications like deep learning, a 4D tensor is often used to represent a batch of images, where the dimensions could be (batch_size, channels, height, width):</p>
<div id="499bffef" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>tensor_4d <span class="op">=</span> np.random.randint(<span class="dv">10</span>, size<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))  <span class="co"># 2 batches, 3 channels, 4x5 images</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tensor_4d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[[[4 2 7 0 9]
   [7 5 4 7 9]
   [9 1 5 4 5]
   [1 3 3 5 9]]

  [[6 1 1 0 9]
   [4 5 1 8 3]
   [9 4 6 0 2]
   [8 1 4 6 4]]

  [[7 6 8 2 5]
   [5 7 1 1 5]
   [8 0 5 6 6]
   [8 7 7 7 3]]]


 [[[6 8 1 2 7]
   [1 6 7 4 8]
   [4 7 5 0 7]
   [0 1 4 7 1]]

  [[9 5 8 7 2]
   [1 1 7 9 4]
   [7 5 6 6 4]
   [4 3 0 1 5]]

  [[8 4 9 2 8]
   [0 2 2 5 5]
   [6 8 4 2 3]
   [9 5 0 0 8]]]]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
General Syntax for Creating Tensors Using NumPy
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>np.array(<span class="bu">object</span>, dtype<span class="op">=</span><span class="va">None</span>, copy<span class="op">=</span><span class="va">True</span>, order<span class="op">=</span><span class="st">'K'</span>, subok<span class="op">=</span><span class="va">False</span>, ndmin<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>object: An array-like object (nested lists) that you want to convert to a tensor.</li>
<li>dtype: The desired data type for the tensor elements.</li>
<li>copy: Whether to copy the data (default True).</li>
<li>order: Row-major (C) or column-major (F) order.</li>
<li>ndmin: Specifies the minimum number of dimensions for the tensor.</li>
</ul>
</div>
</div>
<p>In the next section we will discuss the various attributes of the <code>NumPy</code> array.</p>
</section>
<section id="attributes-of-arrays" class="level4" data-number="3.2.3.3">
<h4 data-number="3.2.3.3" class="anchored" data-anchor-id="attributes-of-arrays"><span class="header-section-number">3.2.3.3</span> Attributes of arrays</h4>
<p>Each array has attributes <code>ndim</code> (the number of dimensions), <code>shape</code> (the size of each dimension), and <code>size</code> (the total size of the array):</p>
<p>To illustrate this attributes, consider the following arrays:</p>
<div id="35626955" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#np.random.seed(0)  # seed for reproducibility</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.random.randint(<span class="dv">10</span>, size<span class="op">=</span><span class="dv">6</span>)  <span class="co"># One-dimensional array</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.random.randint(<span class="dv">10</span>, size<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">4</span>))  <span class="co"># Two-dimensional array</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>x3 <span class="op">=</span> np.random.randint(<span class="dv">10</span>, size<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))  <span class="co"># Three-dimensional array</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The array attributes of <span class="math inline">\(x_3\)</span> is shown below.</p>
<div id="53659983" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"x3 ndim: "</span>, x3.ndim)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"x3 shape:"</span>, x3.shape)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"x3 size: "</span>, x3.size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x3 ndim:  3
x3 shape: (3, 4, 5)
x3 size:  60</code></pre>
</div>
</div>
<p>Another useful attribute are the <code>dtype</code> which return the data type of the array , <code>itemsize</code>, which lists the size (in bytes) of each array element, and <code>nbytes</code>, which lists the total size (in bytes) of the array:</p>
<div id="b06b509f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"dtype:"</span>, x3.dtype)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"itemsize:"</span>, x3.itemsize, <span class="st">"bytes"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"nbytes:"</span>, x3.nbytes, <span class="st">"bytes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dtype: int32
itemsize: 4 bytes
nbytes: 240 bytes</code></pre>
</div>
</div>
</section>
</section>
<section id="array-indexing-accessing-single-elements" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="array-indexing-accessing-single-elements"><span class="header-section-number">3.2.4</span> Array Indexing: Accessing Single Elements</h3>
<p>If you are familiar with Python’s standard list indexing, indexing in <code>NumPy</code> will feel quite familiar. In a one-dimensional array, the <span class="math inline">\(i^{th}\)</span> value (counting from zero) can be accessed by specifying the desired index in square brackets, just as with Python lists:</p>
<p>To demonstrate indexing, let us consider the one dimensional array:</p>
<div id="43e70b9f" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x1<span class="op">=</span>np.array([<span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The fourth element of <code>x1</code> can be accessed as</p>
<div id="193f78d4" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x1[<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>7</code></pre>
</div>
</div>
<p>Now the second element from the end of the the arrray <code>x1</code> can be accessed as:</p>
<div id="cc6239f5" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x1[<span class="op">-</span><span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4</code></pre>
</div>
</div>
<section id="acessing-elements-in-multi-dimensional-arrays" class="level4" data-number="3.2.4.1">
<h4 data-number="3.2.4.1" class="anchored" data-anchor-id="acessing-elements-in-multi-dimensional-arrays"><span class="header-section-number">3.2.4.1</span> Acessing elements in multi-dimensional arrays</h4>
<p>In a multi-dimensional array, items can be accessed using a comma-separated tuple of indices. An example is shown below.</p>
<div id="659c801c" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>x2<span class="op">=</span>np.array([[<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">2</span>],</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>],</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">1</span>]])</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x2)<span class="co"># list the 2-D array</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[3 3 9 2]
 [5 2 3 5]
 [7 2 7 1]]</code></pre>
</div>
</div>
<p>Now print the third element in the first row, we will use the following code.</p>
<div id="8c1f507c" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>x2[<span class="dv">0</span>, <span class="dv">2</span>] <span class="co">## access the element in first row and thrid column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>np.int64(9)</code></pre>
</div>
</div>
<div id="6fdb18b4" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>x2[<span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>] <span class="co">## access the element in the 3rd row and last column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>np.int64(1)</code></pre>
</div>
</div>
</section>
<section id="modification-of-array-elements" class="level4" data-number="3.2.4.2">
<h4 data-number="3.2.4.2" class="anchored" data-anchor-id="modification-of-array-elements"><span class="header-section-number">3.2.4.2</span> Modification of array elements</h4>
<p>Values can also be modified using any of the above index notation. An example is shown below.</p>
<div id="740f3dba" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>x2[<span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>]<span class="op">=</span><span class="dv">20</span> <span class="co">## replace the 3rd row last column element of x2 by 20</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 3  3  9  2]
 [ 5  2  3  5]
 [ 7  2  7 20]]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Homogenity of data in <code>NumPy</code> arrays
</div>
</div>
<div class="callout-body-container callout-body">
<p>Keep in mind that, unlike Python lists, NumPy arrays have a fixed type. This means, for example, that if you attempt to insert a floating-point value to an integer array, the value will be silently truncated. Don’t be caught unaware by this behavior!</p>
</div>
</div>
</section>
<section id="array-slicing-accessing-subarrays" class="level4" data-number="3.2.4.3">
<h4 data-number="3.2.4.3" class="anchored" data-anchor-id="array-slicing-accessing-subarrays"><span class="header-section-number">3.2.4.3</span> Array Slicing: Accessing Subarrays</h4>
<p>Just as we can use square brackets to access individual array elements, we can also use them to access subarrays with the <em>slice</em> notation, marked by the colon (<code>:</code>) character. The NumPy slicing syntax follows that of the standard Python list; to access a slice of an array <code>x</code>, use this:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>x[start:stop:step]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If any of these are unspecified, they default to the values <code>start=0</code>, <code>stop=</code><em><code>size of dimension</code></em>, <code>step=1</code>.</p>
<p>We’ll take a look at accessing sub-arrays in one dimension and in multiple dimensions.</p>
<p><strong>1. One-dimensional subarrays</strong></p>
<div id="952b0baf" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</code></pre>
</div>
</div>
<div id="43d65c25" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>:<span class="dv">6</span>]  <span class="co"># first five elements</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>array([1, 2, 3, 4, 5])</code></pre>
</div>
</div>
<div id="147eeaa6" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">5</span>:]  <span class="co"># elements after index 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>array([5, 6, 7, 8, 9])</code></pre>
</div>
</div>
<div id="1f3ec995" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">4</span>:<span class="dv">7</span>]  <span class="co"># middle sub-array</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>array([4, 5, 6])</code></pre>
</div>
</div>
<div id="69be88ad" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>x[::<span class="dv">2</span>]  <span class="co"># every other element with step 2 (alternate elements)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>array([0, 2, 4, 6, 8])</code></pre>
</div>
</div>
<p><strong>2. Multi-dimensional subarrays (slicing)</strong></p>
<p>Multi-dimensional slices work in the same way, with multiple slices separated by commas. For example:</p>
<div id="c9450ce3" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a two dimensional array</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>x2<span class="op">=</span>np.array([[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],[<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>],[<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>]])</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [3 4 5]
 [5 6 7]]</code></pre>
</div>
</div>
<div id="f9803f76" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting first 3 rows and first two columns from x2</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x2[:<span class="dv">3</span>,:<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2]
 [3 4]
 [5 6]]</code></pre>
</div>
</div>
<div id="65517f95" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x2[:<span class="dv">3</span>:<span class="dv">2</span>,:<span class="dv">3</span>:<span class="dv">2</span>]) <span class="co"># slice alternate elements in first three rows and first three columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 3]
 [5 7]]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Accessing array rows and columns
</div>
</div>
<div class="callout-body-container callout-body">
<p>One commonly needed routine is accessing of single rows or columns of an array. This can be done by combining indexing and slicing, using an empty slice marked by a single colon (<code>:</code>)</p>
</div>
</div>
<p>For example <em>all the elements</em> in first column can be accessed as:</p>
<div id="6b9f9dbc" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x2[:, <span class="dv">0</span>])  <span class="co"># first column of x2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 3 5]</code></pre>
</div>
</div>
</section>
<section id="creating-copies-of-arrays" class="level4" data-number="3.2.4.4">
<h4 data-number="3.2.4.4" class="anchored" data-anchor-id="creating-copies-of-arrays"><span class="header-section-number">3.2.4.4</span> Creating copies of arrays</h4>
<p>Despite the nice features of array views, it is sometimes useful to instead explicitly copy the data within an array or a subarray. This can be most easily done with the <code>copy()</code> method.</p>
<p>This concept can be illustrated through an example. Consider the array <code>x2</code> previously defined:</p>
<div id="421a0d00" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [3 4 5]
 [5 6 7]]</code></pre>
</div>
</div>
<p>Now take a copy of a slice of <code>x2</code> as follows.</p>
<div id="dda28544" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a copy of subarray and store it with the new name</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>x2_sub_copy <span class="op">=</span> x2[:<span class="dv">2</span>, :<span class="dv">2</span>].copy()</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x2_sub_copy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2]
 [3 4]]</code></pre>
</div>
</div>
<p>Now the changes happend in the copy will not affect the orginal array. For example, replace one element in the copy slice and check how it is refelected in both arrays.</p>
<div id="0cee3823" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>x2_sub_copy[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x2_sub_copy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[42  2]
 [ 3  4]]</code></pre>
</div>
</div>
<div id="2a10d9e8" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [3 4 5]
 [5 6 7]]</code></pre>
</div>
</div>
</section>
<section id="more-on-reshaping" class="level4" data-number="3.2.4.5">
<h4 data-number="3.2.4.5" class="anchored" data-anchor-id="more-on-reshaping"><span class="header-section-number">3.2.4.5</span> More on reshaping</h4>
<p>Another useful type of operation is reshaping of arrays. The most flexible way of doing this is with the <code>reshape</code> method. There are various approaches in reshaping of arrays. For example, if you want to put the numbers 1 through 9 in a <span class="math inline">\(3 \times 3\)</span> grid, you can do the following:</p>
<div id="14b308b9" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>np.arange(<span class="dv">1</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>array([1, 2, 3, 4, 5, 6, 7, 8, 9])</code></pre>
</div>
</div>
<div id="9e068d92" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">10</span>).reshape((<span class="dv">9</span>, <span class="dv">1</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]
 [2]
 [3]
 [4]
 [5]
 [6]
 [7]
 [8]
 [9]]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that for this to work, the size of the initial array must match the size of the reshaped array. Where possible, the reshape method will use a no-copy view of the initial array, but with non-contiguous memory buffers this is not always the case.</p>
<p>Another common reshaping pattern is the conversion of a one-dimensional array into a two-dimensional row or column matrix. This can be done with the reshape method, or more easily done by making use of the newaxis keyword within a slice operation:</p>
</div>
</div>
<p><strong>More Examples</strong></p>
<div id="2f6e4c33" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3]</code></pre>
</div>
</div>
<p>Now check the dimension of the array created.</p>
<div id="9ed381b9" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>(3,)</code></pre>
</div>
</div>
<p>Reshaping the array as a matrix.</p>
<div id="aa32bb6e" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># row vector via reshape</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>x1<span class="op">=</span>x.reshape((<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>x1.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>(1, 3)</code></pre>
</div>
</div>
<p>We can achieve the same using the <code>newaxis</code> function as shown below.</p>
<div id="baf226e0" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># row vector via newaxis</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x[np.newaxis, :])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]]</code></pre>
</div>
</div>
<p>Some other similar operations are here.</p>
<div id="1c31722e" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># column vector via reshape</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>x.reshape((<span class="dv">3</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>array([[1],
       [2],
       [3]])</code></pre>
</div>
</div>
<div id="8e4db160" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># column vector via newaxis</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>x[:, np.newaxis]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>array([[1],
       [2],
       [3]])</code></pre>
</div>
</div>
</section>
</section>
<section id="array-concatenation-and-splitting" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="array-concatenation-and-splitting"><span class="header-section-number">3.2.5</span> Array Concatenation and Splitting</h3>
<p>All of the preceding routines worked on single arrays. It’s also possible to combine multiple arrays into one, and to conversely split a single array into multiple arrays. We’ll take a look at those operations here.</p>
<section id="concatenation-of-arrays" class="level4" data-number="3.2.5.1">
<h4 data-number="3.2.5.1" class="anchored" data-anchor-id="concatenation-of-arrays"><span class="header-section-number">3.2.5.1</span> Concatenation of arrays</h4>
<p>Concatenation, or joining of two arrays in NumPy, is primarily accomplished using the routines <code>np.concatenate</code>, <code>np.vstack</code>, and <code>np.hstack</code>. <code>np.concatenate</code> takes a tuple or list of arrays as its first argument, as we can see here:</p>
<div id="f9097ece" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>])</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>np.concatenate([x, y])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>array([1, 2, 3, 3, 2, 1])</code></pre>
</div>
</div>
<p>Another example is shown here:</p>
<div id="241f3edd" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([y, y, y])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>array([3, 2, 1, 3, 2, 1, 3, 2, 1])</code></pre>
</div>
</div>
<p>It can also be used for two-dimensional arrays:</p>
<div id="701a6e04" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>grid1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>                 [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>grid2<span class="op">=</span>np.array([[<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>],[<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">7</span>]])</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># concatenate along the first axis</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>nm<span class="op">=</span>np.concatenate([grid1, grid2],axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>nm.shape</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [4 5 6]
 [5 5 5]
 [7 7 7]]</code></pre>
</div>
</div>
<p>Row-wise concatenation is showm below.</p>
<div id="6db57b3f" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># concatenate along the second axis (horrizontal) (zero-indexed)</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>np.concatenate([grid1, grid2], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>array([[1, 2, 3, 5, 5, 5],
       [4, 5, 6, 7, 7, 7]])</code></pre>
</div>
</div>
<p>For working with arrays of mixed dimensions, it can be clearer to use the <code>np.vstack</code> (vertical stack) and <code>np.hstack</code> (horizontal stack) functions:</p>
<div id="c886fa84" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> np.array([[<span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>],</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                 [<span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>]])</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co"># vertically stack the arrays</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>grid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>array([[9, 8, 7],
       [6, 5, 4]])</code></pre>
</div>
</div>
<p>Now the new vector <code>x</code> has the same number of columns of <code>grid</code>. So we can only vertically stack it <code>grid</code>. For this the numpy function <code>vstack</code> will be used as follows.</p>
<div id="d6ba5c38" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>grid2<span class="op">=</span>np.vstack([grid,x])</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(grid2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[9 8 7]
 [6 5 4]
 [1 2 3]]</code></pre>
</div>
</div>
<p>Similarly the horrizontal stacking can be shown as follows.</p>
<div id="f5681cbf" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># horizontally stack the arrays</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([[<span class="dv">99</span>],</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">99</span>],[<span class="dv">3</span>]])</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>np.hstack([grid2, y])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>array([[ 9,  8,  7, 99],
       [ 6,  5,  4, 99],
       [ 1,  2,  3,  3]])</code></pre>
</div>
</div>
</section>
<section id="splitting-of-arrays" class="level4" data-number="3.2.5.2">
<h4 data-number="3.2.5.2" class="anchored" data-anchor-id="splitting-of-arrays"><span class="header-section-number">3.2.5.2</span> Splitting of arrays</h4>
<p>The opposite of concatenation is splitting, which is implemented by the functions <code>np.split</code>, <code>np.hsplit</code>, and <code>np.vsplit</code>. For each of these, we can pass a list of indices giving the split points:</p>
<p>Let’s begin with one dimensional arrays. First we split this array at specified locations and save it into sub arrays.</p>
<div id="eb2e6044" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">99</span>, <span class="dv">99</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now split the list into two sub lists at index 2</p>
<div id="f6540400" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>x1,x2<span class="op">=</span>np.split(x,[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now see the sub-arrays:</p>
<div id="3f9ba30e" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"the first array is:"</span>, x1)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"the second array is:"</span>, x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>the first array is: [1 2]
the second array is: [ 3 99 99  3  2  1]</code></pre>
</div>
</div>
<p>More sub arrays can be created by passing the splitting locations as a list as follows.</p>
<div id="e83dd0d0" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>x1,x2,x3<span class="op">=</span>np.split(x,[<span class="dv">2</span>,<span class="dv">4</span>])</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x1,<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>,x2,<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>,x3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2] 
 [ 3 99] 
 [99  3  2  1]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice that <span class="math inline">\(N\)</span> split-points, leads to <span class="math inline">\(N + 1\)</span> subarrays. The related functions <code>np.hsplit</code> and <code>np.vsplit</code> are similar:</p>
</div>
</div>
<p>Now use the <code>vsplit</code> and <code>hsplit</code> functions on multi dimensional arrays.</p>
<div id="40f9d0e5" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> np.arange(<span class="dv">16</span>).reshape((<span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>grid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11],
       [12, 13, 14, 15]])</code></pre>
</div>
</div>
<div id="a7bee096" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vsplit</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>upper, lower <span class="op">=</span> np.vsplit(grid, [<span class="dv">2</span>])</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(upper)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0 1 2 3]
 [4 5 6 7]]
[[ 8  9 10 11]
 [12 13 14 15]]</code></pre>
</div>
</div>
<div id="06711e3d" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#hsplit</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>left, right <span class="op">=</span> np.hsplit(grid, [<span class="dv">2</span>])</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Left array:</span><span class="ch">\n</span><span class="st">"</span>,left,<span class="st">"</span><span class="ch">\n</span><span class="st"> Right array:</span><span class="ch">\n</span><span class="st">"</span>,right)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Left array:
 [[ 0  1]
 [ 4  5]
 [ 8  9]
 [12 13]] 
 Right array:
 [[ 2  3]
 [ 6  7]
 [10 11]
 [14 15]]</code></pre>
</div>
</div>
</section>
</section>
<section id="review-questions-1" class="level3" data-number="3.2.6">
<h3 data-number="3.2.6" class="anchored" data-anchor-id="review-questions-1"><span class="header-section-number">3.2.6</span> Review Questions</h3>
<p><strong>Short Answer Questions (SAQ)</strong></p>
<p><strong>Q1: What is the main purpose of the NumPy library in Python?</strong><br>
<strong>Ans:</strong> The main purpose of NumPy is to provide support for large, multi-dimensional arrays and matrices, along with a collection of mathematical functions to perform operations on these arrays efficiently.</p>
<p><strong>Q2: How can a 1D array be created in NumPy?</strong><br>
<strong>Ans:</strong> A 1D array can be created using <code>np.array()</code> function, like:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Q3: How do you access the shape of a NumPy array?</strong></p>
<p><strong>Ans:</strong> You can access the shape of a NumPy array using the .shape attribute. For example, array.shape gives the dimensions of the array.</p>
<p><strong>Q4: What does the np.reshape() function do?</strong></p>
<p><strong>Ans:</strong> The np.reshape() function reshapes an array to a new shape without changing its data.</p>
<p><strong>Q5: Explain the difference between vstack() and hstack() in NumPy.</strong></p>
<p><strong>Ans:</strong> vstack() vertically stacks arrays (along rows), while hstack() horizontally stacks arrays (along columns).</p>
<p><strong>Q6: How does NumPy handle array slicing?</strong></p>
<p><strong>Ans:</strong> Array slicing in NumPy is done by specifying the start, stop, and step index like array[start:stop:step], which returns a portion of the array.</p>
<p><strong>Q7: What is the difference between the np.zeros() and np.ones() functions?</strong></p>
<p><strong>Ans:</strong> np.zeros() creates an array filled with zeros, while np.ones() creates an array filled with ones.</p>
<p><strong>Q8: What is array broadcasting in NumPy?</strong></p>
<p><strong>Ans:</strong> Broadcasting in NumPy allows arrays of different shapes to be used in arithmetic operations by stretching the smaller array to match the shape of the larger array.</p>
<p><strong>Q9: How can you stack arrays along a new axis in NumPy?</strong> <strong>Ans:</strong> You can use np.stack() to join arrays along a new axis.</p>
<p><strong>Q10: How do you generate a random integer array using NumPy?</strong></p>
<p><strong>Ans:</strong> You can generate a random integer array using np.random.randint(low, high, size).</p>
<hr>
<p><strong>Long Answer Questions (LAQ)</strong></p>
<p><strong>Q1: Explain how array slicing works in NumPy.</strong></p>
<p><strong>Ans:</strong> Array slicing in NumPy is a method to access or modify a subset of elements from a larger array. The syntax for slicing is array[start:stop:step], where:</p>
<p>start is the index from which slicing begins (inclusive), stop is the index where slicing ends (exclusive), step is the interval between indices to include in the slice. For example, in a 1D array, arr[1:5:2] will return every second element between the indices 1 and 4.</p>
<p><strong>Q2: Discuss the difference between the .reshape() function and the .ravel() function in NumPy.</strong></p>
<p><strong>Ans:</strong> The .reshape() function changes the shape of an array without modifying its data, allowing a multi-dimensional array to be flattened or reshaped into any compatible shape. On the other hand, .ravel() returns a flattened 1D version of an array, but it tries to avoid copying the data by returning a flattened view where possible. If modifying the flattened array is necessary, ravel() returns a copy instead.</p>
<p><strong>Q3: Explain how NumPy handles broadcasting during array operations.</strong></p>
<p><strong>Ans:</strong> Broadcasting in NumPy is a method to perform element-wise operations on arrays of different shapes. Smaller arrays are “broadcast” across the larger array by repeating their elements to match the shape of the larger array. For example, when adding a scalar to a 2D array, the scalar is added to each element of the array by broadcasting the scalar to match the array’s shape. Similarly, operations between arrays of different shapes follow the broadcasting rules to make them compatible.</p>
<p><strong>Q4: Describe how you would split an array in NumPy using the np.split() function. Provide an example.</strong></p>
<p><strong>Ans:</strong> The np.split() function in NumPy divides an array into multiple sub-arrays based on the indices provided. The syntax is: np.split(array, indices) Here, array is the array to be split, and indices is a list of indices where the split will occur. For example:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])  </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>np.split(arr, [<span class="dv">2</span>, <span class="dv">4</span>])  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This splits the array at indices 2 and 4, resulting in three sub-arrays: [1, 2], [3, 4], and [5, 6].</p>
<p><strong>Q5: What are the key differences between np.hsplit() and np.vsplit()? Provide examples.</strong></p>
<p><strong>Ans:</strong> np.hsplit() horizontally splits an array along its columns, while np.vsplit() vertically splits an array along its rows. For example, if we have a 2D array:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>np.hsplit(arr, 3) splits the array into three columns, each with two rows: [[1], [4]], [[2], [5]], [[3], [6]]. np.vsplit(arr, 2) splits the array into two sub-arrays along rows: [[1, 2, 3]] and [[4, 5, 6]].</p>
<p><strong>Q6: How can you create a 2D array with random integers between 1 and 10 using NumPy? Provide an example.</strong></p>
<p><strong>Ans:</strong> A 2D array with random integers between 1 and 10 can be created using np.random.randint(low, high, size). Example:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>np.random.randint(<span class="dv">1</span>, <span class="dv">10</span>, size<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This generates a 3x3 array with random integers between 1 and 9.</p>
<p><strong>Q7: Describe how you would reshape an array from 1D to 2D in NumPy.</strong></p>
<p><strong>Ans:</strong> Reshaping an array from 1D to 2D in NumPy can be done using the .reshape() function. For example, given a 1D array:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To reshape it into a 2D array with 2 rows and 3 columns:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>arr.reshape(<span class="dv">2</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This results in <code>[[1, 2, 3], [4, 5, 6]]</code>.</p>
<p><strong>Q8: Explain the concept of stacking arrays in NumPy using np.stack(). Provide an example.</strong></p>
<p><strong>Ans:</strong> np.stack() joins arrays along a new axis, unlike hstack() and vstack(), which concatenate along existing axes. For example:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])  </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])  </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>np.stack((arr1, arr2), axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This stacks the arrays along a new axis, resulting in [[1, 2, 3], [4, 5, 6]].</p>
<p><strong>Q9: How does NumPy’s array_split() differ from split()? Provide an example.</strong></p>
<p><strong>Ans:</strong> The array_split() function allows unequal splitting of an array, whereas split() requires the splits to result in equal-sized sub-arrays. For example:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])  </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>np.array_split(arr, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This will split the array into three parts: [1, 2], [3, 4], and [5].</p>
<p><strong>Q10: How would you flatten a multi-dimensional array into a 1D array in NumPy?</strong></p>
<p><strong>Ans:</strong> You can flatten a multi-dimensional array using the .ravel() or .flatten() methods. Example using ravel():</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])  </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>arr.ravel()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This flattens the array into [1, 2, 3, 4].</p>
<p><strong>Q11: Discuss the importance of NumPy in scientific computing and how it handles large datasets efficiently.</strong></p>
<p><strong>Ans:</strong> NumPy is crucial in scientific computing because it provides efficient storage and operations for large datasets through its n-dimensional array objects. It uses continuous memory blocks, making array operations faster than traditional Python lists, and supports a variety of mathematical functions and broadcasting, which simplifies computation.</p>
<p>NumPy operates efficiently by:</p>
<ul>
<li>Avoiding type checking at each operation due to its homogeneous data type constraint.</li>
<li>Leveraging vectorization to reduce the need for explicit loops in operations.</li>
<li>Providing optimized C and Fortran libraries for core computations.</li>
</ul>
<p>Example of large dataset handling:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>large_array <span class="op">=</span> np.random.rand(<span class="dv">1000000</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>sum_large_array <span class="op">=</span> np.<span class="bu">sum</span>(large_array)  <span class="co"># Efficient summation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This efficiency makes NumPy a foundation for data-driven scientific applications like machine learning, signal processing, and simulations.</p>
<p><strong>Q12: What is the difference between a view and a copy in NumPy? Why does this matter in array operations?</strong></p>
<p><strong>Ans:</strong> A view is a reference to the original array, meaning changes in the view will affect the original array. A copy creates a new, independent array.</p>
<p>Example:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>view <span class="op">=</span> arr[:<span class="dv">2</span>]  <span class="co"># Creates a view</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>copy <span class="op">=</span> arr[:<span class="dv">2</span>].copy()  <span class="co"># Creates a copy</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>view[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">99</span>  <span class="co"># This will change arr</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Views are more memory-efficient, but changes to them affect the original data, whereas copies do not.</p>
<p><strong>Q13: How are higher-dimensional arrays handled in NumPy, and how can they be reshaped and indexed? Provide a practical example.</strong></p>
<p><strong>Ans:</strong> Higher-dimensional arrays (tensors) in NumPy can be created and manipulated like 1D and 2D arrays. You can reshape tensors using reshape() and index them similarly, using one index for each dimension.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>tensor <span class="op">=</span> np.arange(<span class="dv">24</span>).reshape(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)  <span class="co"># 3D tensor with shape (2, 3, 4)</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>element <span class="op">=</span> tensor[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]  <span class="co"># Access element at specified indices</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>we can reshape tensors:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>reshaped_tensor <span class="op">=</span> tensor.reshape(<span class="dv">4</span>, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="some-important-numpy-function-for-linear-algrbra" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="some-important-numpy-function-for-linear-algrbra"><span class="header-section-number">3.3</span> Some important <code>NumPy</code> function for Linear Algrbra</h2>
<p>Let’s start with some basic matrix operations. Suppose we have two matrices, A and B, and we want to add them together. In NumPy, we can do this with the simple command, <code>A+B</code>. Let’s look into the detailed computational steps.</p>
<div id="6c1af85a" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Addition and Subtraction</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>matrix1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>matrix2 <span class="op">=</span> np.array([[<span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>]])</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(matrix1 <span class="op">+</span> matrix2) <span class="co"># prints [[6, 8], [10, 12]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 6  8]
 [10 12]]</code></pre>
</div>
</div>
<p>Similary, matrix difference and other matrix operations can be illustrated as follows.</p>
<div id="997f8628" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(matrix1 <span class="op">-</span> matrix2) <span class="co"># prints [[-4, -4], [-4, -4]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[-4 -4]
 [-4 -4]]</code></pre>
</div>
</div>
<div id="2e9aadee" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scalar Multiplication</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>matrix <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">2</span> <span class="op">*</span> matrix) <span class="co"># prints [[2, 4], [6, 8]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[2 4]
 [6 8]]</code></pre>
</div>
</div>
<div id="9c549286" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix Multiplication</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>matrix1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>matrix2 <span class="op">=</span> np.array([[<span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>]])</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.dot(matrix1, matrix2)) <span class="co"># prints [[19, 22], [43, 50]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[19 22]
 [43 50]]</code></pre>
</div>
</div>
<div id="7d67b3e8" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix Hadamards product</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>matrix1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>matrix2 <span class="op">=</span> np.array([[<span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>]])</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(matrix1<span class="op">*</span>matrix2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 5 12]
 [21 32]]</code></pre>
</div>
</div>
<div id="54bb063e" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transpose</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>matrix <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.transpose(matrix)) <span class="co"># prints [[1, 4], [2, 5], [3, 6]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 4]
 [2 5]
 [3 6]]</code></pre>
</div>
</div>
<div id="5ea62a94" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse of a matrix</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>a_inv <span class="op">=</span> np.linalg.inv(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, let’s talk about vectors. A vector is simply a matrix with one column. They’re often used to represent things like forces or velocities in physics. In NumPy, we can represent vectors as arrays with one dimension.</p>
<div id="65e7d478" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>vector <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vector) <span class="co"># prints [1, 2, 3]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3]</code></pre>
</div>
</div>
<p>Let’s say we have two vectors, <span class="math inline">\(\vec{u}\)</span> and <span class="math inline">\(\vec{v}\)</span>, and we want to compute their dot product (i.e., the sum of the products of their corresponding entries). We can do this with the command:</p>
<div id="d335e350" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>vector1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>vector2 <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.dot(vector1, vector2)) <span class="co"># prints 32</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>32</code></pre>
</div>
</div>
<p>Like that there are some other operations too.</p>
<div id="7d0879b3" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross Product</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>vector1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>vector2 <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.cross(vector1, vector2)) <span class="co"># prints [-3, 6, -3]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[-3  6 -3]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Norm:</em> The norm of a vector is a scalar that represents the “length” of the vector. In NumPy, we can compute the norm using the <code>numpy.linalg.norm</code> function. The inner product of two vectors is a matrix that is computed by multiplying the first vector by the transpose of the second vector. In NumPy, we can compute the inner product using the numpy.inner function.</p>
</div>
</div>
<div id="48f6435a" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finding norm</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>vector <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.linalg.norm(vector)) <span class="co"># prints 3.74165738677</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.7416573867739413</code></pre>
</div>
</div>
<div id="e7b086b6" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#finding inner product</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>vector1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>vector2 <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.inner(vector1, vector2)) <span class="co"># prints 32</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>32</code></pre>
</div>
</div>
<p>To handle higher dimensional mutrix multiplication, one can use <code>matmul()</code> function. The <code>np.matmul()</code> function is another way to perform matrix multiplication. Unlike <code>np.dot()</code>, it handles higher-dimensional arrays correctly by broadcasting. The syntax for this operation is <code>np.matmul(a, b)</code>.</p>
<div id="de32b8bc" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>]])</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">4</span>, <span class="dv">1</span>], [<span class="dv">2</span>, <span class="dv">2</span>]])</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix multiplication using matmul</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> np.matmul(A, B)</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[4 1]
 [2 2]]</code></pre>
</div>
</div>
<p>The function <code>np.linalg.inv()</code> computes the inverse of a square matrix. Syntax for this function is <code>np.linalg.inv(a)</code>. An example is shown below.</p>
<div id="c0941145" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute inverse</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>inv_A <span class="op">=</span> np.linalg.inv(A)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inv_A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[-2.   1. ]
 [ 1.5 -0.5]]</code></pre>
</div>
</div>
<p>The <code>np.linalg.det()</code> function computes the determinant of a square matrix. The determinant is useful for solving linear systems and understanding matrix properties. The syntax is <code>np.linalg.det(a)</code>.</p>
<div id="405dfa93" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute determinant</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>det_A <span class="op">=</span> np.linalg.det(A)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(det_A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-2.0000000000000004</code></pre>
</div>
</div>
<p>The <code>np.linalg.solve()</code> function solves a linear matrix equation or system of linear scalar equations. It finds the vector x that satisfies <span class="math inline">\(Ax = b\)</span>. Syntax for this function is <code>np.linalg.solve(A, b)</code>.</p>
<div id="eec43197" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">2</span>]])</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">9</span>, <span class="dv">8</span>])</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve system of equations</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linalg.solve(A, b)</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[2. 3.]</code></pre>
</div>
</div>
<p>This function computes the QR decomposition of a matrix. QR decomposition is used to solve linear systems, least squares problems, and compute eigenvalues. Syntax for this function is <code>np.linalg.qr()</code>.</p>
<div id="bf4f6ef7" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co"># QR decomposition</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>Q, R <span class="op">=</span> np.linalg.qr(A)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Q:"</span>, Q)</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R:"</span>, R)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Q: [[-0.12309149  0.90453403  0.40824829]
 [-0.49236596  0.30151134 -0.81649658]
 [-0.86164044 -0.30151134  0.40824829]]
R: [[-8.12403840e+00 -9.60113630e+00 -1.10782342e+01]
 [ 0.00000000e+00  9.04534034e-01  1.80906807e+00]
 [ 0.00000000e+00  0.00000000e+00 -8.88178420e-16]]</code></pre>
</div>
</div>
<p>The <code>np.linalg.lstsq()</code> function solves a linear least-squares problem, which is useful in regression tasks. The syntax for the function is <code>np.linalg.lstsq(a, b, rcond=None)</code>.</p>
<div id="efa3751c" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">2</span>, <span class="dv">2</span>], [<span class="dv">2</span>, <span class="dv">3</span>]])</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">11</span>])</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Least-squares solution</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>x, residuals, rank, s <span class="op">=</span> np.linalg.lstsq(A, b, rcond<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Solution:"</span>, x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Solution: [2.09090909 2.54545455]</code></pre>
</div>
</div>
<p>The Kronecker product is a matrix operation used in various applications like tensor products and matrix calculus. Syntax for this function is <code>np.kron(a, b)</code>.</p>
<div id="3676443e" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">5</span>], [<span class="dv">6</span>, <span class="dv">7</span>]])</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>kronecker <span class="op">=</span> np.kron(A, B)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(kronecker)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0  5  0 10]
 [ 6  7 12 14]
 [ 0 15  0 20]
 [18 21 24 28]]</code></pre>
</div>
</div>
<p>Cosine similarity is used to find the cosine of the angle between two vectors. The mathematical formula for this operation is <span class="math inline">\(\cos \theta=\frac{\vec{a}\cdot \vec{b}}{|\vec{a}\cdot\vec{b}|}\)</span>. The python function to calculate the cosine similarity is shown below.</p>
<div id="e6bf6943" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>cosine_sim <span class="op">=</span> np.dot(a, b) <span class="op">/</span> (np.linalg.norm(a) <span class="op">*</span> np.linalg.norm(b))</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cosine_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9746318461970762</code></pre>
</div>
</div>
<section id="linear-regression-using-numpy" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="linear-regression-using-numpy"><span class="header-section-number">3.3.1</span> Linear Regression using <code>NumPy</code></h3>
<p>The <code>np.polyfit()</code> function fits a polynomial of a specified degree to the data, making it useful for regression. Syntax for this function is <code>np.polyfit(x, y, deg)</code>. Where <span class="math inline">\(x\)</span> Independent variable (input), <span class="math inline">\(y\)</span> is the dependent variable (output) and <code>deg</code> degree of the fitting polynomial. A simple example is given below.</p>
<div id="26ce2f3f" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>])</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear fit (degree 1)</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>coefficients <span class="op">=</span> np.polyfit(x, y, <span class="dv">1</span>)</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficients:"</span>, coefficients)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: [2. 1.]</code></pre>
</div>
</div>
</section>
<section id="some-interesting-handy-matrix-operations-using-numpy-arrays" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="some-interesting-handy-matrix-operations-using-numpy-arrays"><span class="header-section-number">3.3.2</span> Some interesting handy matrix operations using numpy arrays</h3>
<p>In matrix decomposition, we need the matrix representation, <span class="math inline">\(A-\lambda I\)</span>. For any matrix, we can do this by just <code>A-lambda np.eye(3)</code>. This can be deomonstarted here.</p>
<div id="0d088a82" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>A<span class="op">=</span>np.array([[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],[<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>],[<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">7</span>]])</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>lamda<span class="op">=</span><span class="dv">3</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>A<span class="op">-</span>lamda<span class="op">*</span>np.eye(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>array([[-2.,  2.,  3.],
       [ 3.,  1.,  5.],
       [ 7.,  6.,  4.]])</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Task:</strong> Create a matrix, <span class="math inline">\(A\)</span> using <code>numpy</code> and find the covariance , <span class="math inline">\(cov(A)\)</span> using matrix operation.</p>
</blockquote>
<div id="b772e722" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a random matrix</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>A<span class="op">=</span>np.arange(<span class="dv">16</span>).reshape(<span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11],
       [12, 13, 14, 15]])</code></pre>
</div>
</div>
<p>Now find <span class="math inline">\(A-\bar{A}\)</span>.</p>
<div id="25484542" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>A_bar<span class="op">=</span>np.mean(A,axis<span class="op">=</span><span class="dv">0</span>) <span class="co"># calculating column-wise sum</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>A_bar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>array([6., 7., 8., 9.])</code></pre>
</div>
</div>
<div id="180c9326" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculating A-A bar with outer product opertation</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A<span class="op">-</span>np.outer(A_bar,np.ones(<span class="dv">4</span>)).T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[-6. -6. -6. -6.]
 [-2. -2. -2. -2.]
 [ 2.  2.  2.  2.]
 [ 6.  6.  6.  6.]]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The same can be done using reshaping method</p>
<div id="2d02292a" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculating A-A_bar using broadcasting</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>X<span class="op">=</span>A<span class="op">-</span>np.mean(A,axis<span class="op">=</span><span class="dv">0</span>).reshape(<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[-6. -6. -6. -6.]
 [-2. -2. -2. -2.]
 [ 2.  2.  2.  2.]
 [ 6.  6.  6.  6.]]</code></pre>
</div>
</div>
</div>
</div>
<p>Calculating the covariance.</p>
<div id="c0fd71f4" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mannualy calculating covariance</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>CoV<span class="op">=</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)<span class="op">*</span>np.dot(X.T,X)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>CoV</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>array([[26.66666667, 26.66666667, 26.66666667, 26.66666667],
       [26.66666667, 26.66666667, 26.66666667, 26.66666667],
       [26.66666667, 26.66666667, 26.66666667, 26.66666667],
       [26.66666667, 26.66666667, 26.66666667, 26.66666667]])</code></pre>
</div>
</div>
<p>We can verify the same using default function as follows.</p>
<div id="1e207a7d" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculating covariance using numpy function</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>np.cov(A, rowvar<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>array([[26.66666667, 26.66666667, 26.66666667, 26.66666667],
       [26.66666667, 26.66666667, 26.66666667, 26.66666667],
       [26.66666667, 26.66666667, 26.66666667, 26.66666667],
       [26.66666667, 26.66666667, 26.66666667, 26.66666667]])</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is interesting to compare the two ways of flattening an array using <code>reshape()</code>.</p>
<div id="0a26b10b" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co">#comparing two ways of flattening a matrix using numpy</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>A.reshape(<span class="op">-</span><span class="dv">1</span>)<span class="op">==</span>A.reshape(<span class="dv">16</span>,)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True])</code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="basics-of-scipy-library-for-computational-linear-algebra" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="basics-of-scipy-library-for-computational-linear-algebra"><span class="header-section-number">3.4</span> Basics of <code>SciPy</code> Library for Computational Linear Algebra</h2>
<p>Following the comprehensive exploration of the NumPy library, which forms the foundation of array operations and basic linear algebra computations, it is essential to expand into more advanced tools for scientific computing. The <strong>SciPy</strong> library builds upon NumPy, offering a vast collection of functions and utilities specifically designed for higher-level operations in scientific and technical computing. While NumPy provides efficient array handling and basic matrix operations, SciPy extends these capabilities by incorporating advanced functions for optimization, integration, interpolation, and linear algebra, among other tasks <span class="citation" data-cites="2020SciPy-NMeth">(<a href="references.html#ref-2020SciPy-NMeth" role="doc-biblioref">Virtanen et al. 2020</a>)</span>.</p>
<p>For computational linear algebra, SciPy provides specialized modules like <code>scipy.linalg</code>, which can handle everything from solving linear systems to eigenvalue decompositions and matrix factorizations. This transition from NumPy to SciPy enables the handling of more complex problems efficiently and allows users to leverage optimized algorithms for large-scale numerical computations. By integrating SciPy into the workflow, computations can be carried out more robustly, expanding on the basic linear algebra concepts introduced through NumPy with advanced techniques necessary for practical applications.</p>
<section id="basic-matrix-operations" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="basic-matrix-operations"><span class="header-section-number">3.4.1</span> Basic Matrix operations</h3>
<p><code>SciPy</code> builds on the functionality of NumPy, offering more sophisticated and optimized algorithms, particularly suited for numerical computing tasks. While <code>NumPy</code> provides essential operations for linear algebra, <code>SciPy</code>’s <code>scipy.linalg</code> module extends these capabilities with more advanced functions. <code>SciPy</code> functions are often better optimized for large-scale systems, making them highly efficient for computational linear algebra applications.</p>
<p>As the first step to use <code>SciPy</code>, we need to import the (only) necessary submodules for our specific tasks. In our discussion, we consider only linear algebra. So we import the <code>linalg</code> submodule as follows</p>
<div id="24f64ac3" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import scipy</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np <span class="co"># for matrix definition</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> linalg</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(scipy.__version__) # check version</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s discuss various <code>SciPy</code> functions for linear algebra with examples.</p>
<section id="computing-the-determinant" class="level4" data-number="3.4.1.1">
<h4 data-number="3.4.1.1" class="anchored" data-anchor-id="computing-the-determinant"><span class="header-section-number">3.4.1.1</span> Computing the Determinant</h4>
<p>The determinant is a scalar value that can be computed from the elements of a square matrix and is often used to determine whether a system of linear equations has a unique solution.</p>
<blockquote class="blockquote">
<p><em>Syntax:</em> <code>scipy.linalg.det(A)</code></p>
</blockquote>
<div id="156e1320" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>det_A <span class="op">=</span> linalg.det(A)</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(det_A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-2.0</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Similar functionality is provided by <code>np.linalg.det()</code>. However, <code>scipy.linalg.det()</code> is often preferred when working with very large matrices due to the efficiency of SciPy’s backend implementations.</p>
</div>
</div>
</section>
<section id="solving-linear-systems-of-equations" class="level4" data-number="3.4.1.2">
<h4 data-number="3.4.1.2" class="anchored" data-anchor-id="solving-linear-systems-of-equations"><span class="header-section-number">3.4.1.2</span> Solving Linear Systems of Equations</h4>
<p>One of the fundamental tasks in linear algebra is solving a system of linear equations of the form <span class="math inline">\(AX = b\)</span>, where <span class="math inline">\(A\)</span> is a matrix and <span class="math inline">\(b\)</span> is a vector or matrix of known values. &gt;<em>Syntax:</em> <code>scipy.linalg.solve(A, b)</code></p>
<div id="8aefb4e5" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co">#example</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">2</span>]])</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">9</span>, <span class="dv">8</span>])</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> linalg.solve(A, b)</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[2. 3.]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>NumPy’s <code>np.linalg.solve()</code> also provides this functionality, but SciPy’s version is better suited for larger and more complex matrices because it uses more efficient algorithms for decomposing the matrix.</p>
</div>
</div>
</section>
<section id="matrix-inversion" class="level4" data-number="3.4.1.3">
<h4 data-number="3.4.1.3" class="anchored" data-anchor-id="matrix-inversion"><span class="header-section-number">3.4.1.3</span> Matrix Inversion</h4>
<p>Matrix inversion is a critical operation in many linear algebra problems, particularly in solving systems of linear equations. &gt;<em>Syntax:</em> <code>scipy.linalg.inv(A)</code></p>
<div id="ae8b57ef" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>inv_A <span class="op">=</span> linalg.inv(A)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inv_A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[-2.   1. ]
 [ 1.5 -0.5]]</code></pre>
</div>
</div>
</section>
<section id="kronecker-product" class="level4" data-number="3.4.1.4">
<h4 data-number="3.4.1.4" class="anchored" data-anchor-id="kronecker-product"><span class="header-section-number">3.4.1.4</span> Kronecker Product</h4>
<p>The Kronecker product is used in various applications, including constructing block matrices and expanding the dimensionality of matrices.</p>
<blockquote class="blockquote">
<p><em>Syntax:</em> <code>scipy.linalg.kron(A, B)</code></p>
</blockquote>
<div id="f88b0b14" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">5</span>], [<span class="dv">6</span>, <span class="dv">7</span>]])</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>kron_product <span class="op">=</span> linalg.kron(A, B)</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(kron_product)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0  5  0 10]
 [ 6  7 12 14]
 [ 0 15  0 20]
 [18 21 24 28]]</code></pre>
</div>
</div>
</section>
<section id="eigenvalues-and-eigenvectors" class="level4" data-number="3.4.1.5">
<h4 data-number="3.4.1.5" class="anchored" data-anchor-id="eigenvalues-and-eigenvectors"><span class="header-section-number">3.4.1.5</span> Eigenvalues and Eigenvectors</h4>
<p>Eigenvalues and eigenvectors are fundamental in many areas of linear algebra, including solving systems of differential equations and performing dimensionality reduction in machine learning.</p>
<blockquote class="blockquote">
<p><em>Syntax:</em> <code>scipy.linalg.eig(A)</code></p>
</blockquote>
<div id="5fff0e94" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">2</span>], [<span class="dv">4</span>, <span class="dv">1</span>]])</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>eigenvalues, eigenvectors <span class="op">=</span> linalg.eig(A)</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Eigenvalues:"</span>, eigenvalues)</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Eigenvectors:"</span>, eigenvectors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Eigenvalues: [ 5.+0.j -1.+0.j]
Eigenvectors: [[ 0.70710678 -0.4472136 ]
 [ 0.70710678  0.89442719]]</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="sparse-matrices" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="sparse-matrices"><span class="header-section-number">3.5</span> Sparse Matrices</h2>
<p>Sparse matrices are often useful in numerical simulations dealing with large systems, if the problem can be described in matrix form where the matrices or vectors mostly contains zeros. Scipy has a good support for sparse matrices, with basic linear algebra operations (such as equation solving, eigenvalue calculations, etc.).</p>
<p>There are many possible strategies for storing sparse matrices in an efficient way. Some of the most common are the so-called coordinate form (COO), list of list (LIL) form, and compressed-sparse column CSC (and row, CSR). Each format has some advantages and disadvantages. Most computational algorithms (equation solving, matrix-matrix multiplication, etc.) can be efficiently implemented using CSR or CSC formats, but they are not so intuitive and not so easy to initialize. So often a sparse matrix is initially created in COO or LIL format (where we can efficiently add elements to the sparse matrix data), and then converted to CSC or CSR before used in real calculations.</p>
<p>For more information about these sparse formats, see e.g.&nbsp;<a href="http://en.wikipedia.org/wiki/Sparse_matrix" class="uri">http://en.wikipedia.org/wiki/Sparse_matrix</a></p>
<section id="sparse-matrix-operations-in-scipy" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="sparse-matrix-operations-in-scipy"><span class="header-section-number">3.5.1</span> Sparse Matrix operations in <code>SciPy</code></h3>
<p><strong>Sparse matrices</strong> are a key feature of <code>SciPy</code>, providing an efficient way to store and manipulate large matrices with a significant number of zero elements. <code>SciPy</code> offers a variety of sparse matrix formats and supports operations like matrix multiplication, addition, transposition, and solving systems of equations.</p>
<p>Here is a guide to working with sparse matrices in <code>SciPy</code>.</p>
<p><strong>Types of Sparse Matrices in SciPy</strong></p>
<p><code>SciPy</code> provides different types of sparse matrices depending on the use case:</p>
<ol type="1">
<li><strong>CSR (Compressed Sparse Row) Matrix</strong>: Efficient for row slicing and matrix-vector products.</li>
<li><strong>CSC (Compressed Sparse Column) Matrix</strong>: Efficient for column slicing and fast arithmetic operations.</li>
<li><strong>COO (Coordinate) Matrix</strong>: Suitable for constructing sparse matrices by specifying individual entries.</li>
<li><strong>DIA (Diagonal) Matrix</strong>: For matrices where non-zero elements are primarily on the diagonals.</li>
<li><strong>LIL (List of Lists) Matrix</strong>: Good for constructing matrices incrementally.</li>
</ol>
<section id="importing-sparse-matrices" class="level4" data-number="3.5.1.1">
<h4 data-number="3.5.1.1" class="anchored" data-anchor-id="importing-sparse-matrices"><span class="header-section-number">3.5.1.1</span> Importing Sparse Matrices</h4>
<div id="8d257a30" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.sparse <span class="im">import</span> csr_matrix, csc_matrix, coo_matrix</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Creating Sparse Matrices</strong></p>
<div id="ead2a34b" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dense matrix</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>dense_matrix <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert dense matrix to CSR format</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>csr <span class="op">=</span> csr_matrix(dense_matrix)</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display CSR matrix</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(csr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Compressed Sparse Row sparse matrix of dtype 'int64'
    with 4 stored elements and shape (3, 3)&gt;
  Coords    Values
  (0, 2)    3
  (1, 0)    4
  (2, 1)    5
  (2, 2)    6</code></pre>
</div>
</div>
<div id="2faa017b" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating sparse matrix in COO format</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define row indices, column indices, and values</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>row <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>])</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create COO sparse matrix</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>coo <span class="op">=</span> coo_matrix((data, (row, col)), shape<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(coo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;COOrdinate sparse matrix of dtype 'int64'
    with 4 stored elements and shape (3, 3)&gt;
  Coords    Values
  (0, 2)    3
  (1, 0)    4
  (2, 1)    5
  (2, 2)    6</code></pre>
</div>
</div>
<p><strong>Basic Operations with Sparse Matrices</strong></p>
<p>The basic matrix operations can be performed on the sparse matrix too. The difference is that in the case of sparse matices, the respective operations will be done only on non-zero enties. Now look into the basic matrix operations thorugh following examples.</p>
<p><em>Matrix Multiplication:</em></p>
<div id="d383e071" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> csr_matrix([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>]])</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> csr_matrix([[<span class="dv">4</span>, <span class="dv">5</span>], [<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">7</span>, <span class="dv">8</span>]])</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix multiplication (dot product)</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> A.dot(B)</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result.toarray())  <span class="co"># Convert to dense array for display</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[4 5]
 [7 8]
 [0 0]]</code></pre>
</div>
</div>
<p><em>Transposition:</em></p>
<div id="1c3f05c6" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transpose the matrix</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>transposed <span class="op">=</span> A.transpose()</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(transposed.toarray())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 0 0]
 [0 0 2]
 [0 1 0]]</code></pre>
</div>
</div>
<p><em>Addition:</em></p>
<div id="803728ac" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding two sparse matrices</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> csr_matrix([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>]])</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> csr_matrix([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">5</span>]])</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>sum_matrix <span class="op">=</span> C <span class="op">+</span> D</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sum_matrix.toarray())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0  2  2]
 [ 3  0  0]
 [ 2  0 10]]</code></pre>
</div>
</div>
<p><em>Solving Sparse Linear Systems</em></p>
<p>We can solve systems of linear equations using sparse matrices with the <code>spsolve()</code> function:</p>
<div id="7ff60563" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.sparse.linalg <span class="im">import</span> spsolve</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sparse matrix (A) and a dense vector (b)</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> csr_matrix([[<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>]])</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>])</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the system Ax = b</span></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> spsolve(A, b)</span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Solution x:"</span>, x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Solution x: [1. 2. 1.]</code></pre>
</div>
</div>
</section>
<section id="conversion-from-one-sparse-matrix-system-to-another" class="level4" data-number="3.5.1.2">
<h4 data-number="3.5.1.2" class="anchored" data-anchor-id="conversion-from-one-sparse-matrix-system-to-another"><span class="header-section-number">3.5.1.2</span> Conversion from one sparse matrix system to another</h4>
<p>We can convert between different sparse matrix formats using the <code>.tocsc()</code>,<code>.tocoo()</code>, <code>.todia()</code>, and similar methods:</p>
<div id="364369b8" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert CSR to COO format</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>coo <span class="op">=</span> A.tocoo()</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(coo)</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The matrix is :</span><span class="ch">\n</span><span class="st">"</span>,coo.toarray())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;COOrdinate sparse matrix of dtype 'int64'
    with 5 stored elements and shape (3, 3)&gt;
  Coords    Values
  (0, 0)    3
  (0, 1)    1
  (1, 0)    1
  (1, 1)    2
  (2, 2)    1
The matrix is :
 [[3 1 0]
 [1 2 0]
 [0 0 1]]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Summary of sparse matrix operations
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>csr_matrix()</code></td>
<td>Compressed Sparse Row matrix.</td>
</tr>
<tr class="even">
<td><code>csc_matrix()</code></td>
<td>Compressed Sparse Column matrix.</td>
</tr>
<tr class="odd">
<td><code>coo_matrix()</code></td>
<td>Coordinate format matrix.</td>
</tr>
<tr class="even">
<td><code>spsolve()</code></td>
<td>Solves sparse linear systems.</td>
</tr>
<tr class="odd">
<td><code>spdiags()</code></td>
<td>Extracts or constructs diagonal sparse matrices.</td>
</tr>
<tr class="even">
<td><code>lil_matrix()</code></td>
<td>List of lists sparse matrix.</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>
<section id="visualization-libraries" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="visualization-libraries"><span class="header-section-number">3.6</span> Visualization Libraries</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-harris2020array" class="csl-entry" role="listitem">
Harris, Charles R., K. Jarrod Millman, Stéfan J. van der Walt, Ralf Gommers, Pauli Virtanen, David Cournapeau, Eric Wieser, et al. 2020. <span>“Array Programming with <span>NumPy</span>.”</span> <em>Nature</em> 585 (7825): 357–62. <a href="https://doi.org/10.1038/s41586-020-2649-2">https://doi.org/10.1038/s41586-020-2649-2</a>.
</div>
<div id="ref-2020SciPy-NMeth" class="csl-entry" role="listitem">
Virtanen, Pauli, Ralf Gommers, Travis E. Oliphant, Matt Haberland, Tyler Reddy, David Cournapeau, Evgeni Burovski, et al. 2020. <span>“<span class="nocase"><span>SciPy</span> 1.0: Fundamental Algorithms for Scientific Computing in Python</span>.”</span> <em>Nature Methods</em> 17: 261–72. <a href="https://doi.org/10.1038/s41592-019-0686-2">https://doi.org/10.1038/s41592-019-0686-2</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./module_2.html" class="pagination-link" aria-label="Transforming Linear Algebra to Computational Language">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Transforming Linear Algebra to Computational Language</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>